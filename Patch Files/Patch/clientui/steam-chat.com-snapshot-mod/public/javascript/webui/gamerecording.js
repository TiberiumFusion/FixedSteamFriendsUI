










/**** (c) Valve Corporation. Use is governed by the terms of the Steam Subscriber Agreement http://store.steampowered.com/subscriber_agreement/. 
****/
(self.webpackChunk_steam_friendsui=self.webpackChunk_steam_friendsui||[]).push([[7462,351],{46748:e=>{e.exports={ClipUploadStatus:"clipupload_ClipUploadStatus_3Ebq4"}},59659:e=>{e.exports={Dummy:"gamerecordingmarkers_Dummy_2840r",Selected:"gamerecordingmarkers_Selected_WvAtV",HighlightIcon:"gamerecordingmarkers_HighlightIcon_3rt1q",CustomMarker:"gamerecordingmarkers_CustomMarker_3F_Gf",MarkerBacking:"gamerecordingmarkers_MarkerBacking_1ft3M",HighlightIconSVG:"gamerecordingmarkers_HighlightIconSVG_nt4N5",Faded:"gamerecordingmarkers_Faded_3G-TE",Marker:"gamerecordingmarkers_Marker_3GP2Y"}},45130:e=>{e.exports={GameRecordingPlayer:"gamerecordingplayer_GameRecordingPlayer_1AGqA",Overlay:"gamerecordingplayer_Overlay_1PKb5",NoVideo:"gamerecordingplayer_NoVideo_DaqWG",PositionAbsolute:"gamerecordingplayer_PositionAbsolute_1OoTI",VideoFadeIn:"gamerecordingplayer_VideoFadeIn_3oLlz",PlayingClippedRegion:"gamerecordingplayer_PlayingClippedRegion_1j1-I",ClippingMode:"gamerecordingplayer_ClippingMode_8y8y6",PlayerError:"gamerecordingplayer_PlayerError_3ixlq",Title:"gamerecordingplayer_Title_3jzI6",Description:"gamerecordingplayer_Description_1jQ8T",Buttons:"gamerecordingplayer_Buttons_2eqwm",Button:"gamerecordingplayer_Button_2Jhop",DisableButton:"gamerecordingplayer_DisableButton_rq1uE",PerfCtnVideo:"gamerecordingplayer_PerfCtnVideo_adSGJ",PerfCtnThumbnails:"gamerecordingplayer_PerfCtnThumbnails_1Yw-S",LoadingSpinner:"gamerecordingplayer_LoadingSpinner_3O0u0"}},79558:e=>{e.exports={GoLiveButtonCtn:"golivebutton_GoLiveButtonCtn_1Ssh6",GoLiveButton:"golivebutton_GoLiveButton_1rZeq",IsLive:"golivebutton_IsLive_2MGny",JumpToEndIcon:"golivebutton_JumpToEndIcon_2FkWF"}},12201:e=>{e.exports={animationDuration:"2000ms",BannerVideoOverlay:"playerbanner_BannerVideoOverlay_pV5fB",PlayerHighlightBanner:"playerbanner_PlayerHighlightBanner_3oCX4",fadeInOut:"playerbanner_fadeInOut_2x2R_",BannerContents:"playerbanner_BannerContents_3Toou",HighlightIcon:"playerbanner_HighlightIcon_1gJnE",InfoBox:"playerbanner_InfoBox_2Lk34",HighlightTitle:"playerbanner_HighlightTitle_1Pwzl",HighlightDesc:"playerbanner_HighlightDesc_1UuG7"}},93999:e=>{e.exports={animationDuration:"2000ms",RelativeTimeContainer:"relativetimedisplay_RelativeTimeContainer_UqMNR",RelativeTime:"relativetimedisplay_RelativeTime_3waN_",fadeInOut:"relativetimedisplay_fadeInOut_1Tmc5"}},9464:e=>{e.exports={ClipDetails:"sharedclip_ClipDetails_1fyr-",VideoContainer:"sharedclip_VideoContainer_1Ml8-",ClipPreview:"sharedclip_ClipPreview_3vpFg",Thumbnail:"sharedclip_Thumbnail_3PnGn",PlayContainer:"sharedclip_PlayContainer_1Cv16",Button:"sharedclip_Button_MwGjy"}},21185:e=>{e.exports={LoadingTimeline:"horizontalscrollbar_LoadingTimeline_3AC5P",ScrollAndControlsCtn:"horizontalscrollbar_ScrollAndControlsCtn_1CYsm",GamepadMode:"horizontalscrollbar_GamepadMode_1wi1J",Controls:"horizontalscrollbar_Controls_1l2J-",TimelineScrollContainer:"horizontalscrollbar_TimelineScrollContainer_3v-bz",ContentContainer:"horizontalscrollbar_ContentContainer_1Jjb0",AbsoluteLayer:"horizontalscrollbar_AbsoluteLayer_2F0d9",HideOverflow:"horizontalscrollbar_HideOverflow_2GDis",RelativeLayer:"horizontalscrollbar_RelativeLayer_1xZCN",WithPointerEvents:"horizontalscrollbar_WithPointerEvents_12MLk",RecordingDecorators:"horizontalscrollbar_RecordingDecorators_2PJGD",ClipDecorators:"horizontalscrollbar_ClipDecorators_tbss_",GameModes:"horizontalscrollbar_GameModes_1Bh3P",DateDecorator:"horizontalscrollbar_DateDecorator_2w-ta",BackgroundTicks:"horizontalscrollbar_BackgroundTicks_xD30a",Highlights:"horizontalscrollbar_Highlights_56YDW",Timestamps:"horizontalscrollbar_Timestamps_xLUyq",RangeSelector:"horizontalscrollbar_RangeSelector_2vqUV",SeekScrubber:"horizontalscrollbar_SeekScrubber_3MV0K",PlayHead:"horizontalscrollbar_PlayHead_37u67",Thumbnails:"horizontalscrollbar_Thumbnails_1pOPb",PositionLeft:"horizontalscrollbar_PositionLeft_2lo44",PositionRight:"horizontalscrollbar_PositionRight_2tl3c",ContentAndGradient:"horizontalscrollbar_ContentAndGradient_XrJof",ScrollbarPlaceholder:"horizontalscrollbar_ScrollbarPlaceholder_1NhP7",LeftControlsAndContent:"horizontalscrollbar_LeftControlsAndContent_1vc8f",ScrollGradientCtn:"horizontalscrollbar_ScrollGradientCtn_rWNgV",FrontGradient:"horizontalscrollbar_FrontGradient_2M09u",HideGradient:"horizontalscrollbar_HideGradient_28_y-",EndGradient:"horizontalscrollbar_EndGradient_YzFF9",ScrollbarAndSiblings:"horizontalscrollbar_ScrollbarAndSiblings_34dlB",ScrollBarCtn:"horizontalscrollbar_ScrollBarCtn_1-ooP",HideScrollBar:"horizontalscrollbar_HideScrollBar_N-Wti",ScrollTrack:"horizontalscrollbar_ScrollTrack_NP3Dl",PlayHeadAnnotation:"horizontalscrollbar_PlayHeadAnnotation_32vHJ",RangeAnnotation:"horizontalscrollbar_RangeAnnotation_2cjQV",ScrollThumb:"horizontalscrollbar_ScrollThumb_JffqX",Highlight:"horizontalscrollbar_Highlight_1EGQ0"}},98431:e=>{e.exports={MouseListenerContainer:"mouselistenercontext_MouseListenerContainer_1t81J"}},3018:e=>{e.exports={LoadingTimeline:"timeline_LoadingTimeline__3HMM",ScrollAndControlsCtn:"timeline_ScrollAndControlsCtn_gAhqB",GamepadMode:"timeline_GamepadMode_XkOPy",Controls:"timeline_Controls_uwbPY",TimelineScrollContainer:"timeline_TimelineScrollContainer_II0EI",ContentContainer:"timeline_ContentContainer_2eSQS",AbsoluteLayer:"timeline_AbsoluteLayer_2fti4",HideOverflow:"timeline_HideOverflow_16Ta9",RelativeLayer:"timeline_RelativeLayer_1RIfc",WithPointerEvents:"timeline_WithPointerEvents_2Sk-L",RecordingDecorators:"timeline_RecordingDecorators_NBc0P",ClipDecorators:"timeline_ClipDecorators_YBRVE",GameModes:"timeline_GameModes_3vfGk",DateDecorator:"timeline_DateDecorator_kakzX",BackgroundTicks:"timeline_BackgroundTicks_3bRgO",Highlights:"timeline_Highlights_LzHSW",Timestamps:"timeline_Timestamps_36FQk",RangeSelector:"timeline_RangeSelector_3jnVE",SeekScrubber:"timeline_SeekScrubber_3x48w",PlayHead:"timeline_PlayHead_3ckxI",Thumbnails:"timeline_Thumbnails_31eJn",PositionLeft:"timeline_PositionLeft_1stnk",PositionRight:"timeline_PositionRight_2f_ks"}},99259:e=>{e.exports={LoadingTimeline:"backgroundticks_LoadingTimeline_JGGVR",ScrollAndControlsCtn:"backgroundticks_ScrollAndControlsCtn_2RzAy",GamepadMode:"backgroundticks_GamepadMode_3lpEJ",Controls:"backgroundticks_Controls_HvZN6",TimelineScrollContainer:"backgroundticks_TimelineScrollContainer_1cFVE",ContentContainer:"backgroundticks_ContentContainer_3wqjs",AbsoluteLayer:"backgroundticks_AbsoluteLayer_1vYBX",HideOverflow:"backgroundticks_HideOverflow_C6chO",RelativeLayer:"backgroundticks_RelativeLayer_1_XjI",WithPointerEvents:"backgroundticks_WithPointerEvents_2Grri",RecordingDecorators:"backgroundticks_RecordingDecorators_T_GKy",ClipDecorators:"backgroundticks_ClipDecorators_3jAa3",GameModes:"backgroundticks_GameModes_z3tCl",DateDecorator:"backgroundticks_DateDecorator_EiFtp",BackgroundTicks:"backgroundticks_BackgroundTicks_2abPm",Highlights:"backgroundticks_Highlights_2_8rC",Timestamps:"backgroundticks_Timestamps_1e7MB",RangeSelector:"backgroundticks_RangeSelector_4kLbm",SeekScrubber:"backgroundticks_SeekScrubber_23WuC",PlayHead:"backgroundticks_PlayHead_1Zf0U",Thumbnails:"backgroundticks_Thumbnails_Px56H",PositionLeft:"backgroundticks_PositionLeft_PftJQ",PositionRight:"backgroundticks_PositionRight_3lMvw",TimelineBacking:"backgroundticks_TimelineBacking_18sxa",TimeTick:"backgroundticks_TimeTick_faIAh",TickLine:"backgroundticks_TickLine_iLLzn",Major:"backgroundticks_Major_walQu",Minor:"backgroundticks_Minor_2I5ye"}},68147:e=>{e.exports={LoadingTimeline:"clipdecorators_LoadingTimeline_1ZSym",ScrollAndControlsCtn:"clipdecorators_ScrollAndControlsCtn_1q95s",GamepadMode:"clipdecorators_GamepadMode_1F4jN",Controls:"clipdecorators_Controls_z15TY",TimelineScrollContainer:"clipdecorators_TimelineScrollContainer_R0SGd",ContentContainer:"clipdecorators_ContentContainer_2XMJZ",AbsoluteLayer:"clipdecorators_AbsoluteLayer_3AkqW",HideOverflow:"clipdecorators_HideOverflow_qGvsK",RelativeLayer:"clipdecorators_RelativeLayer_3zzAf",WithPointerEvents:"clipdecorators_WithPointerEvents_3z05u",RecordingDecorators:"clipdecorators_RecordingDecorators_TlW7m",ClipDecorators:"clipdecorators_ClipDecorators_2HPd5",GameModes:"clipdecorators_GameModes_mKXM6",DateDecorator:"clipdecorators_DateDecorator_1KAHy",BackgroundTicks:"clipdecorators_BackgroundTicks_1sDp4",Highlights:"clipdecorators_Highlights_3vFdT",Timestamps:"clipdecorators_Timestamps_3esOh",RangeSelector:"clipdecorators_RangeSelector_NMfai",SeekScrubber:"clipdecorators_SeekScrubber_3n81R",PlayHead:"clipdecorators_PlayHead_1j_4J",Thumbnails:"clipdecorators_Thumbnails_1a1mk",PositionLeft:"clipdecorators_PositionLeft_3Tw8u",PositionRight:"clipdecorators_PositionRight_3OI9M",ClipDecorator:"clipdecorators_ClipDecorator_3EWp_",gradient:"clipdecorators_gradient_3vAWn"}},50804:e=>{e.exports={LoadingTimeline:"datedecorator_LoadingTimeline_3KG8z",ScrollAndControlsCtn:"datedecorator_ScrollAndControlsCtn_2Ox4l",GamepadMode:"datedecorator_GamepadMode_1Nc3R",Controls:"datedecorator_Controls_1S92s",TimelineScrollContainer:"datedecorator_TimelineScrollContainer_2yvt6",ContentContainer:"datedecorator_ContentContainer_28oA6",AbsoluteLayer:"datedecorator_AbsoluteLayer_3RYVN",HideOverflow:"datedecorator_HideOverflow_1kDYn",RelativeLayer:"datedecorator_RelativeLayer_189IQ",WithPointerEvents:"datedecorator_WithPointerEvents_V18cw",RecordingDecorators:"datedecorator_RecordingDecorators_2u47I",ClipDecorators:"datedecorator_ClipDecorators_2Lgpd",GameModes:"datedecorator_GameModes_32FUO",DateDecorator:"datedecorator_DateDecorator_3I1C0",BackgroundTicks:"datedecorator_BackgroundTicks_-YJsX",Highlights:"datedecorator_Highlights_1YMPr",Timestamps:"datedecorator_Timestamps_2GK8q",RangeSelector:"datedecorator_RangeSelector_pUP4y",SeekScrubber:"datedecorator_SeekScrubber_4LzfJ",PlayHead:"datedecorator_PlayHead_7tgJL",Thumbnails:"datedecorator_Thumbnails_TulKT",PositionLeft:"datedecorator_PositionLeft_2g51I",PositionRight:"datedecorator_PositionRight_1AQns",TimelineRelativeDate:"datedecorator_TimelineRelativeDate_xYXzi",Overlay:"datedecorator_Overlay_c1Fn5"}},58023:e=>{e.exports={LoadingTimeline:"gamemodes_LoadingTimeline_ALhsP",ScrollAndControlsCtn:"gamemodes_ScrollAndControlsCtn_5tbL0",GamepadMode:"gamemodes_GamepadMode_1dlSZ",Controls:"gamemodes_Controls_u1VLC",TimelineScrollContainer:"gamemodes_TimelineScrollContainer_2IbHV",ContentContainer:"gamemodes_ContentContainer_2akKk",AbsoluteLayer:"gamemodes_AbsoluteLayer_2e4Hs",HideOverflow:"gamemodes_HideOverflow_2Cp35",RelativeLayer:"gamemodes_RelativeLayer_124G2",WithPointerEvents:"gamemodes_WithPointerEvents_ZoJ5c",RecordingDecorators:"gamemodes_RecordingDecorators_1b3xB",ClipDecorators:"gamemodes_ClipDecorators_12hX8",GameModes:"gamemodes_GameModes_1w4EC",DateDecorator:"gamemodes_DateDecorator_2_LxF",BackgroundTicks:"gamemodes_BackgroundTicks_1wC4n",Highlights:"gamemodes_Highlights_3Mwk0",Timestamps:"gamemodes_Timestamps_2_I_T",RangeSelector:"gamemodes_RangeSelector_2509e",SeekScrubber:"gamemodes_SeekScrubber_3Re46",PlayHead:"gamemodes_PlayHead_3BW9N",Thumbnails:"gamemodes_Thumbnails_3WC2e",PositionLeft:"gamemodes_PositionLeft_m29nd",PositionRight:"gamemodes_PositionRight_3scLc",GameModeMarker:"gamemodes_GameModeMarker__XZRb",Playing:"gamemodes_Playing_1QXuD",Staging:"gamemodes_Staging_5elfn",Menus:"gamemodes_Menus_2ouy5",Unspecified:"gamemodes_Unspecified_3tV_P",GameModeMarkerClip:"gamemodes_GameModeMarkerClip_2X0XB"}},36743:e=>{e.exports={HighlightContextMenuItem:"highlightcontextmenu_HighlightContextMenuItem_28S8r",MenuItem:"highlightcontextmenu_MenuItem_JZCa0",EditMarker:"highlightcontextmenu_EditMarker_sMTce",CreateClip:"highlightcontextmenu_CreateClip_1xK5U",DeleteMarker:"highlightcontextmenu_DeleteMarker_1HITb",ViewScreenshot:"highlightcontextmenu_ViewScreenshot_2HfiR",ViewClip:"highlightcontextmenu_ViewClip_20E0p",active:"highlightcontextmenu_active_NjA0F"}},19858:e=>{e.exports={LoadingTimeline:"highlights_LoadingTimeline_2i7Ck",ScrollAndControlsCtn:"highlights_ScrollAndControlsCtn_3fITr",GamepadMode:"highlights_GamepadMode_2hCXe",Controls:"highlights_Controls_1EiX3",TimelineScrollContainer:"highlights_TimelineScrollContainer_2RYEV",ContentContainer:"highlights_ContentContainer_2lWpy",AbsoluteLayer:"highlights_AbsoluteLayer_3wd1J",HideOverflow:"highlights_HideOverflow_2PTM3",RelativeLayer:"highlights_RelativeLayer_237IH",WithPointerEvents:"highlights_WithPointerEvents_sMhiT",RecordingDecorators:"highlights_RecordingDecorators_3S9aE",ClipDecorators:"highlights_ClipDecorators_3sy9Q",GameModes:"highlights_GameModes_2zfIT",DateDecorator:"highlights_DateDecorator_2ad7Z",BackgroundTicks:"highlights_BackgroundTicks_2rdq8",Highlights:"highlights_Highlights_2MKxD",Timestamps:"highlights_Timestamps_1BmX-",RangeSelector:"highlights_RangeSelector_3Kw_b",SeekScrubber:"highlights_SeekScrubber_lP4qn",PlayHead:"highlights_PlayHead_3pAXA",Thumbnails:"highlights_Thumbnails_26VL6",PositionLeft:"highlights_PositionLeft_1UQil",PositionRight:"highlights_PositionRight_vmWKs",MarkerAndDropline:"highlights_MarkerAndDropline_KxkV7",Faded:"highlights_Faded_2YIhg",NoPointer:"highlights_NoPointer_2ebcC",TimelineMarkerCtn:"highlights_TimelineMarkerCtn_1Dg_c",TimelineMarker:"highlights_TimelineMarker_2CNnK",DroplineCtn:"highlights_DroplineCtn_2KKJR",TimelineMarkerDropLine:"highlights_TimelineMarkerDropLine_3JsMm"}},37231:e=>{e.exports={thumbnailWidth:"320",LoadingTimeline:"playhead_LoadingTimeline_2X7jh",ScrollAndControlsCtn:"playhead_ScrollAndControlsCtn_3NY57",GamepadMode:"playhead_GamepadMode_3LWcS",Controls:"playhead_Controls_3iXWp",TimelineScrollContainer:"playhead_TimelineScrollContainer_3A2oP",ContentContainer:"playhead_ContentContainer_37F8T",AbsoluteLayer:"playhead_AbsoluteLayer_2TPYT",HideOverflow:"playhead_HideOverflow_1GDbd",RelativeLayer:"playhead_RelativeLayer_1Gp1j",WithPointerEvents:"playhead_WithPointerEvents_2Wca3",RecordingDecorators:"playhead_RecordingDecorators_2yAWb",ClipDecorators:"playhead_ClipDecorators_1vxxh",GameModes:"playhead_GameModes_2W6eC",DateDecorator:"playhead_DateDecorator_2XW6U",BackgroundTicks:"playhead_BackgroundTicks_3Tt6W",Highlights:"playhead_Highlights_1epMF",Timestamps:"playhead_Timestamps_2of-N",RangeSelector:"playhead_RangeSelector_bBVOL",SeekScrubber:"playhead_SeekScrubber_1c_f2",PlayHead:"playhead_PlayHead_NAXFU",Thumbnails:"playhead_Thumbnails_FNvG_",PositionLeft:"playhead_PositionLeft_GECyy",PositionRight:"playhead_PositionRight_3Rwz0",PlayheadInteractionCtn:"playhead_PlayheadInteractionCtn_3_VTf",ActiveCtn:"playhead_ActiveCtn_2bsFx",PlayHeadContainer:"playhead_PlayHeadContainer_2Rtcu",TooltipSource:"playhead_TooltipSource_DgGCj",Active:"playhead_Active_3N6L2",PlayHeadContent:"playhead_PlayHeadContent_1zm_a",PlayHeadCurrentTimeContainer:"playhead_PlayHeadCurrentTimeContainer_38jg4",NoPointer:"playhead_NoPointer_2qwpl"}},30321:e=>{e.exports={thumbnailWidth:"320",LoadingTimeline:"rangeselector_LoadingTimeline_15xYd",ScrollAndControlsCtn:"rangeselector_ScrollAndControlsCtn_39WVq",GamepadMode:"rangeselector_GamepadMode_1iVq_",Controls:"rangeselector_Controls_q39fh",TimelineScrollContainer:"rangeselector_TimelineScrollContainer_2Ns82",ContentContainer:"rangeselector_ContentContainer_2flM0",AbsoluteLayer:"rangeselector_AbsoluteLayer_hPYov",HideOverflow:"rangeselector_HideOverflow_zl42_",RelativeLayer:"rangeselector_RelativeLayer_wxj4I",WithPointerEvents:"rangeselector_WithPointerEvents_2AobD",RecordingDecorators:"rangeselector_RecordingDecorators_1hCGw",ClipDecorators:"rangeselector_ClipDecorators_1d_mX",GameModes:"rangeselector_GameModes_26Bbv",DateDecorator:"rangeselector_DateDecorator_2BqCI",BackgroundTicks:"rangeselector_BackgroundTicks_2YoyA",Highlights:"rangeselector_Highlights_2hsue",Timestamps:"rangeselector_Timestamps_3O3iR",RangeSelector:"rangeselector_RangeSelector_2gSg5",SeekScrubber:"rangeselector_SeekScrubber_sTaCR",PlayHead:"rangeselector_PlayHead_3Ra6B",Thumbnails:"rangeselector_Thumbnails_7KwbB",PositionLeft:"rangeselector_PositionLeft_27IW3",PositionRight:"rangeselector_PositionRight_xf_Nx",RangeControls:"rangeselector_RangeControls_3TsJz",RangeSelectorCtn:"rangeselector_RangeSelectorCtn_2ULjG",Active:"rangeselector_Active_2bFlc",InactiveSelectedRangeControl:"rangeselector_InactiveSelectedRangeControl_2uX26",SelectedRangeMask:"rangeselector_SelectedRangeMask_2C2hW",RangeIcon:"rangeselector_RangeIcon_DTarG",Hide:"rangeselector_Hide_2Oktu",TrackRangeControls:"rangeselector_TrackRangeControls_1xinh",RangeControl:"rangeselector_RangeControl_106ZA",RangeMask:"rangeselector_RangeMask_1SW3y",FullMask:"rangeselector_FullMask_HBfBm"}},77679:e=>{e.exports={LoadingTimeline:"recordingdecorator_LoadingTimeline_3tH-U",ScrollAndControlsCtn:"recordingdecorator_ScrollAndControlsCtn_3EGBZ",GamepadMode:"recordingdecorator_GamepadMode_3Wahm",Controls:"recordingdecorator_Controls_3nrFG",TimelineScrollContainer:"recordingdecorator_TimelineScrollContainer_3vqWS",ContentContainer:"recordingdecorator_ContentContainer_2_mqy",AbsoluteLayer:"recordingdecorator_AbsoluteLayer_CiFLr",HideOverflow:"recordingdecorator_HideOverflow_2BoIL",RelativeLayer:"recordingdecorator_RelativeLayer_3obgM",WithPointerEvents:"recordingdecorator_WithPointerEvents_1e6-Z",RecordingDecorators:"recordingdecorator_RecordingDecorators_3l9q4",ClipDecorators:"recordingdecorator_ClipDecorators_1HU0h",GameModes:"recordingdecorator_GameModes_2FL-N",DateDecorator:"recordingdecorator_DateDecorator_2bCxb",BackgroundTicks:"recordingdecorator_BackgroundTicks_2UfqY",Highlights:"recordingdecorator_Highlights_2iZX0",Timestamps:"recordingdecorator_Timestamps_2TfF2",RangeSelector:"recordingdecorator_RangeSelector_wMeTv",SeekScrubber:"recordingdecorator_SeekScrubber_1x23j",PlayHead:"recordingdecorator_PlayHead_3hU0q",Thumbnails:"recordingdecorator_Thumbnails_3U1E2",PositionLeft:"recordingdecorator_PositionLeft_3a7NF",PositionRight:"recordingdecorator_PositionRight_2aWYE",RecordingDecorator:"recordingdecorator_RecordingDecorator_24zNS",Clip:"recordingdecorator_Clip_3Q-H1",ClipMode:"recordingdecorator_ClipMode__7MCq",Manual:"recordingdecorator_Manual_1kfoF",RecordingDecoratorClip:"recordingdecorator_RecordingDecoratorClip_3d4VU",LiveRecordingBuffer:"recordingdecorator_LiveRecordingBuffer_3PHrI",IsLive:"recordingdecorator_IsLive_1kxbP"}},13603:e=>{e.exports={thumbnailWidth:"320",LoadingTimeline:"seekscrubber_LoadingTimeline_3Tmq4",ScrollAndControlsCtn:"seekscrubber_ScrollAndControlsCtn_2zSlR",GamepadMode:"seekscrubber_GamepadMode_1iEsh",Controls:"seekscrubber_Controls_3Sigu",TimelineScrollContainer:"seekscrubber_TimelineScrollContainer_36TGe",ContentContainer:"seekscrubber_ContentContainer_2mJpX",AbsoluteLayer:"seekscrubber_AbsoluteLayer_1hyNg",HideOverflow:"seekscrubber_HideOverflow_1IkW2",RelativeLayer:"seekscrubber_RelativeLayer_1RLJo",WithPointerEvents:"seekscrubber_WithPointerEvents_1o2r-",RecordingDecorators:"seekscrubber_RecordingDecorators_2qcUY",ClipDecorators:"seekscrubber_ClipDecorators_3qqUO",GameModes:"seekscrubber_GameModes_2K3UB",DateDecorator:"seekscrubber_DateDecorator_2BEmr",BackgroundTicks:"seekscrubber_BackgroundTicks_WbVOg",Highlights:"seekscrubber_Highlights_2nvnM",Timestamps:"seekscrubber_Timestamps_R3B96",RangeSelector:"seekscrubber_RangeSelector_3DWye",SeekScrubber:"seekscrubber_SeekScrubber_2wVY5",PlayHead:"seekscrubber_PlayHead_3knz_",Thumbnails:"seekscrubber_Thumbnails_JjnuX",PositionLeft:"seekscrubber_PositionLeft_feeCz",PositionRight:"seekscrubber_PositionRight_1uGyz",PlayheadInteractionCtn:"seekscrubber_PlayheadInteractionCtn_cxkAk",ActiveCtn:"seekscrubber_ActiveCtn_3HMQw",PlayHeadContainer:"seekscrubber_PlayHeadContainer_3Fg3B",TooltipSource:"seekscrubber_TooltipSource_1zTEV",Active:"seekscrubber_Active_G8XiK",PlayHeadContent:"seekscrubber_PlayHeadContent_t2rs7",PlayHeadCurrentTimeContainer:"seekscrubber_PlayHeadCurrentTimeContainer_1BM_Z",NoPointer:"seekscrubber_NoPointer_XCAfY",RangeControls:"seekscrubber_RangeControls_2ylJ7",RangeSelectorCtn:"seekscrubber_RangeSelectorCtn_35GmR",InactiveSelectedRangeControl:"seekscrubber_InactiveSelectedRangeControl__bKQM",SelectedRangeMask:"seekscrubber_SelectedRangeMask_3PO0l",RangeIcon:"seekscrubber_RangeIcon_3H1CU",Hide:"seekscrubber_Hide_1YPpC",TrackRangeControls:"seekscrubber_TrackRangeControls_23YDd",RangeControl:"seekscrubber_RangeControl_3Z9hk",RangeMask:"seekscrubber_RangeMask_Cr2Md",FullMask:"seekscrubber_FullMask_3qoMx",GhostPlayheadCtn:"seekscrubber_GhostPlayheadCtn_2QEZw",TooltipHoverSource:"seekscrubber_TooltipHoverSource_3GHTk",GhostPlayhead:"seekscrubber_GhostPlayhead_1NsKS",Show:"seekscrubber_Show_2rHDn"}},19784:e=>{e.exports={thumbnailWidth:"320",LoadingTimeline:"thumbnailtooltip_LoadingTimeline_3Q5mI",ScrollAndControlsCtn:"thumbnailtooltip_ScrollAndControlsCtn_1fH0O",GamepadMode:"thumbnailtooltip_GamepadMode_2t0z1",Controls:"thumbnailtooltip_Controls_2LpY_",TimelineScrollContainer:"thumbnailtooltip_TimelineScrollContainer_1q2Ql",ContentContainer:"thumbnailtooltip_ContentContainer_cUBJW",AbsoluteLayer:"thumbnailtooltip_AbsoluteLayer_1pSOl",HideOverflow:"thumbnailtooltip_HideOverflow_2hT8A",RelativeLayer:"thumbnailtooltip_RelativeLayer_3zkqu",WithPointerEvents:"thumbnailtooltip_WithPointerEvents_2KJPu",RecordingDecorators:"thumbnailtooltip_RecordingDecorators_2lJHa",ClipDecorators:"thumbnailtooltip_ClipDecorators_Xqf7V",GameModes:"thumbnailtooltip_GameModes_Z9nyG",DateDecorator:"thumbnailtooltip_DateDecorator_1H35H",BackgroundTicks:"thumbnailtooltip_BackgroundTicks_2Qp-o",Highlights:"thumbnailtooltip_Highlights_1pFb1",Timestamps:"thumbnailtooltip_Timestamps_3fHbN",RangeSelector:"thumbnailtooltip_RangeSelector_3ovQq",SeekScrubber:"thumbnailtooltip_SeekScrubber_3YSdu",PlayHead:"thumbnailtooltip_PlayHead_3uZ7P",Thumbnails:"thumbnailtooltip_Thumbnails_2ZT_p",PositionLeft:"thumbnailtooltip_PositionLeft_2dupD",PositionRight:"thumbnailtooltip_PositionRight_1PDRo",TooltipOffset:"thumbnailtooltip_TooltipOffset_2dYuD",ThumbnailContainerOffset:"thumbnailtooltip_ThumbnailContainerOffset_iJ-nn",ThumbnailContents:"thumbnailtooltip_ThumbnailContents_1p6K1",Hide:"thumbnailtooltip_Hide_1IGjt",ImageAndInfoBoxContainer:"thumbnailtooltip_ImageAndInfoBoxContainer_ke2xS",ImageContainer:"thumbnailtooltip_ImageContainer_16W4i",ThumbnailImage:"thumbnailtooltip_ThumbnailImage_15YmE",NoRecordedContent:"thumbnailtooltip_NoRecordedContent_2oSbw",InfoBoxContainer:"thumbnailtooltip_InfoBoxContainer_39hE1",Header:"thumbnailtooltip_Header_1RvdZ",Icon:"thumbnailtooltip_Icon_3ALDT",DescriptionBlock:"thumbnailtooltip_DescriptionBlock_2WNbT",Title:"thumbnailtooltip_Title_2xgQk",Description:"thumbnailtooltip_Description_3wvMa",ThumbnailHitBoxPadding:"thumbnailtooltip_ThumbnailHitBoxPadding_25m6S",Overlay:"thumbnailtooltip_Overlay_1F33W",TooltipContents:"thumbnailtooltip_TooltipContents_1Q9Po",TooltipChildren:"thumbnailtooltip_TooltipChildren_2T0U4",TooltipImage:"thumbnailtooltip_TooltipImage_1xD6j",TooltipImageCtn:"thumbnailtooltip_TooltipImageCtn_1v_O5",ThumbnailTooltip:"thumbnailtooltip_ThumbnailTooltip_2Z4RG",Highlight:"thumbnailtooltip_Highlight_3a20-",TimeDisplayContainer:"thumbnailtooltip_TimeDisplayContainer_3d8jw",Playhead:"thumbnailtooltip_Playhead_2n75O",RangeLeft:"thumbnailtooltip_RangeLeft_1gO9x",RangeRight:"thumbnailtooltip_RangeRight_JDbwF",Timestamp:"thumbnailtooltip_Timestamp_2lPBQ",TooltipInteractionRegion:"thumbnailtooltip_TooltipInteractionRegion_nbJB1",StateDescription:"thumbnailtooltip_StateDescription_u04UC",TooltipButtons:"thumbnailtooltip_TooltipButtons_2__OP",Button:"thumbnailtooltip_Button_15dYn",AddMarker:"thumbnailtooltip_AddMarker_1U3RG",GoToClip:"thumbnailtooltip_GoToClip_38jzR",CreateClipButton:"thumbnailtooltip_CreateClipButton_3KYRS",EditMarker:"thumbnailtooltip_EditMarker_2ho8q",DeleteMarker:"thumbnailtooltip_DeleteMarker_113MC",GoToClipFromMarker:"thumbnailtooltip_GoToClipFromMarker_1HHxK",ViewScreenshot:"thumbnailtooltip_ViewScreenshot_Id7gM",TooltipHitBox:"thumbnailtooltip_TooltipHitBox_2QbCh",TooltipContainer:"thumbnailtooltip_TooltipContainer_1sw-k",ImageHighlightPosition:"thumbnailtooltip_ImageHighlightPosition_2ywON",ImageHighlightBlock:"thumbnailtooltip_ImageHighlightBlock_1BeXp"}},9176:e=>{e.exports={TimelineContextMenuItem:"timelinecontextmenu_TimelineContextMenuItem_1_VGc",MenuItem:"timelinecontextmenu_MenuItem_1wPm9",AddUserMarker:"timelinecontextmenu_AddUserMarker_3VSFd",TakeScreenshot:"timelinecontextmenu_TakeScreenshot_13th0",StartEndClip:"timelinecontextmenu_StartEndClip_1eb1c",ViewClip:"timelinecontextmenu_ViewClip_3YpMy",active:"timelinecontextmenu_active_1D7oi"}},40813:e=>{e.exports={ErrorStyles:"partnereventdialog_ErrorStyles_2Sg7W",ErrorStylesWithIcon:"partnereventdialog_ErrorStylesWithIcon_Lc2PK",ErrorIconLayout:"partnereventdialog_ErrorIconLayout_42__6",ErrorStylesBackground:"partnereventdialog_ErrorStylesBackground_3fVv6",ErrorFloatBelow:"partnereventdialog_ErrorFloatBelow_2aKyl",WarningStyles:"partnereventdialog_WarningStyles_3gxgE",WarningStylesWithIcon:"partnereventdialog_WarningStylesWithIcon_1S_uS",WarningIconLayout:"partnereventdialog_WarningIconLayout_2jM80",WarningStylesBackground:"partnereventdialog_WarningStylesBackground_UYrHs",Stuck:"partnereventdialog_Stuck_2b5wW",WarningFloatBelow:"partnereventdialog_WarningFloatBelow_3e0cN",InfoStyles:"partnereventdialog_InfoStyles_2lreM",InfoStylesWithIcon:"partnereventdialog_InfoStylesWithIcon_1_-Pi",InfoIconLayout:"partnereventdialog_InfoIconLayout_3kyPz",InfoStylesBackground:"partnereventdialog_InfoStylesBackground_3gNTI",Padding:"partnereventdialog_Padding_36hma",NotTooWideModal:"partnereventdialog_NotTooWideModal_UfQcb",ImageManageDialog:"partnereventdialog_ImageManageDialog_Pl7AI",SuccessErrorDialog:"partnereventdialog_SuccessErrorDialog_1wBO1"}},63429:e=>{e.exports={"duration-app-launch":"800ms",TourPositioner:"tour_TourPositioner_3SETp",TourBox:"tour_TourBox_1lciz",CloseButton:"tour_CloseButton_1A5Ql",X:"tour_X_kcjJI",Title:"tour_Title_51Xf1",Content:"tour_Content_1iiz2",Action:"tour_Action_39eWK",TipCount:"tour_TipCount_1T5Zu",TourStopArrow:"tour_TourStopArrow_2JvQP",BackgroundAnimation:"tour_BackgroundAnimation_15yvW","ItemFocusAnim-darkerGrey-nocolor":"tour_ItemFocusAnim-darkerGrey-nocolor_Eu2HO","ItemFocusAnim-darkerGrey":"tour_ItemFocusAnim-darkerGrey_DvP1w","ItemFocusAnim-darkGrey":"tour_ItemFocusAnim-darkGrey_2tQsB","ItemFocusAnim-grey":"tour_ItemFocusAnim-grey_Qg-4W","ItemFocusAnim-translucent-white-10":"tour_ItemFocusAnim-translucent-white-10_18ENJ","ItemFocusAnim-translucent-white-20":"tour_ItemFocusAnim-translucent-white-20_1wbIE","ItemFocusAnimBorder-darkGrey":"tour_ItemFocusAnimBorder-darkGrey_3hC5O","ItemFocusAnim-green":"tour_ItemFocusAnim-green_3ZDnx"}},63840:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var i=n(63696),r=n(51674),o=n(84881);function l(e){let{clipID:t,className:n}=e;const r=(0,o.uX)(t);return r?.thumbnail_url?i.createElement("img",{className:n,src:r.thumbnail_url}):i.createElement("div",{className:n})}var a=n(97775),s=n(62770),c=n(46748);function m(e){const{clipToUpload:t,finishUpload:n}=e,[r,s]=i.useState(!1),[m,u]=i.useState(),{fnUploadClip:h}=(0,o.Sm)(),[_,g]=i.useState();if(!t)return null;return i.createElement("div",{className:c.ClipUploadStatus},i.createElement(l,{clipID:t.clip_id}),!r&&i.createElement(a.$n,{onClick:async()=>{s(!0);const{eResult:e,strURL:i}=await h(t.clip_id,"","",3);n(i),s(!1)}},"Upload"),r&&i.createElement(d,{clipToUpload:t}))}function d(e){const{clipToUpload:t}=e,[n,o]=i.useState(),[l,a]=i.useState();i.useEffect((()=>r.xM.RegisterForNotifyUploadProgress((e=>(void 0===e.Body().eresult()?o(100*e.Body().progress()):o(void 0),1))).unregister),[]);let c=(0,s.we)("#Chat_Uploading",t.clip_id),m={width:n+"%"};return i.createElement("div",{className:"chatFileUploadProgressContainer"},i.createElement("div",{className:"chatFileUploadProgressName"},c),i.createElement("div",{className:"chatFileUploadProgressBarContainer DialogProgressBar_ProgressBarContainer"},i.createElement("div",{className:"DialogProgressBar_Value",style:m})))}},74334:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>vi,useTimelineLoaderForCommunityClip:()=>Mi});var i,r=n(63696),o=n(34629),l=n(78476),a=n(89193),s=n(90035),c=n(83235),m=n(84881),d=n(72246),u=n(29080),h=n(78491),_=n(13171),g=n(33868),f=n(36243);!function(e){e[e.None=0]="None",e[e.DownloadFailed=1]="DownloadFailed",e[e.PlaybackError=2]="PlaybackError"}(i||(i={}));class S{m_elVideo=null;m_player=null;m_listeners=new f.Ji;m_nDownloadFailureCount=0;m_bInitailized=!1;m_bPaused=!1;m_bAtEnd=!1;m_ePlayerError=i.None;m_bUserInputNeeded=!1;m_bMuted=!1;m_bSeekReadyToPlay=!1;m_bVideoElementPlaying=!1;m_nPlaybackSpeed=1;m_bIsWaiting=!0;m_bAutoPlay;m_bLoadedMetadata=!1;m_nPlaybackTime=0;m_nVideoStartTime=0;m_nVideoDuration=0;m_nVolume=1;m_eSeekType=g.lU.Absolute;constructor(e){(0,a.Gn)(this),this.m_bAutoPlay=!!e}IsPaused(){return this.m_bPaused}IsAtEnd(){return this.m_bAtEnd}BSeekReadyToPlay(){return this.m_bSeekReadyToPlay}GetPlaybackError(){return this.m_ePlayerError}GetUserInputNeeded(){return this.m_bUserInputNeeded}GetPlaybackTime(){return this.m_eSeekType===g.lU.Absolute?this.m_nPlaybackTime:this.m_nPlaybackTime-this.m_nVideoStartTime}GetTimelineDuration(){return this.m_eSeekType===g.lU.Absolute?this.m_nVideoDuration:this.m_nVideoDuration-this.m_nVideoStartTime}GetVolume(){return this.m_nVolume}GetMuted(){return this.m_bMuted}GetMPDURL(){return this.m_player?.GetMPDURL()}GetVideoElementCurrentTime(){return this.m_elVideo?.currentTime}BVideoElementPlaying(){return this.m_bVideoElementPlaying}BVideoElementWaiting(){return this.m_bIsWaiting}GetVideoHeight(){return this.m_elVideo?.clientHeight||0}GetVideoWidth(){return this.m_elVideo?.clientWidth||0}GetLoadedMetadata(){return this.m_bLoadedMetadata}Start(e,t,n,i=g.lU.Absolute){this.Stop(),this.m_bAtEnd=!1,this.m_elVideo=e,this.m_listeners.AddEventListener(this.m_elVideo,"valve-userpausechange",this.OnUserPauseChange),this.m_listeners.AddEventListener(this.m_elVideo,"playing",this.OnVideoPlaying),this.m_listeners.AddEventListener(this.m_elVideo,"pause",this.OnVideoPause),this.m_listeners.AddEventListener(this.m_elVideo,"timeupdate",this.OnVideoTimeUpdate),this.m_listeners.AddEventListener(this.m_elVideo,"ended",this.OnVideoEnd),this.m_listeners.AddEventListener(this.m_elVideo,"valve-bufferupdate",this.OnVideoTimeUpdate),this.m_listeners.AddEventListener(this.m_elVideo,"valve-downloadfailed",this.OnDownloadFailed),this.m_listeners.AddEventListener(this.m_elVideo,"valve-playbackerror",this.OnPlaybackError),this.m_listeners.AddEventListener(this.m_elVideo,"valve-userinputneeded",this.OnUserInputNeeded),this.m_listeners.AddEventListener(this.m_elVideo,"waiting",this.OnVideoWaiting),this.m_listeners.AddEventListener(this.m_elVideo,"volumechange",this.OnVolumeChange),this.m_listeners.AddEventListener(this.m_elVideo,"canplay",this.OnCanPlay),this.m_listeners.AddEventListener(this.m_elVideo,"seeking",this.OnSeeking),this.m_listeners.AddEventListener(this.m_elVideo,"loadedmetadata",this.OnLoadedMetadata),this.m_player=new g.Zn(this.m_elVideo,!1),this.m_player.SetUserPlayChoice(this.m_bAutoPlay),this.m_player.PlayMPD(t,null,null),this.m_bMuted=C("muted"),this.m_nVolume=C("volume"),this.m_player.SetMuted(this.m_bMuted),this.m_player.SetVolume(this.m_nVolume),this.m_bSeekReadyToPlay=!1,this.m_eSeekType=i;const r=`seeking_${t}_${n.toFixed(3)}`;(0,s.q_)(`CGameRecordingVideo:: perf mark ${r}`),performance.mark(r),this.m_player.Seek(n,this.m_eSeekType),this.m_bPaused=this.m_player.IsPaused(),this.m_bInitailized=!0}Stop(){this.m_listeners.Unregister(),this.m_player&&this.m_player.Close(),this.m_elVideo=null,this.m_player=null,this.m_bInitailized=!1,this.m_bPaused=!1,this.m_bAtEnd=!1,this.m_bSeekReadyToPlay=!1,this.m_bVideoElementPlaying=!1,this.m_ePlayerError=i.None,this.m_bUserInputNeeded=!1,this.m_nPlaybackTime=0,this.m_nVideoStartTime=0,this.m_nVideoDuration=0,this.m_bLoadedMetadata=!1,this.m_bIsWaiting=!0}async UpdateMPD(){await(this.m_player?.UpdateMPD())}IsInitialized(){return this.m_bInitailized}OnCanPlay(){this.m_bSeekReadyToPlay=!0,this.m_bAtEnd=!1}OnUserPauseChange(){this.m_bPaused=this.m_player.IsPaused()}OnVideoPlaying(){this.m_bVideoElementPlaying=!0,this.m_bIsWaiting=!1,this.SetPlaybackSpeed(this.m_nPlaybackSpeed),(0,s.tG)("video playing")}OnVideoPause(){this.m_bVideoElementPlaying=!1,(0,s.tG)("video paused")}OnVideoTimeUpdate(){this.m_nVideoStartTime=this.m_player.GetAvailableVideoStartTime(),this.m_nVideoDuration=this.m_player.GetBufferedLiveEdgeTime(),this.m_nPlaybackTime=this.m_player.GetCurrentPlayTime(),this.m_nPlaybackTime>=this.m_nVideoDuration&&this.m_bVideoElementPlaying&&(this.m_bVideoElementPlaying=!1,this.m_bAtEnd=!0)}OnVideoEnd(){this.m_bVideoElementPlaying=!1,this.m_bAtEnd=!0,(0,s.tG)("video ended")}OnSeeking(){(0,s.tG)("video on seeking"),this.m_bVideoElementPlaying=!1,this.m_nVideoDuration-this.m_nPlaybackTime<1?this.m_bAtEnd=!0:(this.m_bIsWaiting=!0,this.m_bAtEnd=!1)}OnLoadedMetadata(){this.m_bLoadedMetadata=!0}async OnDownloadFailed(){(0,s.ZI)("video download failed"),this.m_nDownloadFailureCount<2?(await(this.m_player?.UpdateMPD()),this.m_nDownloadFailureCount++):this.m_ePlayerError=i.DownloadFailed}OnPlaybackError(){this.m_bVideoElementPlaying=!1,(0,s.ZI)("video playback error"),this.m_ePlayerError=i.PlaybackError}OnUserInputNeeded(){this.m_bUserInputNeeded=!0,!this.m_bMuted&&this.m_elVideo.autoplay&&((0,s.fX)("Failed to autoplay video. Muting and trying again."),this.SetMute(!0),this.Play())}OnVolumeChange(){(0,s.tG)("volume change")}OnVideoWaiting(){this.m_bIsWaiting=!0,this.m_bVideoElementPlaying=!1,this.GetTimelineDuration()-this.GetPlaybackTime()<1&&(this.m_bAtEnd=!0)}UserInputReceived(){this.IsInitialized()&&(this.m_bUserInputNeeded=!1,this.m_player.SeekAndPlay(0))}SetVolume(e){this.m_nVolume=e,v("volume",e),e>0?this.SetMute(!1,!0):this.SetMute(!0,!0),this.IsInitialized()&&this.m_player.SetVolume(e)}SetMute(e,t){this.IsInitialized()&&this.m_player.SetMuted(e),this.m_bMuted=e,t&&v("muted",e)}TogglePlayPause(){this.IsInitialized()&&(this.m_player.IsPaused()?this.Play():this.Pause())}Play(){this.IsInitialized()&&this.m_player.Play()}Pause(){this.IsInitialized()&&(this.m_player.Pause(),this.m_bIsWaiting=!1)}SetPlaybackSpeed(e){this.m_nPlaybackSpeed=e,this.IsInitialized()&&(this.m_elVideo.playbackRate=e)}GetPlaybackSpeed(){return this.m_nPlaybackSpeed}Seek(e){if(!this.IsInitialized())return;const t=`seeking_${this.m_player.GetMPDURL()}_${e.toFixed(3)}`;this.m_bAtEnd=!1,this.m_bSeekReadyToPlay=!1,performance.mark(t),(0,s.q_)(`CGameRecordingVideo:: perf mark ${t}`),(0,s.q_)(`CGameRecordingVideo::Seek to ${e}`),this.m_nPlaybackTime=e,this.m_player.Seek(e,this.m_eSeekType)}}let p;function b(){if(!p){let e,t=window.localStorage.getItem("gameRecordingPlayer")||"{}";try{e=JSON.parse(t)}catch(t){e={}}p={muted:e.muted||!1,volume:e.volume||1}}return p}function C(e){return b()[e]}function v(e,t){let n=b();n[e]=t;let i=JSON.stringify(n);window.localStorage.setItem("gameRecordingPlayer",i)}(0,o.Cg)([a.sH],S.prototype,"m_bInitailized",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bPaused",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bAtEnd",void 0),(0,o.Cg)([a.sH],S.prototype,"m_ePlayerError",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bUserInputNeeded",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bMuted",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bSeekReadyToPlay",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bVideoElementPlaying",void 0),(0,o.Cg)([a.sH],S.prototype,"m_nPlaybackSpeed",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bIsWaiting",void 0),(0,o.Cg)([a.sH],S.prototype,"m_bLoadedMetadata",void 0),(0,o.Cg)([a.sH],S.prototype,"m_nPlaybackTime",void 0),(0,o.Cg)([a.sH],S.prototype,"m_nVideoStartTime",void 0),(0,o.Cg)([a.sH],S.prototype,"m_nVideoDuration",void 0),(0,o.Cg)([a.sH],S.prototype,"m_nVolume",void 0),(0,o.Cg)([a.sH],S.prototype,"m_eSeekType",void 0),(0,o.Cg)([a.XI],S.prototype,"Start",null),(0,o.Cg)([a.XI],S.prototype,"Stop",null),(0,o.Cg)([l.oI],S.prototype,"OnCanPlay",null),(0,o.Cg)([l.oI],S.prototype,"OnUserPauseChange",null),(0,o.Cg)([l.oI],S.prototype,"OnVideoPlaying",null),(0,o.Cg)([l.oI],S.prototype,"OnVideoPause",null),(0,o.Cg)([l.oI],S.prototype,"OnVideoTimeUpdate",null),(0,o.Cg)([l.oI],S.prototype,"OnVideoEnd",null),(0,o.Cg)([l.oI],S.prototype,"OnSeeking",null),(0,o.Cg)([l.oI],S.prototype,"OnLoadedMetadata",null),(0,o.Cg)([l.oI],S.prototype,"OnDownloadFailed",null),(0,o.Cg)([l.oI],S.prototype,"OnPlaybackError",null),(0,o.Cg)([l.oI],S.prototype,"OnUserInputNeeded",null),(0,o.Cg)([l.oI],S.prototype,"OnVolumeChange",null),(0,o.Cg)([l.oI],S.prototype,"OnVideoWaiting",null),(0,o.Cg)([l.oI],S.prototype,"UserInputReceived",null);var y,M=n(90095),T=n(79558),P=n(63699),G=n(62770),E=n(36365),k=n(26525),R=n(59301);function I(){const e=O(q().GetGameID());return e===y.NotRecording||e===y.NotRunning?null:r.createElement(D,null)}function D(e){const t=q(),n=(0,M.q3)((()=>t.GetIsLiveEdge()&&!t.GetHidePlayer())),i=r.useCallback((()=>{t.SetHidePlayer(!1),t.GetGameRecordingVideo().Play();const e=t.GetLiveEdgeMS();t.SetPlaytimeFromGlobalMS(e),t.FocusGlobalMS(e)}),[t]);return r.createElement(E.he,{className:T.GoLiveButtonCtn,toolTipContent:(0,G.we)(n?"#Playback_AtLatest":"#Playback_JumpToLatest"),direction:"bottom"},r.createElement(R.Z,{onClick:i,className:(0,P.A)(T.GoLiveButton,n&&T.IsLive)},r.createElement(k.xA,{className:(0,P.A)(T.JumpToEndIcon)})))}function O(e){const{app:t}=(0,m.Ks)(e);if(!t)return y.NotRecording;switch(t.recording_type){default:case 0:case 1:return y.NotRecording;case 2:return y.ManualRecording;case 3:return y.BackgroundRecording}}!function(e){e.NotRunning="NotRunning",e.NotRecording="NotRecording",e.ManualRecording="ManualRecording",e.BackgroundRecording="BackgroundRecording",e.ForeverRecording="ForeverRecording"}(y||(y={}));var A=n(71342);class L{m_markerStore=null;constructor(){(0,a.Gn)(this)}Init(e){this.m_markerStore=e}GetMarkerStore(){return this.m_markerStore}static s_Singleton;static Get(){return L.s_Singleton||(L.s_Singleton=new L,"dev"==A.TS.WEB_UNIVERSE&&(window.g_MarkerStore=L.s_Singleton)),L.s_Singleton}}(0,o.Cg)([a.sH],L.prototype,"m_markerStore",void 0);var w,X,V=n(27931);!function(e){e.Overlay="Overlay",e.Clips="Clips",e.Background="Background",e.CommunityClip="Community",e.ChatClip="Chat",e.Partner="Partner"}(w||(w={})),function(e){e.Never="Never",e.Always="Always",e.Manual="Manual"}(X||(X={}));const N=3*d.kh,x=d.kh+1e3,H=1e3;class F{m_gameRecordingVideo=null;m_timelineLoader=null;m_fnUnregisterLoader=null;m_rgListeners=[];m_videoRef;m_bHidePlayer=!1;m_fnGetManifest;m_strRecordingID=null;m_nPendingSeekSec=-1;m_playbackDefinition=null;m_pendingStop=null;m_durationMS=(0,h.Sb)(null);m_lastRecordingGlobalMS=(0,h.Sb)(null);m_nGlobalTimelinePlaybackMS=null;m_nGlobalTimelinePlaybackSec=null;m_fnUnregisterAutorun=[];m_eGameRecordingMode;m_rgSeekPerf=[];m_eRecordingState=y.NotRecording;m_eRecordingSetting=X.Never;m_bGamepadMode=!1;m_bControlsVisible=!0;m_fnRenderGlyph=void 0;m_previousHighlightEntry=null;m_nextHighlightEntry=null;m_displayHighlightEntry=null;m_nRelativeTimeForDisplay=void 0;m_rgClipOffsets=[];constructor(e,t,n,i,r,o,l,c){(0,a.Gn)(this),this.m_fnGetManifest=t,this.m_gameRecordingVideo=new S(!0),this.m_eGameRecordingMode=n,this.m_bGamepadMode=r,this.m_playbackDefinition=l,null!=i&&(this.m_bControlsVisible=i),"Overlay"===n&&(this.m_bHidePlayer=!0),c&&this.SetClipOffsets(c),this.m_fnRenderGlyph=o,this.m_fnUnregisterAutorun.push((0,a.mJ)((()=>({bIsAtEnd:this.m_gameRecordingVideo.IsAtEnd(),bIsPaused:this.m_gameRecordingVideo.IsPaused()})),(e=>{e.bIsAtEnd&&!e.bIsPaused&&this.PlayNextTimelineRecording()}),{fireImmediately:!0})),this.m_fnUnregisterAutorun.push((0,a.mJ)((()=>this.m_gameRecordingVideo.GetPlaybackTime()),(e=>{if(this.m_pendingStop&&this.m_pendingStop.m_strRecordingID==this.m_strRecordingID&&this.m_pendingStop.m_nOffsetMS<=1e3*e){if(this.m_playbackDefinition)return void this.StartPlaybackForRange();this.m_gameRecordingVideo.Pause(),this.m_pendingStop=null}}),{fireImmediately:!0})),this.m_fnUnregisterAutorun.push((0,a.mJ)((()=>({playback:this.m_gameRecordingVideo.GetPlaybackTime(),bVideoPlaying:this.m_gameRecordingVideo.BVideoElementPlaying()})),(e=>{if(e.bVideoPlaying){const t=this.m_timelineLoader.ConvertRecordingOffsetToGlobalOffset(this.m_strRecordingID,1e3*e.playback,0);if(t)this.UpdateGlobalPlayTime(t.nGlobalOffsetMS),t.nGlobalOffsetMS>this.GetLiveEdgeMS().valMS&&"Overlay"===this.m_eGameRecordingMode&&this.m_gameRecordingVideo.GetPlaybackSpeed()>1&&(console.log(" hitting live edge, slow down the playback "),this.m_gameRecordingVideo.SetPlaybackSpeed(1));else{const e=this.GetLiveEdgeMS();isNaN(e.valMS)||(this.SetPlaytimeFromGlobalMS(e),this.FocusGlobalMS(e))}}}),{fireImmediately:!0})),this.m_fnUnregisterAutorun.push((0,a.mJ)((()=>({globalPlaybackMS:this.m_nGlobalTimelinePlaybackMS,bVideoPaused:this.m_gameRecordingVideo.IsPaused(),bHidePlayer:this.m_bHidePlayer})),(e=>{if(!this.m_timelineLoader?.BInitialized())return;if(e.bHidePlayer)return void this.SetEntriesForLiveEdge();(!this.m_previousHighlightEntry||!this.m_nextHighlightEntry||this.m_nextHighlightEntry?.globalMS&&e.globalPlaybackMS>=this.m_nextHighlightEntry.globalMS.valMS||this.m_previousHighlightEntry?.globalMS&&e.globalPlaybackMS<=this.m_previousHighlightEntry.globalMS.valMS||e.bVideoPaused&&this.m_previousHighlightEntry?.globalMS&&e.globalPlaybackMS>=this.m_previousHighlightEntry.globalMS.valMS+H)&&(this.CalculatePreviousHighlightEntry(e.globalPlaybackMS,e.bVideoPaused),this.CalculateNextHighlightEntry(e.globalPlaybackMS,e.bVideoPaused))}),{fireImmediately:!0})),this.m_fnUnregisterAutorun.push((0,a.mJ)((()=>this.m_gameRecordingVideo.BSeekReadyToPlay()),(e=>{if(e){const e=`seeking_${this.GetManifestFromRecordingID(this.m_strRecordingID)}_${this.m_gameRecordingVideo.GetPlaybackTime().toFixed(3)}`;try{const t=`measure_${this.m_strRecordingID}_${this.m_gameRecordingVideo.GetPlaybackTime().toFixed(3)}`,n=performance.measure(t,e);(0,s.q_)(`CGameRecordingVideo:: perf measure ${e} duration ${n.duration}`),n&&this.m_rgSeekPerf.push(n.duration)}catch(t){(0,s.q_)(`CGameRecordingVideo:: cant measure ${e}, error: ${t}`)}}}),{fireImmediately:!0})),this.SetLoader(e)}AddEventListener(e){return this.m_rgListeners.push(e),()=>_.x9(this.m_rgListeners,e)}FireEvent(e,...t){for(let n of this.m_rgListeners){let i=n[e];i instanceof Function&&i.apply(n,t)}}dispose(){this.m_fnUnregisterAutorun.forEach((e=>e())),this.m_fnUnregisterLoader&&(this.m_fnUnregisterLoader(),this.m_fnUnregisterLoader=null)}SetVideoElement(e){if(e){if(this.m_videoRef===e)return;if(this.m_videoRef=e,this.m_strRecordingID){const e=this.m_nPendingSeekSec>0?this.m_nPendingSeekSec:0;this.m_nPendingSeekSec=-1,this.ChangePlaybackRecording(this.m_strRecordingID,e)}else this.TryPlayInitialTimelineVideo()}else this.m_gameRecordingVideo.Stop(),this.m_videoRef=null}OnInvalidateRecording(e,t){const n=this.m_fnGetManifest(t);this.m_gameRecordingVideo.GetMPDURL()==n&&((0,s.q_)(`Recording invalidated for ${t}. Reloading MPD`),this.m_gameRecordingVideo.UpdateMPD())}OnLoaderInitialized(){this.m_durationMS=this.m_timelineLoader.GetGlobalTimelineEndMS(),this.m_lastRecordingGlobalMS=this.m_timelineLoader.GetEndOfRecordingsMS(),this.TryPlayInitialTimelineVideo();const e=(0,m.RV)(this.m_timelineLoader.GetGameID());this.SetClipOffsets(e)}OnInvalidate(e){if(this.m_durationMS=this.m_timelineLoader.GetGlobalTimelineEndMS(),this.m_lastRecordingGlobalMS=this.m_timelineLoader.GetEndOfRecordingsMS(),this.m_bHidePlayer&&this.m_timelineLoader.IsActiveTimeline(e))this.SetEntriesForLiveEdge();else{if(this.m_previousHighlightEntry&&this.m_nextHighlightEntry){const t=this.m_timelineLoader.GetTimelineMetadataIndex(e),n=this.m_timelineLoader.GetTimelineMetadataIndex(this.m_previousHighlightEntry.timelineID),i=this.m_timelineLoader.GetTimelineMetadataIndex(this.m_nextHighlightEntry.timelineID);if(t<n||t>i)return}this.CalculatePreviousHighlightEntry(this.m_nGlobalTimelinePlaybackMS,this.GetGameRecordingVideo().IsPaused()),this.CalculateNextHighlightEntry(this.m_nGlobalTimelinePlaybackMS,this.GetGameRecordingVideo().IsPaused())}}OnTimelineLoaded(e){this.m_previousHighlightEntry&&this.m_previousHighlightEntry.timelineID===e&&this.CalculatePreviousHighlightEntry(this.m_nGlobalTimelinePlaybackMS,this.GetGameRecordingVideo().IsPaused()),this.m_nextHighlightEntry&&this.m_nextHighlightEntry.timelineID===e&&this.CalculateNextHighlightEntry(this.m_nGlobalTimelinePlaybackMS,this.GetGameRecordingVideo().IsPaused())}SetEntriesForLiveEdge(){const e=this.GetLiveEdgeMS();this.CalculatePreviousHighlightEntry(e.valMS,!0),this.m_nextHighlightEntry=null}CalculatePreviousHighlightEntry(e,t){const n=t?1:H*this.m_gameRecordingVideo.GetPlaybackSpeed(),i=this.m_timelineLoader.GetClosestPreviousEntryInGlobalTimeline(e-n);"loaded"!==i.timelineState||i.entry?this.m_previousHighlightEntry=i:this.m_previousHighlightEntry=this.m_timelineLoader.GetClosestPreviousEntryInGlobalTimeline(e)}CalculateNextHighlightEntry(e,t){const n=this.m_timelineLoader.GetClosestNextEntryInGlobalTimeline(e);if("loaded"!==n.timelineState||n.entry)this.m_nextHighlightEntry=n;else{const n=t?1:H*this.m_gameRecordingVideo.GetPlaybackSpeed();this.m_nextHighlightEntry=this.m_timelineLoader.GetClosestNextEntryInGlobalTimeline(e-n)}}GetPreviousHighlightEntry(){return this.m_previousHighlightEntry}GetNextHighlightEntry(){return this.m_nextHighlightEntry}GetDisplayHighlightEntry(){return this.m_displayHighlightEntry}SetDisplayHighlightEntry(e,t){this.m_displayHighlightEntry={entry:e,duration:t}}GetRelativeTimeForDisplay(){return this.m_nRelativeTimeForDisplay}ClearRelativeTimeDisplay(){this.m_nRelativeTimeForDisplay=void 0}GetClipOffsets(){return this.m_rgClipOffsets}SetClipOffsets(e){if(!this.m_timelineLoader?.BInitialized())return;let t=[];e&&e.length&&e.forEach((e=>{const n=this.m_timelineLoader.GetGlobalOffsetDataForTimeline(e.start_timeline_id,0);if(!n)return;const i=n.nGlobalOffsetMS+parseInt(e.start_offset_ms);t.push({strClipID:e.clip_id,nGlobalOffsetMS:i,nDurationMS:parseInt(e.duration_ms)})})),this.m_rgClipOffsets=t}GetTotalMS(){return this.m_durationMS}GetIsActiveTimeline(e){return this.m_timelineLoader.IsActiveTimeline(e)}BIsVideoElementPaused(){return this.m_gameRecordingVideo.IsPaused()}BInitialized(){return this.m_timelineLoader.BInitialized()}GetHidePlayer(){return this.m_bHidePlayer}SetHidePlayer(e){e&&(this.m_strRecordingID=null),this.m_bHidePlayer=e}BPlayerInitialized(){return this.m_gameRecordingVideo.IsInitialized()}GetGameRecordingVideo(){return this.m_gameRecordingVideo}GetGameID(){return this.m_timelineLoader.GetGameID()}GetClipID(){return this.m_timelineLoader.GetClipID()}GetRecordingState(){return this.m_eRecordingState}SetRecordingState(e){this.m_eRecordingState=e}GetLoader(){return this.m_timelineLoader}SetLoader(e){this.m_timelineLoader!=e&&(this.m_fnUnregisterLoader&&this.m_fnUnregisterLoader(),this.m_timelineLoader=e,this.m_fnUnregisterLoader=this.m_timelineLoader.AddEventListener(this),e.BInitialized()&&this.OnLoaderInitialized())}SetGetManifest(e){this.m_fnGetManifest=e}GetRecordingID(){return this.m_strRecordingID}GetRecordingSetting(){return this.m_eRecordingSetting}SetRecordingSetting(e){this.m_eRecordingSetting=e}GetRecordingMode(){return this.m_eGameRecordingMode}ShouldModeShowClipControls(){switch(this.m_eGameRecordingMode){case w.Overlay:case w.Clips:case w.Background:return!0;default:return!1}}CanModeAddMarker(){switch(this.m_eGameRecordingMode){case w.Overlay:case w.Clips:case w.Background:return!0;default:return!1}}GetPlaybackStats(){if(!this.m_rgSeekPerf.length)return null;const e=this.m_rgSeekPerf.length,t=this.m_rgSeekPerf.reduce(((e,t)=>e+t))/e,n=Math.sqrt(this.m_rgSeekPerf.map((e=>Math.pow(e-t,2))).reduce(((e,t)=>e+t))/e),i=Math.max(...this.m_rgSeekPerf),r=Math.min(...this.m_rgSeekPerf);return{nMean:t,nStdDev:n,nMax:i,nMin:r,nLength:e,nLastVal:this.m_rgSeekPerf[e-1]}}StartPlaybackForRange(){let e=this.m_timelineLoader.GetGlobalOffsetDataForTimeline(this.m_playbackDefinition.m_strTimelineID,0),t=e?.nGlobalOffsetMS||0;t+=this.m_playbackDefinition.m_nTimelineStartMS;let n=this.m_timelineLoader.ConvertGlobaOffsetToRecordingAndRelativeOffset(t);if(n){if(this.m_playbackDefinition.m_nDurationMS){let e=t+this.m_playbackDefinition.m_nDurationMS,n=this.m_timelineLoader.ConvertGlobaOffsetToRecordingAndRelativeOffset(e);this.m_pendingStop={m_strRecordingID:n.strRecordingID,m_nOffsetMS:n.nRecordingOffsetMS}}this.UpdateGlobalPlayTime(t),this.ChangePlaybackRecording(n.strRecordingID,n.nRecordingOffsetMS/1e3)}}TryPlayInitialTimelineVideo(){if(this.m_timelineLoader.BInitialized()&&!this.m_bHidePlayer)if(this.m_playbackDefinition)this.StartPlaybackForRange();else if(this.m_eGameRecordingMode===w.Overlay){const e=this.GetLiveEdgeMS(),t=this.m_timelineLoader.GetFirstRecordingOfLastTimelineSession(),n=this.m_timelineLoader.ConvertRecordingOffsetToGlobalOffset(t,0,0);n&&e.valMS<n.nGlobalOffsetMS?(this.UpdateGlobalPlayTime(n.nGlobalOffsetMS),this.ChangePlaybackRecording(t,0)):isNaN(e.valMS)||this.SetPlaytimeFromGlobalMS(e,!1,!0)}else if(this.m_eGameRecordingMode===w.Background){const e=this.m_timelineLoader.GetFirstRecordingOfLastTimelineSession();this.SetPlaytimeFromRecordingOffset(e,0)}else{const e=this.m_timelineLoader.GetFirstRecording();this.SetPlaytimeFromRecordingOffset(e,0)}}GetTotalSeconds(){return Math.floor(this.m_timelineLoader.GetGlobalTimelineEndMS().valMS/1e3)}GetCurrentPlaybackGlobalMS(e=0){const t=Math.floor(1e3*this.m_gameRecordingVideo.GetPlaybackTime())+e;return this.m_timelineLoader.ConvertRecordingOffsetToGlobalOffset(this.m_strRecordingID,t,0)}GetIsLiveEdge(){const e=this.GetGlobalMSPlaytime().valMS||0;return"Overlay"===this.m_eGameRecordingMode?!!this.m_lastRecordingGlobalMS&&this.m_lastRecordingGlobalMS.valMS-e<N:this.GetTotalMS().valMS-e<1}GetLiveEdgeBufferWindowStartMS(){if("Overlay"===this.m_eGameRecordingMode&&this.m_lastRecordingGlobalMS){const e=Math.max(0,this.m_lastRecordingGlobalMS.valMS-N);return(0,h.Sb)(e)}return this.GetTotalMS()}GetLiveEdgeMS(){if("Overlay"===this.m_eGameRecordingMode&&this.m_lastRecordingGlobalMS){const e=Math.max(0,this.m_lastRecordingGlobalMS.valMS-x);return(0,h.Sb)(e)}return(0,h.Sb)(Math.max(0,this.GetTotalMS().valMS-1))}GetTimelineAndOffsetRelativeToCurrentPlayback(e=0){const t=this.GetCurrentPlaybackGlobalMS(e);return t||((0,s.ZI)(`failed to find offset for ${this.m_strRecordingID} at ${Math.floor(1e3*this.m_gameRecordingVideo.GetPlaybackTime())} MS`),null)}SeekDeltaMS(e){const t=this.GetGlobalMSPlaytime();if(!this.m_strRecordingID){const n=e>0?this.GetClosestNextRecordingForGlobalMS(t):this.GetClosestPreviousRecordingForGlobalMS(t);if(n){const t=e>0?e:Math.max(parseInt(n.duration_ms)+e,0);return void this.SetPlaytimeFromRecordingOffset(n.recording_id,t,e<0)}}const n="Overlay"===this.m_eGameRecordingMode?this.GetLiveEdgeMS().valMS:this.GetTotalMS().valMS,i=u.OQ(t.valMS+e,0,n-500);this.SetPlaytimeFromGlobalMS((0,h.Sb)(i))}ConvertGlobaOffsetToRecordingAndRelativeOffset(e){return this.m_timelineLoader.ConvertGlobaOffsetToRecordingAndRelativeOffset(e)}PlayNextTimelineRecording(e){if(this.m_playbackDefinition)return void this.StartPlaybackForRange();let t;if(this.m_strRecordingID)t=this.m_timelineLoader.GetNextRecording(this.m_strRecordingID);else{const e=this.m_timelineLoader.GetClosestNextRecordingInGlobalTimeline((0,h.Sb)(this.m_nGlobalTimelinePlaybackMS));t=e?.recording_id}t?this.SetPlaytimeFromRecordingOffset(t,0):(this.m_gameRecordingVideo.Pause(),e&&this.TryPlayInitialTimelineVideo())}GetClipsAtGlobalMS(e){return this.m_rgClipOffsets.filter((t=>t.nGlobalOffsetMS<=e.valMS&&t.nGlobalOffsetMS+t.nDurationMS>=e.valMS))||[]}GetClosestPreviousRecordingForGlobalMS(e){return this.m_timelineLoader.GetClosestPreviousRecordingInGlobalTimeline(e)}GetClosestNextRecordingForGlobalMS(e){return this.m_timelineLoader.GetClosestNextRecordingInGlobalTimeline(e)}SetPlaytimeFromRecordingOffset(e,t,n,i){let r=t;n&&(r=this.m_timelineLoader.ConvertRecordingTimeMStoPreTrimTimeMS(e,t));const o=this.m_timelineLoader.ConvertRecordingOffsetToGlobalOffset(e,r,0);o&&(this.UpdateGlobalPlayTime(o.nGlobalOffsetMS),this.ChangePlaybackRecording(e,r/1e3,i))}GetManifestFromRecordingID(e){return this.m_fnGetManifest(e)}ChangePlaybackRecording(e,t=0,n){this.m_bHidePlayer=!1;const i=this.m_gameRecordingVideo.IsPaused();if(this.m_strRecordingID===e&&this.m_gameRecordingVideo.IsInitialized())return void this.m_gameRecordingVideo.Seek(t);if(this.m_gameRecordingVideo.Stop(),this.m_strRecordingID=e,!e)return;if(!this.m_videoRef)return void(this.m_nPendingSeekSec=t);const r=this.GetManifestFromRecordingID(e),o=this.m_timelineLoader.BRecordingHasZeroOffset(e)?g.lU.Absolute:g.lU.FromAvailableStart;this.m_gameRecordingVideo.Start(this.m_videoRef,r,t,o),(n||i)&&this.m_gameRecordingVideo.Pause()}StopPlayback(){this.m_gameRecordingVideo.Stop()}TogglePlayPause(){this.m_gameRecordingVideo.IsPaused()||!this.m_gameRecordingVideo.IsInitialized()?(this.m_nGlobalTimelinePlaybackMS>this.m_lastRecordingGlobalMS.valMS&&this.TryPlayInitialTimelineVideo(),this.m_gameRecordingVideo.GetTimelineDuration()-this.m_gameRecordingVideo.GetPlaybackTime()<1?this.PlayNextTimelineRecording(!0):this.m_gameRecordingVideo.Play()):this.m_gameRecordingVideo.Pause()}GetGlobalMSPlaytime(){return(0,h.Sb)(this.m_nGlobalTimelinePlaybackMS)}GetGlobalPlaytimeSec(){return this.m_nGlobalTimelinePlaybackSec}UpdateGlobalPlayTime(e){this.m_nGlobalTimelinePlaybackMS=e,this.m_nGlobalTimelinePlaybackSec=Math.floor(e/1e3)}SetPlaytimeFromGlobalMS(e,t,n){this.m_pendingStop=null,this.UpdateGlobalPlayTime(e.valMS),n||(this.m_nRelativeTimeForDisplay=e.valMS);const i=this.m_timelineLoader.ConvertGlobaOffsetToRecordingAndRelativeOffset(e.valMS);this.ChangePlaybackRecording(i?.strRecordingID,i?.nRecordingOffsetMS/1e3,t)}ConvertGlobalOffsetToTimelineRelativeOffset(e){return this.m_timelineLoader.GetTimelineOffsetFromGlobal(e,0)}MakeRelativeToTimelineEndIfActive(e,t){return this.m_timelineLoader.MakeRelativeToTimelineEndIfActive(e,t)}GetTimelineDuration(e){if(!this.m_timelineLoader.BInitialized())return null;const t=this.m_timelineLoader.GetTimelineMetadata(e);return t?parseInt(t.metadata.duration_ms):null}GetTimelineFirstRecordingOffset(e){if(!this.m_timelineLoader.BInitialized())return null;const t=this.m_timelineLoader.GetTimelineMetadata(e);if(!t)return null;const n=t.metadata.recordings;return n.length?parseInt(n[0].start_offset_ms):null}async AddUserMarkerAtGlobalMS(e,t,n){const i=this.m_timelineLoader.GetTimelineOffsetFromGlobal(e.valMS,0);if(i){const e=this.m_timelineLoader.GetGameID(),{fnCreateUserTimelineMarkers:r}=(0,m.Fc)(),o=this.m_timelineLoader.GetTimelineStartBeforeGlobalZeroMS(i.strTimelineID);c.y.ReportTrackedAction(t);const l="steam_marker",a=await r(e,this.GetClipID(),{timeline_id:i.strTimelineID,entry_id:"",time:""+Math.floor(i.nTimelineOffsetMS.valMS+o),type:5,marker_icon:l,marker_priority:0});1==a.eResult&&(this.m_timelineLoader.AddUserMarker(i.strTimelineID,Math.floor(i.nTimelineOffsetMS.valMS),l,a.entry_id),n&&n(a.entry_id,i.strTimelineID))}}async RemoveUserMarker(e,t){const{fnRemoveUserTimelineMarker:n}=(0,m.Fc)(),i=this.m_timelineLoader.GetGameID();return 1==await n(i,this.GetClipID(),e,t)?(this.m_timelineLoader.RemoveUserMarker(e,t),!0):((0,s.tG)(`Failed to delete user marker for timeline ${e} entry ${t}`),!1)}async UpdateUserMarker(e,t,n,i){const{fnUpdateUserTimelineMarkers:r}=(0,m.Fc)(),o=this.m_timelineLoader.GetGameID(),l={timeline_id:e,entry_id:t.id,time:t.time,type:5,marker_icon:t.icon,marker_priority:t.priority,range_title:n,marker_description:i};if(1==await r(o,this.GetClipID(),l)){const r={strIcon:t.icon,name:n,description:i,nTimelineOffsetMS:parseInt(t.time)};return this.m_timelineLoader.UpdateUserMarker(e,t.id,r),!0}return!1}FocusGlobalMS(e){this.FireEvent("OnFocusGlobalMS",e)}SetPlaybackStop(e){const t=this.ConvertGlobaOffsetToRecordingAndRelativeOffset(e.valMS);t&&(this.m_pendingStop={m_strRecordingID:t.strRecordingID,m_nOffsetMS:t.nRecordingOffsetMS})}ClearPlaybackStop(){this.m_pendingStop=null}GenerateClipNameFromTimeline(e,t,n,i){return this.m_timelineLoader.GenerateClipNameFromTimeline(e,t,n,i)}GetRenderGlyph(){return this.m_bGamepadMode?this.m_fnRenderGlyph:void 0}SetRenderGlyph(e){this.m_fnRenderGlyph=e}GetGamepadMode(){return this.m_bGamepadMode}SetGamepadMode(e){this.m_bGamepadMode=e}GetControlsVisible(){return this.m_bControlsVisible}SetControlsVisible(e){null!=e&&(this.m_bControlsVisible=e)}}(0,o.Cg)([a.sH],F.prototype,"m_bHidePlayer",void 0),(0,o.Cg)([a.sH],F.prototype,"m_strRecordingID",void 0),(0,o.Cg)([a.sH],F.prototype,"m_durationMS",void 0),(0,o.Cg)([a.sH],F.prototype,"m_lastRecordingGlobalMS",void 0),(0,o.Cg)([a.sH],F.prototype,"m_nGlobalTimelinePlaybackMS",void 0),(0,o.Cg)([a.sH],F.prototype,"m_nGlobalTimelinePlaybackSec",void 0),(0,o.Cg)([a.sH],F.prototype,"m_rgSeekPerf",void 0),(0,o.Cg)([a.sH],F.prototype,"m_eRecordingState",void 0),(0,o.Cg)([a.sH],F.prototype,"m_eRecordingSetting",void 0),(0,o.Cg)([a.sH],F.prototype,"m_bGamepadMode",void 0),(0,o.Cg)([a.sH],F.prototype,"m_bControlsVisible",void 0),(0,o.Cg)([a.sH],F.prototype,"m_fnRenderGlyph",void 0),(0,o.Cg)([a.sH],F.prototype,"m_previousHighlightEntry",void 0),(0,o.Cg)([a.sH],F.prototype,"m_nextHighlightEntry",void 0),(0,o.Cg)([a.sH],F.prototype,"m_displayHighlightEntry",void 0),(0,o.Cg)([a.sH],F.prototype,"m_nRelativeTimeForDisplay",void 0),(0,o.Cg)([a.sH.ref],F.prototype,"m_rgClipOffsets",void 0),(0,o.Cg)([l.oI],F.prototype,"SetVideoElement",null),(0,o.Cg)([l.oI],F.prototype,"OnInvalidateRecording",null),(0,o.Cg)([a.XI],F.prototype,"OnLoaderInitialized",null),(0,o.Cg)([l.oI],F.prototype,"OnInvalidate",null),(0,o.Cg)([l.oI],F.prototype,"OnTimelineLoaded",null),(0,o.Cg)([l.oI],F.prototype,"GetLiveEdgeMS",null),(0,o.Cg)([l.oI],F.prototype,"StopPlayback",null),(0,o.Cg)([l.oI],F.prototype,"TogglePlayPause",null),(0,o.Cg)([a.XI],F.prototype,"UpdateGlobalPlayTime",null);const B=r.createContext({timelinePlaybackCoordinator:null});function W(e){const{children:t,mode:n,fnGetManifest:i,loader:o,recordingState:l,controlsVisible:a,gamepadMode:s,renderGlyph:c,markerStore:m,recordingSetting:d,playbackDefinition:u,clipSummaries:h}=e,[_]=r.useState((()=>new F(o,i,n,a,s,c,u,h)));(0,r.useEffect)((()=>{var e;e=m??V.CGameTimelineMarkerStore.Get(),L.Get().Init(e)}),[m]),(0,r.useEffect)((()=>{_.SetLoader(o)}),[_,o]),(0,r.useEffect)((()=>{_.SetRecordingState(l)}),[_,l]),(0,r.useEffect)((()=>{_.SetRecordingSetting(d)}),[_,d]),(0,r.useEffect)((()=>{_.SetGetManifest(i)}),[_,i]),(0,r.useEffect)((()=>{_.SetControlsVisible(a)}),[_,a]),(0,r.useEffect)((()=>{_.SetGamepadMode(s)}),[_,s]),(0,r.useEffect)((()=>{_.SetRenderGlyph(c)}),[_,c]),(0,r.useEffect)((()=>{_.SetClipOffsets(h)}),[_,h]),(0,r.useEffect)((()=>()=>_.dispose()),[_]);const g=r.useMemo((()=>({timelinePlaybackCoordinator:_})),[_]);return r.createElement(B.Provider,{value:g},t)}function q(){return(0,r.useContext)(B).timelinePlaybackCoordinator}var U=n(45130),z=n.n(U),$=n(84037),Z=n(24121),J=n(32037),Q=n(15489);class Y{k_QueueWaitUntilRequestMS=10;k_nMaxBatchSize=50;m_nMaxCacheSize=18e5/d.kh;m_LRUTrackerSet=new Set;m_mapPromises=new Map;m_mapThumbnailImages=new Map;m_rgPendingRequest=new Array;m_PendingInfoPromise;m_PendingInfoResolve=void 0;m_PendingTimer=void 0;k_AlreadyResolvedOK=Promise.resolve(!0);m_rgThumbnailPerf=[];constructor(){(0,a.Gn)(this)}AddPerfMeasure(e){this.m_rgThumbnailPerf.push(e)}GetPerfMeasures(){if(!this.m_rgThumbnailPerf.length)return null;const e=this.m_rgThumbnailPerf.length,t=this.m_rgThumbnailPerf.reduce(((e,t)=>e+t))/e,n=Math.sqrt(this.m_rgThumbnailPerf.map((e=>Math.pow(e-t,2))).reduce(((e,t)=>e+t))/e),i=Math.max(...this.m_rgThumbnailPerf),r=Math.min(...this.m_rgThumbnailPerf);return{nMean:t,nStdDev:n,nMax:i,nMin:r,nLength:e,nLastVal:this.m_rgThumbnailPerf[e-1]}}GetKey(e,t,n,i,r,o,l){const a=r+i;return`${e}_${t}_${n}_${l?a:a-a%d.kh}_${o}_${l}`}GetThumbnailData(e){const t=this.m_mapThumbnailImages.get(e);return t&&(this.m_LRUTrackerSet.has(e)&&this.m_LRUTrackerSet.delete(e),this.m_LRUTrackerSet.add(e)),t}SetThumbnailData(e,t){if(this.m_LRUTrackerSet.has(e)&&this.m_LRUTrackerSet.delete(e),this.m_LRUTrackerSet.add(e),this.m_mapThumbnailImages.set(e,t),this.m_LRUTrackerSet.size>=this.m_nMaxCacheSize){const e=this.m_LRUTrackerSet.keys().next().value;this.m_LRUTrackerSet.delete(e),this.m_mapThumbnailImages.delete(e)}}ClearThumbnailData(){this.m_LRUTrackerSet.clear(),this.m_mapThumbnailImages.clear()}GetThumbnail(e,t,n,i,r,o,l){if(!t)return;const a=this.GetKey(e,t,n,i,r,o,l);return this.GetThumbnailData(a)}GetOrQueueThumbnail(e,t,n,i,r,o,l){if(!t)return;const a=this.GetKey(e,t,n,i,r,o,l);let c=this.GetThumbnailData(a);if(!c){let m=`thumbnail_${e}_${o}_${l}`;performance.mark(m),this.QueueThumbnailRequest(e,t,n,i,r,o,l).then((()=>{try{const e=performance.measure(`measure_${m}`,m);e&&Y.Get().AddPerfMeasure(e.duration)}catch(e){(0,s.q_)(`CThumbnailCache:: cant measure ${m}, error: ${e}`)}})),c=this.GetThumbnailData(a)}return c}QueueThumbnailRequest(e,t,n,i,r,o,l){const a=this.GetKey(e,t,n,i,r,o,l),s=this.GetThumbnailData(a);if(s&&(s.data||s.bIsLoading))return this.k_AlreadyResolvedOK;this.SetThumbnailData(a,{data:null,bIsLoading:!0}),this.m_PendingInfoPromise&&(this.m_rgPendingRequest[0].strRecordingID!=t||this.m_rgPendingRequest.length>this.k_nMaxBatchSize)&&(this.m_PendingTimer&&window.clearTimeout(this.m_PendingTimer),this.FlushPendingInfo()),this.m_PendingInfoPromise&&this.m_rgPendingRequest[0].strRecordingID==t||(this.m_PendingInfoPromise=new Promise((e=>this.m_PendingInfoResolve=e)),this.m_PendingTimer=window.setTimeout((()=>this.FlushPendingInfo()),this.k_QueueWaitUntilRequestMS));const c={gameID:e,strRecordingID:t,strClipID:n,nRecordingOffsetMS:i,nRecordingStartOffsetMS:r,cPxMajorAxis:o,bPreciseTiming:l};return this.m_rgPendingRequest.some((e=>{return n=c,(t=e).strRecordingID===n.strRecordingID&&t.strClipID===n.strClipID&&t.nRecordingOffsetMS===n.nRecordingOffsetMS&&t.nRecordingStartOffsetMS===n.nRecordingStartOffsetMS&&t.cPxMajorAxis===n.cPxMajorAxis&&t.bPreciseTiming==n.bPreciseTiming;var t,n}))||(this.m_rgPendingRequest.push(c),this.m_mapPromises.set(a,this.m_PendingInfoPromise)),this.m_PendingInfoPromise}async FlushPendingInfo(){if(void 0===this.m_PendingInfoResolve)return;const e=this.m_PendingInfoResolve,t=this.m_rgPendingRequest;this.m_PendingInfoPromise=void 0,this.m_PendingInfoResolve=void 0,this.m_rgPendingRequest=[],this.m_PendingTimer=void 0,await this.InternalLoadMultipleThumbnails(t),e()}async InternalLoadMultipleThumbnails(e){e.sort(((e,t)=>e.nRecordingOffsetMS-t.nRecordingOffsetMS));try{const t=e.map((e=>1e3*e.nRecordingOffsetMS)),n=await(0,m.c5)(e[0].strRecordingID,e[0].strClipID,void 0,t,e[0].cPxMajorAxis,e[0].bPreciseTiming);(0,J.w)(n?.length==t.length,`CThumbnailCache.InternalLoadMultipleThumbnails request ${t.length} and got back ${n?.length}`);for(let i=0;i<t.length&&i<n?.length;++i){const t=e[i],r=this.GetKey(t.gameID,t.strRecordingID,t.strClipID,t.nRecordingOffsetMS,t.nRecordingStartOffsetMS,t.cPxMajorAxis,t.bPreciseTiming);let o=n?n[i].image_data():null;this.SetThumbnailData(r,{data:o,bIsLoading:!1})}}catch(t){(0,s.ZI)("Failed to load multiple request thumbnails",t);for(let t=0;t<e.length;++t){const n=e[t],i=this.GetKey(n.gameID,n.strRecordingID,n.strClipID,n.nRecordingOffsetMS,n.nRecordingStartOffsetMS,n.cPxMajorAxis,e[0].bPreciseTiming);this.SetThumbnailData(i,{data:null,bIsLoading:!1})}}}async LoadThumbnail(e,t,n,i,r,o,l){const a=this.GetKey(e,t,n,i,r,o,l),s=this.GetThumbnailData(a);return!(!s||!s.data)||(this.m_mapPromises.has(a)||this.m_mapPromises.set(a,this.InternalLoadThumbnail(e,t,n,i,r,o,l)),this.m_mapPromises.get(a))}async InternalLoadThumbnail(e,t,n,i,r,o,l){const a=this.GetKey(e,t,n,i,r,o,l);try{const e=await(0,m.c5)(t,n,void 0,[1e3*i],o,l);if(e?.length>0){let t=e?e[0].image_data():null;return this.SetThumbnailData(a,{data:t,bIsLoading:!1}),!0}(0,s.tH)(`ThumbnailImage: got empty jpeg ${e.length} list back ${t} @ ${i}`)}catch(e){(0,s.ZI)(`ThumbnailImage: Fail to load thumbnail ${t} @ ${i} with ${e}`),this.SetThumbnailData(a,{data:null,bIsLoading:!1})}return!1}static s_Singleton;static Get(){return Y.s_Singleton||(Y.s_Singleton=new Y,"dev"==Q.TS.WEB_UNIVERSE&&(window.g_ThumbnailCache=Y.s_Singleton)),Y.s_Singleton}}function K(e,t,n,i,o,a,s){const c=(0,M.q3)((()=>Y.Get().GetOrQueueThumbnail(e,n,t,i,o,a,s)));return function(e){const t=(0,r.useRef)(null),n=(0,l.CH)(),i=(0,Z.m)("useThumbnailAsURL");return(0,r.useEffect)((()=>{if(e&&!i?.token?.reason){const i=new Blob([e],{type:"image/jpeg"}),r=URL.createObjectURL(i);t.current=r,n()}return()=>{t.current&&(URL.revokeObjectURL(t.current),t.current=void 0)}}),[i?.token?.reason,e,n]),t.current}(c?.data)}(0,o.Cg)([a.sH],Y.prototype,"m_mapThumbnailImages",void 0);var j=n(44670);const ee={nBeforeMS:0,nAfterMS:12e3},te=r.createContext({globalStartMS:void 0,globalEndMS:void 0,setRange:null,setStartMS:null,setEndMS:null,globalPreviewStartMS:void 0,globalPreviewEndMS:void 0,setPreviewRange:null,clearPreviewSelection:null,selectionZoomCount:0,eInitMethod:void 0,startMetrics:void 0,endMetrics:void 0,zoomIntoSelection:null,zoomOutSelection:null});function ne(){const e=(0,r.useContext)(te);return{nGlobalStartMS:e.globalStartMS,nGlobalEndMS:e.globalEndMS}}function ie(){return(0,r.useContext)(te).globalStartMS}function re(){return(0,r.useContext)(te).globalEndMS}function oe(){return(0,r.useContext)(te).setRange}function le(){return(0,r.useContext)(te).setStartMS}function ae(){return(0,r.useContext)(te).setEndMS}function se(){const e=(0,r.useContext)(te);return{selectedMarker:e.selectedMarker,setSelectedMarker:e.setSelectedMarker}}function ce(){const e=(0,r.useContext)(te);return!isNaN(e.globalStartMS?.valMS)&&!isNaN(e.globalEndMS?.valMS)}function me(){return(0,r.useContext)(te).clearSelection}function de(){const e=oe(),t=le(),n=ae(),i=ne(),o=(0,r.useContext)(te).selectionZoomCount,l=(0,r.useContext)(te).zoomIntoSelection;return r.useCallback(((r,o,l,a)=>{if(void 0===l&&void 0===a)return;void 0!==i.nGlobalStartMS||i.nGlobalEndMS;let s=l||i.nGlobalStartMS,c=a||i.nGlobalEndMS;s&&c&&c.valMS<=s.valMS&&(void 0!==l?c=void 0:s=void 0);const m=ee.nBeforeMS+ee.nAfterMS;void 0===s&&(s=(0,h.Sb)(c.valMS-m)),void 0===c&&(c=(0,h.Sb)(s.valMS+m));const d=s!=i.nGlobalStartMS,u=c!=i.nGlobalEndMS;d&&u?e(o,s,c):d?t(o,s):u&&n(o,c)}),[i,e,t,n,o,l])}var ue=n(6984),he=n(4746);var _e;!function(e){e.Playhead="Playhead",e.RangeLeft="RangeLeft",e.RangeRight="RangeRight",e.Highlight="Highlight"}(_e||(_e={}));class ge{m_loader;m_playbackCoordinator;m_fnUnregisterFromLoader;m_fnUnregisterPlaybackCoordinator;m_refTimelineParentCtn;m_durationMS=0;m_mapTimelineClips=a.sH.map([],{deep:!1});m_scrollLeftPX=0;m_scrollWindowWidth=null;m_scrollWindowOffsetPX=null;m_bAutoScrollPaused=!1;m_autoScrollPauseTimeout=null;m_msVisible=0;m_bCustomZoom=!1;m_bUserClipping=!1;m_prevLeftAndVisible=null;m_rgTimelineOffsets=[];m_mapTimelineEntries=a.sH.map([],{deep:!1});m_bInitialized=!1;m_eThumbnailComponent=null;m_nGlobalRelativeThumbnailPositionPX=void 0;m_thumbnailHighlightEntry=void 0;constructor(e,t,n){(0,a.Gn)(this),this.m_loader=e,this.m_playbackCoordinator=t,this.m_fnUnregisterFromLoader=this.m_loader.AddEventListener(this),this.m_fnUnregisterPlaybackCoordinator=t.AddEventListener(this),this.UpdateClipSummaries(n),e.BInitialized()&&this.OnLoaderInitialized()}BInitialized(){return this.m_bInitialized}OnLoaderInitialized(){this.m_durationMS=this.m_loader.GetGlobalTimelineEndMS().valMS,this.OnInvalidate(),this.InitDefaultsIfReady()}InitDefaultsIfReady(){!this.m_bInitialized&&this.m_scrollWindowWidth&&this.m_loader.BInitialized()&&(this.m_bInitialized=!0,this.m_msVisible=this.ComputeDefaultMSVisible(),this.ScrollToCenteredGlobalMS(this.m_playbackCoordinator.GetGlobalMSPlaytime().valMS))}OnTimelineLoaded(e){(0,s.q_)("OnTimelineLoaded",e);this.FindTimelineOffsets(e)?this.ComputeEntriesForTimeline(e):(0,s.tG)("Missing timeline offset metadata for",e)}OnInvalidate(e){(0,s.q_)("on invalidate ",e);const t=this.m_loader.GetGlobalTimelineEndMS().valMS,n=t-this.m_durationMS,i=this.m_durationMS<=0;let r;this.m_durationMS=t;let o=this.IsTempZoom()||this.m_bCustomZoom||this.m_bUserClipping;if(n>0&&i)this.m_msVisible=this.ComputeDefaultMSVisible();else if(n>0&&!this.m_bAutoScrollPaused&&!o)this.m_msVisible=this.ComputeDefaultMSVisible();else if(n<0&&this.m_msVisible>t)this.m_msVisible=this.ComputeDefaultMSVisible(),this.ScrollToOffset(0);else if(n<0){const e=this.FindClosestTimelineStartForOffsetPX(this.m_scrollLeftPX);if(e){const t=this.ConvertGlobalMSToGlobalPXOffset(e.globalOffsetMS),n=this.ConvertDeltaPXToDurationMS(this.m_scrollLeftPX-t);r={strTimelineID:e.timelineID,nTimelineOffsetMS:n}}}const l=this.m_loader.GetTimelines();let a=0;if(this.BInitialized()&&e){const t=l.findIndex((t=>t.metadata.timeline_id===e));t>=0&&(a=t)}if(this.m_rgTimelineOffsets=l.map(((e,t)=>t>=a?this.ComputeTimelineOffset(e):this.m_rgTimelineOffsets[t])),r){const e=this.FindTimelineOffsets(r.strTimelineID);if(e){const t=e.globalOffsetMS+r.nTimelineOffsetMS,n=(0,u.OQ)(this.ConvertGlobalMSToGlobalPXOffset(t),0,this.GetMaxScrollLeftPX());this.ScrollToOffset(n)}}l.forEach(((e,t)=>{t>=a&&this.ComputeEntriesForTimeline(e.metadata.timeline_id)}))}OnFocusGlobalMS(e){this.ScrollToCenteredGlobalMS(e.valMS)}GetGameID(){return this.m_loader.GetGameID()}SetTimelineParentCtnRef(e){this.m_refTimelineParentCtn=e}GetTimelineParentCtnRef(){return this.m_refTimelineParentCtn}SetThumbnailComponent(e){this.m_eThumbnailComponent=e,e||(this.m_nGlobalRelativeThumbnailPositionPX=void 0),e!==_e.Highlight&&(this.m_thumbnailHighlightEntry=null)}GetThumbnailComponent(){return this.m_eThumbnailComponent}SetThumbnailPosition(e){this.m_nGlobalRelativeThumbnailPositionPX=e}GetThumbnailPosition(){return this.m_nGlobalRelativeThumbnailPositionPX}SetThumbnailEntry(e){this.m_thumbnailHighlightEntry=e}GetThumbnailEntry(){return this.m_eThumbnailComponent===_e.Highlight?this.m_thumbnailHighlightEntry:null}Close(){this.m_fnUnregisterFromLoader&&this.m_fnUnregisterFromLoader(),this.m_fnUnregisterPlaybackCoordinator&&this.m_fnUnregisterPlaybackCoordinator(),this.m_fnUnregisterFromLoader=null,this.m_fnUnregisterPlaybackCoordinator=null,this.m_loader=null,this.m_bInitialized=!1,this.m_autoScrollPauseTimeout&&this.ClearAutoScrollPauseTimeout()}ComputeDefaultMSVisible(){const e=2*this.GetTimelineMarginWidth(),t=10*(this.m_rgTimelineOffsets.length-1),n=Math.max(1,this.m_scrollWindowWidth-t-e),i=Math.ceil((e+t)*this.m_durationMS/(this.m_scrollWindowWidth-(e+t))),r=1e3*n;return Math.min(this.m_durationMS+i,r)}ZoomIn(e,t){if(this.m_msVisible<=1e3)return;const n=this.m_msVisible-this.m_msVisible/1.1**e,i=n*t,r=this.ConvertPXOffsetToGlobalMS(this.m_scrollLeftPX),o=Math.max(this.m_msVisible-n,1e3);this.m_msVisible=o,this.m_bCustomZoom=!0,this.ScrollToOffset(this.ConvertGlobalMSToGlobalPXOffset(r+i))}ZoomOut(e,t){const n=this.m_durationMS+this.ConvertDeltaPXToDurationMS(10*(this.m_rgTimelineOffsets.length-1)+2*this.GetTimelineMarginWidth());if(this.m_msVisible>=n)return;const i=this.m_msVisible*1.1**e-this.m_msVisible,r=i*t,o=this.ConvertPXOffsetToGlobalMS(this.m_scrollLeftPX),l=Math.min(this.m_msVisible+i,n);this.m_msVisible=l,this.m_bCustomZoom=!0,this.ScrollToOffset(this.ConvertGlobalMSToGlobalPXOffset(o-r))}IsTempZoom(){return!!this.m_prevLeftAndVisible}SetTempZoomScale(e,t){let n=Math.max(e,0),i=Math.min(t,this.m_durationMS);this.m_prevLeftAndVisible=[this.m_scrollLeftPX,this.m_msVisible],this.m_msVisible=i-n;const r=this.ConvertGlobalMSToGlobalPXOffset(n);this.ScrollToOffset(r)}ClearTempZoomScale(){if(!this.m_prevLeftAndVisible)return;const[e,t]=this.m_prevLeftAndVisible;this.m_prevLeftAndVisible=null,this.ScrollToOffset(e),this.m_msVisible=t}SetUserIsClipping(e){this.m_bUserClipping=e}GetTimelineGapWidth(){return 10}GetTimelineMarginWidth(){return 12}UpdateClipSummaries(e=[]){this.m_mapTimelineClips.clear(),e.forEach((e=>{const t=e.start_timeline_id;this.m_mapTimelineClips.has(t)||this.m_mapTimelineClips.set(t,[]);const n={clipID:e.clip_id,msDuration:parseInt(e.duration_ms),msTimelineOffset:parseInt(e.start_offset_ms),timelineID:t};this.m_mapTimelineClips.get(t).push(n)}))}GetNumTimelines(){return this.m_loader.GetTimelines().length}ComputeTimelineOffset(e){const t=isNaN(parseInt(e.metadata.duration_ms))?0:parseInt(e.metadata.duration_ms),n=e.metadata.recordings.map((e=>{const n=parseInt(e.start_offset_ms);let i=parseInt(e.duration_ms);return isNaN(i)&&this.m_loader.IsActiveRecording(e.recording_id)&&(i=t-n),{recordingID:e.recording_id,timelineOffsetMS:n,nDurationMS:i,bIsActive:this.m_loader.IsActiveRecording(e.recording_id),recordingType:e.recording_type}}));return{timelineID:e.metadata.timeline_id,globalOffsetMS:e.nGlobalOffsetMS.valMS,nDurationMS:t,recordingOffsets:n}}GetCurrentZoomScale(){return this.m_msVisible/(this.m_scrollWindowWidth||1)||1}GetClipsForTimeline(e){return this.m_mapTimelineClips.get(e)||[]}ComputeEntriesForTimeline(e){const t=this.m_loader.GetTimelineDataOrStartLoad(e);t&&"loaded"==t.m_strState&&this.m_mapTimelineEntries.set(e,{rgGameModes:t.m_rgGameModeChanges,rgHighlights:t.m_rgEntries})}GetVisibleTimelineGameModes(e){return this.m_mapTimelineEntries.get(e)?.rgGameModes}GetVisibleTimelineHighlights(e){return this.m_mapTimelineEntries.get(e)?.rgHighlights}GetStateDescriptionAtGlobalMS(e){return this.m_loader.GetStateDescriptionAtGlobalMS((0,h.Sb)(e))}GetTimelineOffsetMS(e){return this.m_loader.GetTimelineStartBeforeGlobalZeroMS(e)}FetchTimelineEntries(e,t){return this.FetchTimelineEntriesWorker(e,t,this.m_loader.GetIteratorEntriesWithin)}FetchTimelineEntriesWorker(e,t,n){const i=this.ConvertPXOffsetToGlobalMS(this.GetVirtualWindowEndPX());let r=this.m_loader.CreateTimelineIterator(t,0);if(this.m_loader.HasIteratorReachedEnd(r))return{strState:"error",rgEntry:[]};let o=[];const l=this.m_loader.GetIteratorTimelineState(r);if("loaded"==l)for(let l of n(r,i-t))if(e.includes(l.type)){const e={...l,time:l.time-r.m_nTimelineOffsetMS};o.push(e)}return{strState:l,rgEntry:o}}ScrollToCenteredGlobalMS(e){const t=this.ConvertGlobalMSToGlobalPXOffset(e);this.ScrollToOffsetCentered(t)}ScrollToOffset(e){this.m_scrollLeftPX=(0,u.OQ)(e,0,this.GetMaxScrollLeftPX())}ScrollToOffsetCentered(e){const t=Math.max(0,e-.5*this.m_scrollWindowWidth);this.ScrollToOffset(t)}ScrollBy(e){const t=this.m_scrollLeftPX+e;this.ScrollToOffset(t)}GetAutoScrollPaused(){return this.m_bAutoScrollPaused}SetAutoScrollPaused(e){this.ClearAutoScrollPauseTimeout(),this.m_bAutoScrollPaused=e}GetAutoScrollPauseTimeout(){return this.m_autoScrollPauseTimeout}ClearAutoScrollPauseTimeout(){this.m_autoScrollPauseTimeout&&clearTimeout(this.m_autoScrollPauseTimeout),this.m_autoScrollPauseTimeout=null}SetAutoScrollPauseTimeout(e=5e3){this.ClearAutoScrollPauseTimeout(),this.m_autoScrollPauseTimeout=window.setTimeout((()=>{this.SetAutoScrollPaused(!1)}),e)}ScrollToEnd(){this.ScrollToOffset(this.GetMaxScrollLeftPX())}SetScrollWindowWidth(e){this.m_scrollWindowWidth=e,this.m_loader.BInitialized()&&(this.ScrollToOffset(this.m_scrollLeftPX),this.InitDefaultsIfReady())}SetScrollWindowOffset(e){this.m_scrollWindowOffsetPX=e}GetScrollWindowOffset(){return this.m_scrollWindowOffsetPX}GetScrollableWidthPX(){if(!this.m_rgTimelineOffsets?.length)return 0;const e=this.m_rgTimelineOffsets.length-1,t=this.m_rgTimelineOffsets[e];return 10*e+this.ConvertDurationMSToDeltaPX(t.globalOffsetMS+t.nDurationMS)}GetOverscanWidth(){return 10*this.GetScrollWindowWidth()/100}GetScrollWindowWidth(){return this.m_scrollWindowWidth}GetMaxScrollLeftPX(){return Math.max(0,this.GetScrollableWidthPX()-this.GetScrollWindowWidth()+2*this.GetTimelineMarginWidth())}BReachedMaxScroll(){return Math.ceil(this.m_scrollLeftPX)===Math.ceil(this.GetMaxScrollLeftPX())}BReachedMinScroll(){return 0===this.m_scrollLeftPX}GetVisualWindowStartPX(){return this.m_scrollLeftPX}GetVisualWidth(){return Math.min(this.m_scrollWindowWidth,this.GetScrollableWidthPX()+2*this.GetTimelineMarginWidth())}GetVirtualWindowStartPX(){return Math.max(this.m_scrollLeftPX-this.GetOverscanWidth(),0)}GetVirtualWindowWidthPX(){const e=(0,u.OQ)(this.m_scrollLeftPX,0,this.GetOverscanWidth()),t=Math.min(this.GetScrollableWidthPX()-(this.m_scrollLeftPX+this.m_scrollWindowWidth),this.GetOverscanWidth());return e+this.m_scrollWindowWidth+t}GetVirtualWindowEndPX(){return this.GetVirtualWindowStartPX()+this.GetVirtualWindowWidthPX()}GetVisibleTimelines(){const e=this.FindIndexOfClosestTimelineEndForOffsetPX(this.GetVirtualWindowStartPX())+1,t=this.FindIndexOfClosestTimelineStartForOffsetPX(this.GetVirtualWindowEndPX());return this.m_rgTimelineOffsets.slice(e,t+1).map((e=>{const t=Math.max(e.globalOffsetMS,this.ConvertPXOffsetToGlobalMS(this.GetVirtualWindowStartPX())),n=Math.min(e.nDurationMS-(t-e.globalOffsetMS),this.ConvertDeltaPXToDurationMS(this.GetVirtualWindowWidthPX())),i=this.ConvertGlobalMSToGlobalPXOffset(t),r=this.ConvertDurationMSToDeltaPX(n),o=this.ConvertGlobalMSToGlobalPXOffset(e.globalOffsetMS),l=this.ConvertDurationMSToDeltaPX(e.nDurationMS);return{...e,pxStart:o,pxDuration:l,msVisibleStart:t,msVisibleDuration:n,pxVisibleStart:i,pxVisibleDuration:r}}))}GetVisibleRecordings(){const e=[];return this.GetVisibleTimelines().forEach((t=>{t.recordingOffsets.forEach((n=>{const i=t.pxStart+this.GetPXForDuration(n.timelineOffsetMS),r=i+this.GetPXForDuration(n.nDurationMS);r<this.GetVirtualWindowStartPX()||i>this.GetVirtualWindowEndPX()||e.push({recordingID:n.recordingID,nStartPX:i,nEndPX:r,bIsActive:n.bIsActive,recordingType:n.recordingType})}))})),e}GetVisibleClips(){const e=[];return this.GetVisibleTimelines().forEach((t=>{const n=this.ConvertGlobalMSToGlobalPXOffset(t.globalOffsetMS);this.GetClipsForTimeline(t.timelineID).forEach((i=>{const r=n+this.GetPXForDuration(i.msTimelineOffset),o=this.ConvertGlobalMSToGlobalPXOffset(t.globalOffsetMS+i.msTimelineOffset+i.msDuration);o<this.GetVirtualWindowStartPX()||r>this.GetVirtualWindowEndPX()||e.push({clipID:i.clipID,pxClipStart:r,pxClipEnd:o})}))})),e}GetPXForDuration(e){return e/this.GetCurrentZoomScale()}GetVisibleTimelinesInWindow(){const e=this.FindIndexOfClosestTimelineEndForOffsetPX(this.m_scrollLeftPX)+1,t=this.FindIndexOfClosestTimelineStartForOffsetPX(this.m_scrollLeftPX+this.m_scrollWindowWidth);return this.m_rgTimelineOffsets.slice(e,t+1)}GetVisibleWindowRelativeTimelines(){return this.GetVisibleTimelinesInWindow().map((e=>{const t=this.m_scrollLeftPX,n=this.GetVirtualWindowEndPX()-this.GetOverscanWidth(),i=this.ConvertGlobalMSToGlobalPXOffset(e.globalOffsetMS),r=i+this.ConvertDurationMSToDeltaPX(e.nDurationMS),o=Math.max(i,t),l=Math.min(r,n);return{timelineID:e.timelineID,nVisibleStartPX:o,nEndPX:l,nTimelineStartMS:this.ConvertPXToTimelineRelativeMS(t),nGlobalStartMS:this.ConvertPXOffsetToGlobalMS(t)}}))}ConvertPXToTimelineRelativeMS(e,t="start"){const n=this.ConvertPXOffsetToGlobalMS(e);let i=this.m_loader.GetTimelineOffsetFromGlobal(n,0);return"end-if-active"==t&&i.strTimelineID&&this.m_loader.IsActiveTimeline(i.strTimelineID)?this.m_loader.MakeRelativeToTimelineEndIfActive(i.strTimelineID,i.nTimelineOffsetMS.valMS):i.nTimelineOffsetMS.valMS}GetTimeRecorded(e){const t=this.m_loader.GetTimelineMetadata(e);return t?t.metadata.date_recorded:null}ConvertGlobalMSToClipOrNone(e){const t=this.m_loader.GetTimelineOffsetFromGlobal(e,0);if(!t)return null;const{nTimelineOffsetMS:n,strTimelineID:i}=t;if(!i)return null;if(this.m_mapTimelineClips.has(i)){return this.m_mapTimelineClips.get(i).find((e=>e.msTimelineOffset<=n.valMS&&e.msTimelineOffset+e.msDuration>=n.valMS))}return null}ConvertGlobalMSToScrollWindowPXOffset(e){return this.ConvertGlobalMSToGlobalPXOffset(e)-this.m_scrollLeftPX}ConvertGlobalMSToGlobalPXOffset(e,t=-1){t<0&&(t=_.rJ(this.m_rgTimelineOffsets,(t=>e-t.globalOffsetMS)));const n=10*t;return this.ConvertDurationMSToDeltaPX(e)+n}ConvertPXOffsetToGlobalMS(e,t=!0){if(this.BPositionInGap(e)){if(!t)return null;const n=this.FindClosestTimelineEndForOffsetPX(e);return n?n.globalOffsetMS+n.nDurationMS:0}const n=this.FindClosestTimelineStartForOffsetPX(e);if(!n)return null;const i=this.ConvertGlobalMSToGlobalPXOffset(n.globalOffsetMS),r=this.ConvertDeltaPXToDurationMS(e-i);return n.globalOffsetMS+r}FindClosestTimelineEndForOffsetPX(e){const t=this.FindIndexOfClosestTimelineEndForOffsetPX(e);if(t<0)return null;return this.m_rgTimelineOffsets[t]}FindClosestTimelineStartForOffsetPX(e){const t=this.FindIndexOfClosestTimelineStartForOffsetPX(e);if(t<0)return null;return this.m_rgTimelineOffsets[t]}FindIndexOfClosestTimelineEndForOffsetPX(e){return _.rJ(this.m_rgTimelineOffsets,(t=>{const n=this.ConvertGlobalMSToGlobalPXOffset(t.globalOffsetMS)+this.ConvertDurationMSToDeltaPX(t.nDurationMS);return e-n}))}FindIndexOfClosestTimelineStartForOffsetPX(e){return _.rJ(this.m_rgTimelineOffsets,(t=>{const n=this.ConvertGlobalMSToGlobalPXOffset(t.globalOffsetMS);return e-n}))}FindTimelineOffsets(e){return this.m_rgTimelineOffsets.find((t=>t.timelineID===e))}BPositionInGap(e){const t=this.FindIndexOfClosestTimelineEndForOffsetPX(e);if(t<0)return!1;const n=t+1;if(n>=this.m_rgTimelineOffsets.length)return!1;const i=this.m_rgTimelineOffsets[t],r=this.m_rgTimelineOffsets[n],o=this.ConvertGlobalMSToGlobalPXOffset(i.globalOffsetMS);return e<this.ConvertGlobalMSToGlobalPXOffset(r.globalOffsetMS)&&e!==o}ConvertDurationMSToDeltaPX(e){return e/this.GetCurrentZoomScale()}ConvertDeltaPXToDurationMS(e){return e*this.GetCurrentZoomScale()}}(0,o.Cg)([a.sH],ge.prototype,"m_durationMS",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_scrollLeftPX",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_scrollWindowWidth",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_scrollWindowOffsetPX",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_bAutoScrollPaused",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_autoScrollPauseTimeout",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_msVisible",void 0),(0,o.Cg)([a.sH.ref],ge.prototype,"m_rgTimelineOffsets",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_bInitialized",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_eThumbnailComponent",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_nGlobalRelativeThumbnailPositionPX",void 0),(0,o.Cg)([a.sH],ge.prototype,"m_thumbnailHighlightEntry",void 0),(0,o.Cg)([a.XI],ge.prototype,"OnLoaderInitialized",null),(0,o.Cg)([a.XI],ge.prototype,"InitDefaultsIfReady",null),(0,o.Cg)([a.XI],ge.prototype,"OnInvalidate",null),(0,o.Cg)([a.XI],ge.prototype,"ZoomIn",null),(0,o.Cg)([a.XI],ge.prototype,"ZoomOut",null),(0,o.Cg)([a.XI],ge.prototype,"SetTempZoomScale",null),(0,o.Cg)([a.XI],ge.prototype,"ClearTempZoomScale",null),(0,o.Cg)([a.XI],ge.prototype,"UpdateClipSummaries",null),(0,o.Cg)([l.oI],ge.prototype,"BReachedMaxScroll",null),(0,o.Cg)([l.oI],ge.prototype,"BReachedMinScroll",null);const fe=r.createContext(null);function Se(e){let{loader:t,playbackCoordinator:n,children:i,clipSummaries:o,refTimelineParentCtn:l}=e,[a,s]=(0,r.useState)(null);return(0,r.useEffect)((()=>{if(!t)return;let e=new ge(t,n,o);return s(e),()=>e.Close()}),[t]),(0,r.useEffect)((()=>{a&&a.UpdateClipSummaries(o)}),[a,o]),(0,r.useEffect)((()=>{a&&l&&a.SetTimelineParentCtnRef(l.current)}),[a,l]),function(e){let t=ce();(0,r.useEffect)((()=>{e&&e.SetUserIsClipping(t)}),[e,t])}(a),function(e){let t=r.useCallback(((t,n)=>{if(!e)return;if(!t||!n)return void e.ClearTempZoomScale();let i=Math.floor(.1*(n.valMS-t.valMS));n.valMS,t.valMS;let r=t.valMS-i,o=n.valMS+i;e.SetTempZoomScale(r,o)}),[e]);!function(e){let t=(0,r.useContext)(te),n=t.selectionZoomCount,i=t.globalStartMS,o=t.globalEndMS,l=(0,r.useRef)(n),a=(0,r.useRef)(null);a.current=e,(0,r.useEffect)((()=>{if(!a.current)return;let e=!isNaN(i?.valMS)&&!isNaN(o?.valMS);l.current==n&&e||(l.current=n,e&&n?a.current(i,o):a.current(null,null))}),[n,i,o,l,a])}(t)}(a),a?r.createElement(fe.Provider,{value:a},i):null}function pe(){return(0,r.useContext)(fe)}var be=n(9176);const Ce=(0,r.createContext)({});function ve(){return(0,r.useContext)(Ce)}function ye(){const e=pe(),t=q(),n=de(),i=(0,M.q3)((()=>!t.ShouldModeShowClipControls())),o=(0,m.r6)(),{onMarkerCreated:l,onNavigateToClip:a}=ve();return r.useCallback(((s,c,m,d)=>{if(i||o)return;const u=r.createElement(Me,{isCurrentPlayback:m,nGlobalOffsetMS:c,playbackCoordinator:t,timelineView:e,fnSetSelectionClipRange:n,onMarkerCreated:l,onNavigateToClip:a});(0,he.lX)(u,s,d)}),[i,o,t,e,n,l,a])}function Me(e){const{playbackCoordinator:t,timelineView:n,nGlobalOffsetMS:i,fnSetSelectionClipRange:o,isCurrentPlayback:l,onMarkerCreated:a,onNavigateToClip:s}=e,d=(0,M.q3)((()=>t.GetClipsAtGlobalMS(i))),u=Pe(n);return r.createElement(ue.tz,{refInstance:u},r.createElement(ue.kt,{onSelected:e=>{t.AddUserMarkerAtGlobalMS(i,"/GameRecording/AddMarker/TimelineCtxMenu",((t,n)=>{a&&a(t,n,e)})),t.SetPlaytimeFromGlobalMS(i),t.FocusGlobalMS(i)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.AddUserMarker)},r.createElement(k.Od,null),(0,G.we)(l?"#Playback_UserSelectionControls_AddUserMarker":"#TimelineDialog_AddMarker"))),r.createElement(ue.kt,{onSelected:()=>{const{strTimelineID:e,nTimelineOffsetMS:n}=t.ConvertGlobalOffsetToTimelineRelativeOffset(i.valMS);(0,m.YM)(t.GetGameID(),e,n)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.TakeScreenshot)},r.createElement(k.i7,null),(0,G.we)(l?"#Playback_UserSelectionControls_TakeScreenshot":"#TimelineDialog_TakeScreenshot"))),r.createElement(ue.kt,{onSelected:()=>{o(t,4,i,void 0),t.SetPlaytimeFromGlobalMS(i),t.FocusGlobalMS(i)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.StartEndClip)},r.createElement(k.Nm,{direction:"left"}),(0,G.we)(l?"#Playback_UserSelectionControls_SetClipStart":"#TimelineContext_SetClipStart"))),r.createElement(ue.kt,{onSelected:()=>{o(t,4,void 0,i),t.SetPlaytimeFromGlobalMS(i),t.FocusGlobalMS(i)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.StartEndClip)},r.createElement(k.Nm,{direction:"right"}),(0,G.we)(l?"#Playback_UserSelectionControls_SetClipEnd":"#TimelineContext_SetClipEnd"))),d.length>0&&r.createElement(ue.kt,{onSelected:()=>{d.length>0&&(c.y.ReportTrackedAction("/GameRecording/Tooltip/ViewClip/TimelineCtxMenu"),s&&s(d[0].strClipID))},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.ViewClip)},r.createElement(k.ai,null),(0,G.we)("#TimelineDialog_ViewClip"))))}function Te(e){const{playbackCoordinator:t,fnSetSelectionClipRange:n}=e,i=(0,r.useRef)(),{onMarkerCreated:o}=ve();return r.createElement(ue.tz,{refInstance:i},r.createElement(ue.kt,{onSelected:e=>{const n=t.GetGlobalMSPlaytime();t.AddUserMarkerAtGlobalMS(n,"/GameRecording/AddMarker/VideoCtxMenu",((t,n)=>{o&&o(t,n,e)})),t.SetPlaytimeFromGlobalMS(n),t.FocusGlobalMS(n)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.AddUserMarker)},r.createElement(k.Od,null),(0,G.we)("#Playback_UserSelectionControls_AddUserMarker"))),r.createElement(ue.kt,{onSelected:()=>{const e=t.GetGlobalMSPlaytime(),{strTimelineID:n,nTimelineOffsetMS:i}=t.ConvertGlobalOffsetToTimelineRelativeOffset(e.valMS);(0,m.YM)(t.GetGameID(),n,i)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.TakeScreenshot)},r.createElement(k.i7,null),(0,G.we)("#Playback_UserSelectionControls_TakeScreenshot"))),r.createElement(ue.kt,{onSelected:()=>{const e=t.GetGlobalMSPlaytime();n(t,4,e,void 0),t.SetPlaytimeFromGlobalMS(e),t.FocusGlobalMS(e)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.StartEndClip)},r.createElement(k.Nm,{direction:"left"}),(0,G.we)("#Playback_UserSelectionControls_SetClipStart"))),r.createElement(ue.kt,{onSelected:()=>{const e=t.GetGlobalMSPlaytime();n(t,4,void 0,e),t.SetPlaytimeFromGlobalMS(e),t.FocusGlobalMS(e)},className:be.TimelineContextMenuItem},r.createElement("div",{className:(0,P.A)(be.MenuItem,be.StartEndClip)},r.createElement(k.Nm,{direction:"right"}),(0,G.we)("#Playback_UserSelectionControls_SetClipEnd"))))}function Pe(e){const t=(0,M.q3)((()=>e.GetAutoScrollPauseTimeout())),n=(0,M.q3)((()=>e.GetVisualWindowStartPX())),i=(0,r.useRef)(),o=(0,r.useRef)();return(0,r.useLayoutEffect)((()=>{i.current&&o.current?o.current.Hide():i.current=!0}),[n]),(0,r.useEffect)((()=>{e.SetAutoScrollPaused(!0)}),[e]),(0,r.useEffect)((()=>{t&&e.ClearAutoScrollPauseTimeout()}),[t,e]),o}var Ge=n(32217),Ee=n(18325),ke=n(59659),Re=n(51467);function Ie(e){let{entry:t,strMarkerIcon:n,onClick:i,onMouseEnter:o,onMouseLeave:l,onContextMenu:a,classNames:s,style:c,faded:m,bSelectedMarker:d}=e;return r.createElement("div",{style:c??{},className:(0,P.A)(s,{[ke.HighlightIcon]:!0,[ke.Selected]:d,[ke.Faded]:m}),onClick:e=>{i&&i(e)},onContextMenu:a,onMouseEnter:o,onMouseLeave:l},r.createElement(De,{entry:t,strMarkerIcon:n}))}function De(e){let{entry:t,strMarkerIcon:n}=e;const i=q().GetGameID();return(0,Ge.xz)(t)?r.createElement(Oe,{achievementEntry:t,strGameID:i}):(0,Ge.In)(t)?r.createElement(Le,{entry:t}):(0,Ee.KJ)(n)?r.createElement(Ae,{entry:t,strMarkerIcon:n}):r.createElement(we,{strMarkerIcon:n,strGameID:i})}function Oe(e){const{achievementEntry:t,strGameID:n}=e,i=new Re.VS(n),o=(0,m.dd)(i.GetAppID(),t.achievement_name);let l,a;if(o)l="white",a=r.createElement("img",{src:o.iconURL});else{const e=(0,Ee.Xw)();l=(0,Ee.b9)(e.color),a=e.func({})}return r.createElement("div",{className:ke.Marker,style:{color:l}},a)}function Ae(e){const{entry:t,strMarkerIcon:n}=e;let i,o;(0,Ge.N$)(t)?(i=(0,Ee.DP)(),o=ke.CustomMarker):i=(0,Ee.o1)(n);const l=(0,Ee.b9)(i.color),a=i.func({}),s=r.createElement("div",{className:o},a);return r.createElement(Xe,{element:s,color:l})}function Le(e){const{entry:t}=e;let n=(0,Ee.o1)("steam_invalid");const i=(0,Ee.b9)(n.color),o=n.func({}),l=r.createElement("div",null,o);return r.createElement(Xe,{element:l,color:i})}function we(e){const{strMarkerIcon:t,strGameID:n}=e,i=function(e,t){return(0,M.q3)((()=>L.Get().GetMarkerStore().GetGameMarkerSVGById(e,t)))}(new Re.VS(n).GetAppID(),t);if(null===i)return null;if(void 0===i){const e=(0,Ee.K_)(),t=r.createElement("div",null,e.func({}));return r.createElement(Xe,{color:(0,Ee.b9)(e.color),element:t})}let o="";o="string"!=typeof i?(new XMLSerializer).serializeToString(i):i;const l=r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},r.createElement("g",{dangerouslySetInnerHTML:{__html:o}}));return r.createElement(Xe,{element:l})}function Xe(e){const{element:t,color:n}=e;return r.createElement("div",{className:ke.MarkerCtn},r.createElement("div",{className:ke.Marker,style:n?{color:n}:null},t))}var Ve=n(12201),Ne=n.n(Ve);const xe=parseInt(Ne().animationDuration);function He(){const e=q(),t=(0,M.q3)((()=>e.GetDisplayHighlightEntry())),[n,i]=(0,r.useState)(null),o=r.useRef(0);return(0,r.useEffect)((()=>{if(t?.entry&&!(0,Ge.hT)(t.entry)&&!(0,Ge.Te)(t.entry))return i(t.entry),o.current=window.setTimeout((()=>{e.SetDisplayHighlightEntry(null)}),t.duration?t.duration:xe),()=>window.clearTimeout(o.current);i(null)}),[t,e]),n?r.createElement(Fe,{entry:n}):null}function Fe(e){const{entry:t}=e,n=q(),i=(0,M.q3)((()=>n.GetGameID())),o=n.GetGameRecordingVideo(),l=(0,M.q3)((()=>n.GetRecordingID())),a=(0,M.q3)((()=>o.IsInitialized())),s=o.GetVideoHeight(),c=o.GetVideoWidth(),m=l&&a&&s>0&&c>0?{height:s,width:c}:{};let d;return(0,Ge.xz)(t)?d=r.createElement(Be,{entry:t,strGameID:i}):(0,Ge.N$)(t)?d=r.createElement(We,{key:t.id,entry:t,strMarkerIcon:t.icon,title:t.title?t.title:(0,G.we)("#Marker_UserMarker_Title"),description:t.description||""}):(0,Ge.sX)(t)?d=r.createElement(We,{key:t.id,entry:t,strMarkerIcon:t.icon,title:(0,G.we)("#MediaManager_ItemType_Screenshot"),description:""}):(0,Ge.eJ)(t)&&(d=r.createElement(We,{key:t.id,entry:t,strMarkerIcon:t.icon,title:t.title||"",description:t.description||""})),r.createElement("div",{className:Ne().BannerVideoOverlay,style:m},d)}function Be(e){const{entry:t,strGameID:n}=e,i=new Re.VS(n),o=(0,m.dd)(i.GetAppID(),t.achievement_name);return o?r.createElement(We,{key:t.id,entry:t,strMarkerIcon:"steam_achievement",title:o.name??"",description:o.description??""}):null}function We(e){const{entry:t,strMarkerIcon:n,title:i,description:o}=e;return r.createElement("div",{className:Ne().PlayerHighlightBanner},r.createElement("div",{className:Ne().BannerContents},r.createElement("div",{className:Ne().HighlightIcon},r.createElement(De,{entry:t,strMarkerIcon:n})),r.createElement("div",{className:Ne().InfoBox},i&&r.createElement("div",{className:Ne().HighlightTitle},i),o&&r.createElement("div",{className:Ne().HighlightDesc},o))))}var qe=n(46242),Ue=n(93999),ze=n.n(Ue),$e=n(6168);const Ze=parseInt(ze().animationDuration);function Je(){const e=q(),t=e.GetGameRecordingVideo(),n=(0,M.q3)((()=>e.GetRecordingID())),i=(0,M.q3)((()=>t.IsInitialized())),o=t.GetVideoHeight(),l=t.GetVideoWidth(),a=n&&i&&o>0&&l>0?{height:o,width:l}:{},s=r.useRef(0),c=(0,M.q3)((()=>e.GetRelativeTimeForDisplay())),m=(0,M.q3)((()=>e.GetGameRecordingVideo().IsInitialized())),d=(0,r.useMemo)((()=>{if(isNaN(c)||!m)return null;const t=e.ConvertGlobalOffsetToTimelineRelativeOffset(c);if(t&&e.GetIsActiveTimeline(t.strTimelineID)){const n=e.MakeRelativeToTimelineEndIfActive(t.strTimelineID,t.nTimelineOffsetMS.valMS);return(0,$e.dt)(n/1e3,!1,!0)}return null}),[m,c,e]);return(0,r.useEffect)((()=>{if(!isNaN(c))return s.current=window.setTimeout((()=>{e.ClearRelativeTimeDisplay()}),Ze),()=>window.clearTimeout(s.current)}),[c,e]),isNaN(c)?null:r.createElement("div",{className:ze().RelativeTimeContainer,style:a},r.createElement("div",{className:ze().RelativeTime,key:d},d))}var Qe=n(74078);function Ye(e){const{disableSound:t,positionAbsolute:n=!0,refVideoResize:i,style:o,refFullscreen:a}=e,s=q(),c=(d=s.StopPlayback,u=s.SetVideoElement,(0,l.QS)((e=>(u(e),()=>d())),[u]));var d,u;const h=s.GetGameRecordingVideo(),_=(0,M.q3)((()=>s.GetRecordingID())),g=(0,M.q3)((()=>h.GetPlaybackError())),f=(0,M.q3)((()=>"Overlay"===s.GetRecordingMode())),S=function(){const e=q(),t=(0,M.q3)((()=>e.GetGlobalMSPlaytime())),{nGlobalEndMS:n,nGlobalStartMS:i}=ne(),r=e.GetGameRecordingVideo();return!((0,M.q3)((()=>r.GetPlaybackError()))||!t||!i||!n)&&(t.valMS>=i.valMS&&t.valMS<=n.valMS)}(),p=ce(),b=g||!_,C=r.useRef();let v=(0,l.Ue)(c,i);const y=function(){const e=q(),t=de(),n=(0,M.q3)((()=>!e.ShouldModeShowClipControls())),i=(0,m.r6)(),{onMarkerCreated:o}=ve();return r.useCallback(((l,a)=>{if(n||i)return;const s=r.createElement(Te,{onMarkerCreated:o,playbackCoordinator:e,fnSetSelectionClipRange:t});(0,he.lX)(s,l,a)}),[n,i,o,e,t])}();const T=r.useCallback((e=>{b||y(e,{bDisableMouseOverlay:!0,bForcePopup:!0,bAlwaysOnTop:!0})}),[b,y]),G=!Q.TS.IN_STEAMUI&&!!e.autoPlay;let E=(0,P.A)(z().GameRecordingPlayer,b&&z().NoVideo,n&&z().PositionAbsolute,p&&z().ClippingMode,f&&z().Overlay,S&&z().PlayingClippedRegion);return r.createElement("div",{ref:C,className:E,onClick:function(){_&&s.TogglePlayPause()},onContextMenu:T,style:o,onDoubleClick:function(){_&&a.current&&(0,Qe.Vr)(a.current)}},r.createElement("video",{ref:v,controls:!1,muted:t,autoPlay:G,playsInline:G}),r.createElement(tt,{player:h}),r.createElement(Ke,null),r.createElement(je,null),r.createElement(et,null),!_&&r.createElement(nt,null),r.createElement(He,null),r.createElement(Je,null))}function Ke(){const e=q(),t=$.fi.Get().IsDebugLogEnabled("GR"),n=(0,M.q3)((()=>e.GetPlaybackStats()));return t&&n?r.createElement("div",{className:z().PerfCtnVideo},r.createElement("div",null,r.createElement("span",null,"Average Seek MS: "),r.createElement("span",null,n.nMean.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"StdDev Seek MS: "),r.createElement("span",null,n.nStdDev.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"Slowest Seek MS: "),r.createElement("span",null,n.nMax.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"Fastest Seek MS: "),r.createElement("span",null,n.nMin.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"# Seeks: "),r.createElement("span",null,n.nLength)),r.createElement("div",null,r.createElement("span",null,"Last Val: "),r.createElement("span",null,n.nLastVal.toFixed(3)))):null}function je(){const e=$.fi.Get().IsDebugLogEnabled("GR"),t=q(),n=((0,M.q3)((()=>{t.GetGlobalMSPlaytime()})),Y.Get().GetPerfMeasures());return e&&n?r.createElement("div",{className:z().PerfCtnThumbnails},r.createElement("div",null,r.createElement("span",null,"Avg Thumbnail Load MS: "),r.createElement("span",null,n.nMean.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"StdDev Thumbnail Load MS: "),r.createElement("span",null,n.nStdDev.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"Slowest Thumbnail Load MS: "),r.createElement("span",null,n.nMax.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"Fastest Thumbnail Load MS: "),r.createElement("span",null,n.nMin.toFixed(3))),r.createElement("div",null,r.createElement("span",null,"# Loaded: "),r.createElement("span",null,n.nLength)),r.createElement("div",null,r.createElement("span",null,"Last Load: "),r.createElement("span",null,n.nLastVal.toFixed(3)))):null}function et(){const e=q(),t=e.GetGameRecordingVideo(),n=t.GetVideoHeight(),i=(0,M.q3)((()=>t.BVideoElementWaiting())),o=(0,M.q3)((()=>t.IsPaused())),l=(0,M.q3)((()=>t.GetPlaybackError())),a=(0,M.q3)((()=>t.IsInitialized()));return!(0,M.q3)((()=>e.GetRecordingID()))||a&&!i||l||o?null:r.createElement("div",{className:z().LoadingSpinner,style:{height:n}},r.createElement(j.y$y,null))}function tt(e){let{player:t}=e,n="";switch((0,M.q3)((()=>t.GetPlaybackError()))){case i.DownloadFailed:case i.PlaybackError:n="#GameRecording_PlayerError_Generic"}return n?r.createElement("div",{className:z().PlayerError},r.createElement("div",{className:z().Text},(0,G.we)("#GameRecording_PlayerError_Generic"))):null}function nt(){const e=q(),t=(0,M.q3)((()=>e.GetGamepadMode())),{onNavigateToClip:n,onNavigateToFAQ:i}=ve(),o=(0,M.q3)((()=>e.GetGlobalMSPlaytime())),l=e.GetClosestPreviousRecordingForGlobalMS(o),a=e.GetClosestNextRecordingForGlobalMS(o),s=(0,M.q3)((()=>e.GetClipsAtGlobalMS(o))),m=(0,r.useCallback)((t=>{if(l){const n=Math.max(parseInt(l.duration_ms)-500,0);e.SetPlaytimeFromRecordingOffset(l.recording_id,n,!0,!0),t.stopPropagation()}}),[e,l]),d=(0,r.useCallback)((t=>{a&&(e.SetPlaytimeFromRecordingOffset(a.recording_id,0),t.stopPropagation())}),[e,a]),u=(0,r.useCallback)((e=>{s.length>0&&(c.y.ReportTrackedAction("/GameRecording/Tooltip/ViewClip/PlayerNoContent"),n(s[0].strClipID),e.stopPropagation())}),[s,n]);return r.createElement("div",{className:z().PlayerError},r.createElement("div",{className:z().Title},(0,G.we)("#GameRecording_PlayerNoContent")),r.createElement("div",{className:z().Description},(0,G.oW)("#GameRecording_PlayerNoContentDescription",r.createElement(qe.Ii,{href:"#",onClick:i}))),!t&&r.createElement("div",{className:z().Buttons},r.createElement(E.he,{direction:"bottom",toolTipContent:(0,G.we)(l?"#GameRecording_PlayerNoContentJumpPrevious_tooltip":"#GameRecording_PlayerNoContentJumpNoContent_tooltip")},r.createElement(R.Z,{className:(0,P.A)(z().Button,z().JumpPrevious,!l&&z().DisableButton),onClick:m,onActivate:m},(0,G.we)("#GameRecording_PlayerNoContentJumpPrevious"))),s.length>0&&r.createElement(E.he,{direction:"bottom",toolTipContent:(0,G.we)("#GameRecording_PlayerNoContentSeeClip_tooltip")},r.createElement(R.Z,{onClick:u,onActivate:u,className:(0,P.A)(z().Button,z().GoToClip)},(0,G.we)("#GameRecording_PlayerNoContentSeeClip"))),r.createElement(E.he,{direction:"bottom",toolTipContent:(0,G.we)(a?"#GameRecording_PlayerNoContentJumpNext_tooltip":"#GameRecording_PlayerNoContentJumpNoContent_tooltip")},r.createElement(R.Z,{className:(0,P.A)(z().Button,z().JumpNext,!a&&z().DisableButton),onClick:d,onActivate:d},(0,G.we)("#GameRecording_PlayerNoContentJumpNext")))))}var it=n(3018),rt=n(99259);const ot=[1e3,5e3,3e4,6e4,15e4,3e5,9e5,18e5],lt=r.memo((function(e){const t=pe(),n=(0,M.q3)((()=>t.GetVisibleTimelines()));return r.createElement(r.Fragment,null,n.map((e=>r.createElement(at,{key:e.timelineID,msVisibleStart:e.msVisibleStart,pxVisibleDuration:e.pxVisibleDuration,pxVisibleStart:e.pxVisibleStart,msTimelineStart:e.globalOffsetMS}))))})),at=r.memo((function(e){const{msVisibleStart:t,msTimelineStart:n,pxVisibleDuration:i,pxVisibleStart:o}=e,{msTickSpacing:l,pxTickSpacing:a}=function(){const e=pe(),t=(0,M.q3)((()=>e.GetCurrentZoomScale())),n=300,i=e=>Math.abs(n-e/t),r=ot.reduce(((e,t)=>i(e)-i(t)<0?e:t))/20,o=r/t;return{msTickSpacing:r,pxTickSpacing:o}}(),s=pe(),c=Math.ceil((t-n)/l),m=n+c*l,d=s.ConvertGlobalMSToGlobalPXOffset(m),u=(0,r.useMemo)((()=>{const e=Math.ceil(i/a),t=[];for(let n=0;n<e;n++){const e=d+n*a,i=`${m+l*n}`;t.push({key:i,offsetPX:e,iTimelineRelativeTick:c+n})}return t}),[i,a,m,l,d,c]);return u?r.createElement(r.Fragment,null,r.createElement("div",{className:rt.TimelineBacking,style:{transform:`translateX(${o}px)`,width:i}}),u.map((e=>r.createElement(st,{key:e.key,timelineRelativeIndex:e.iTimelineRelativeTick,globalOffsetPX:e.offsetPX})))):null}));function st(e){const{globalOffsetPX:t,timelineRelativeIndex:n}=e,i=n%20==0?rt.Major:rt.Minor;return r.createElement("div",{className:rt.TimeTick,style:{transform:`translateX(${t}px)`}},r.createElement("div",{className:(0,P.A)(rt.TickLine,i)}))}var ct=n(19858);class mt{m_reservations=[];m_nIconWidth;constructor(e){this.m_nIconWidth=e}BAllowIcon(e){const t={nStart:e-this.m_nIconWidth/2,nEnd:e+this.m_nIconWidth/2};let n=0;for(;n<this.m_reservations.length;n++){const e=this.m_reservations[n];if(e.nStart>=t.nEnd)break;if(!((i=t).nStart>=(r=e).nEnd||i.nEnd<=r.nStart))return!1}var i,r;return this.m_reservations.splice(n,0,t),!0}}var dt=n(36743),ut=n(96665),ht=n(40813),_t=n(48896);function gt(e){const{strDialogTitle:t,state:n,closeModal:i,strThrobber:o}=e,{bLoading:l,bError:a,bSuccess:s,strError:c,strSuccess:m,elSuccess:d,elError:u,strThrobber:h}=n;return a||c||u?r.createElement(ut.o0,{strTitle:t,bAlertDialog:!0,closeModal:i,className:ht.SucessErrorDialog},Boolean(c)&&r.createElement("div",{className:ht.ErrorStylesWithIcon},c||(0,G.we)("#Error_ErrorCommunicatingWithNetwork")),Boolean(u)&&u):s||m||d?r.createElement(ut.o0,{strTitle:t,strDescription:m||(0,G.we)("#EventDisplay_Share_Success"),bAlertDialog:!0,closeModal:i,className:ht.SucessErrorDialog},r.createElement(r.Fragment,null,Boolean(d)&&d)):r.createElement(ut.o0,{strTitle:t,className:ht.SucessErrorDialog,closeModal:()=>{}},r.createElement(_t.t,{string:o||h||(0,G.we)("#Loading"),size:"medium",position:"center"}))}var ft=n(97775);function St(e){const{closeModal:t,strTimelineID:n,entry:i,playbackCoordinator:o,fnClearSelection:l}=e,[a,s]=r.useState(i.title||""),[c,m]=r.useState(i.description||""),d=function(){const[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!1),[a,s]=(0,r.useState)(null),[c,m]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[h,_]=(0,r.useState)(null),[g,f]=(0,r.useState)(null);return{bLoading:e,bError:n,bSuccess:o,strError:a,strSuccess:c,elSuccess:h,elError:d,strThrobber:g,fnSetLoading:t,fnSetError:i,fnSetSuccess:l,fnSetStrError:s,fnSetStrSuccess:m,fnSetElSuccess:_,fnSetElError:u,fnSetThrobber:f}}();return d.bLoading?r.createElement(gt,{state:d,strDialogTitle:(0,G.we)("#Marker_Dialog"),closeModal:t}):r.createElement(ut.o0,{strTitle:(0,G.we)("#Marker_Dialog"),strMiddleButtonText:(0,G.we)("#Marker_Action_Delete"),onCancel:t,onOK:async()=>{d.fnSetLoading(!0);await o.UpdateUserMarker(n,i,a,c)?t():(d.fnSetError(!0),d.fnSetStrError((0,G.we)("#Marker_UpdateFailed")))}},r.createElement(ft.pd,{type:"text",value:a,onChange:e=>s(e.currentTarget.value),label:(0,G.we)("#Marker_Title")}),r.createElement(ft.pd,{type:"text",value:c,onChange:e=>m(e.currentTarget.value),label:(0,G.we)("#Marker_Description")}))}var pt=n(37811);function bt(e){const{playbackCoordinator:t,timelineView:n,markerInfo:i,setSelectedMarker:o,clearRange:l,bLowDiskSpace:a,onNavigateToClip:s,onNavigateToScreenshot:m}=e,d=(0,M.q3)((()=>n.ConvertGlobalMSToClipOrNone(i.nGlobalMS.valMS))),u=(0,M.q3)((()=>t.ConvertGlobaOffsetToRecordingAndRelativeOffset(i.nGlobalMS.valMS))),_=Pe(n),g=e=>{let n=Ct,r=vt;(0,Ge.zG)(i.entry)&&(n=0,r=parseInt(i.entry.duration));const[l,a]=t.GetLoader().CreateGlobalRangeForTimeline(i.strTimelineID,i.nGlobalMS.valMS,n,r);t.SetPlaytimeFromGlobalMS((0,h.Sb)(l)),o?.(i.entry.id,i.strTimelineID,l,a),c.y.ReportTrackedAction("/GameRecording/HighlightCtxMenu/ClipFromHighlight"),e.stopPropagation()},f=()=>{d&&(c.y.ReportTrackedAction(`/GameRecording/MarkerCtxMenu/ViewClip/${i.entry.type}`),s&&s(d.clipID))},S=e=>{if(!(0,Ge.N$)(i.entry))return;c.y.ReportTrackedAction(`/GameRecording/HighlightCtxMenu/Marker/Edit/${i.entry.type}`);let n=r.createElement(St,{entry:i.entry,playbackCoordinator:t,fnClearSelection:l,strTimelineID:i.strTimelineID});(0,pt.pg)(n,(0,Qe.uX)(e)),e.stopPropagation(),e.preventDefault()},p=e=>{(0,Ge.N$)(i.entry)&&(c.y.ReportTrackedAction(`/GameRecording/HighlightCtxMenu/Marker/Delete/${i.entry.type}`),t.RemoveUserMarker(i.strTimelineID,i.entry.id))},b=()=>{(0,Ge.sX)(i.entry)&&i.entry?.handle&&(c.y.ReportTrackedAction("/GameRecording/HighlightCtxMenu/Screenshot"),m(n.GetGameID(),i.entry.handle))};let C=[];return(0,Ge.N$)(i.entry)&&C.push(r.createElement(ue.kt,{key:"edit",onSelected:S,className:dt.HighlightContextMenuItem},r.createElement("div",{className:(0,P.A)(dt.MenuItem,dt.EditMarker)},r.createElement(k.ff,null),(0,G.we)("#Marker_Action_Edit")))),u?.strRecordingID&&!a&&C.push(r.createElement(ue.kt,{key:"clip",onSelected:g,className:dt.HighlightContextMenuItem},r.createElement("div",{className:(0,P.A)(dt.MenuItem,dt.CreateClip)},r.createElement(k.Wd,null),(0,G.we)("#TimelineDialog_ClipVideo")))),(0,Ge.N$)(i.entry)&&C.push(r.createElement(ue.kt,{key:"delete",onSelected:p,className:dt.HighlightContextMenuItem},r.createElement("div",{className:(0,P.A)(dt.MenuItem,dt.DeleteMarker)},r.createElement(j.lMJ,null),(0,G.we)("#Marker_Action_Delete")))),(0,Ge.sX)(i.entry)&&C.push(r.createElement(ue.kt,{key:"view_screenshot",onSelected:b,className:dt.HighlightContextMenuItem},r.createElement("div",{className:(0,P.A)(dt.MenuItem,dt.ViewScreenshot)},r.createElement(k.pw,null),(0,G.we)("#TimelineDialog_ViewScreenshot")))),d&&f&&C.push(r.createElement(ue.kt,{key:"view_clip",onSelected:f,className:dt.HighlightContextMenuItem},r.createElement("div",{className:(0,P.A)(dt.MenuItem,dt.ViewClip)},r.createElement(k.ai,null),(0,G.we)("#TimelineDialog_ViewClip")))),C.length?r.createElement(ue.tz,{refInstance:_},C):null}const Ct=5e3,vt=3e3;function yt(e){const{markerInfo:t,view:n,coordinator:i,gameID:o,clipID:l,timelineID:a,faded:s}=e,d=t.nGlobalMS,u=(0,M.q3)((()=>n.ConvertGlobalMSToGlobalPXOffset(d.valMS))),_=(0,M.q3)((()=>{const e=n.GetThumbnailComponent();return e&&e!==_e.Highlight})),g=function(){const e=pe(),t=q(),{setSelectedMarker:n}=se(),i=me(),{onNavigateToClip:o,onNavigateToScreenshot:l}=ve(),a=(0,m.r6)(),s=(0,M.q3)((()=>!t.ShouldModeShowClipControls()));return r.useCallback(((c,m,d)=>{if(s)return;const u=r.createElement(bt,{markerInfo:m,playbackCoordinator:t,timelineView:e,setSelectedMarker:n,onNavigateToClip:o,onNavigateToScreenshot:l,bLowDiskSpace:a,clearRange:i});(0,he.lX)(u,c,d)}),[s,a,t,e,n,o,l,i])}(),{selectedMarker:f}=se(),S=t.entry?.id==f?.strEntryID&&t.strTimelineID==f?.strTimelineID,{ref:p,...b}=function(e,t){const n=r.useRef(),i=r.useRef(),o=r.useCallback((t=>{if(!n.current)return;const r=n.current.getBoundingClientRect();if(t.clientY>=r.top&&t.clientY<=r.bottom)return r.left-t.clientX>1||t.clientX-r.right>1?(e.SetThumbnailComponent(null),i.current&&i.current(),void(i.current=null)):void 0;const o=r.left+.5*r.width;(t.clientX<o-Mt||t.clientX>o+Mt)&&(e.SetThumbnailComponent(null),i.current&&i.current(),i.current=null)}),[e]),l=r.useCallback((n=>{if(e.SetThumbnailComponent(_e.Highlight),e.SetThumbnailEntry(t),!i.current){const e=(0,Qe.uX)(n);e.addEventListener("mousemove",o),i.current=()=>e.removeEventListener("mousemove",o)}n.stopPropagation()}),[o,t,e]),a=r.useCallback((t=>{const r=n.current.getBoundingClientRect(),o=r.left,l=r.right;if(t.clientX-o<1||l-t.clientX<1)return e.SetThumbnailComponent(null),i.current&&i.current(),void(i.current=null);(0,Qe.id)(n.current,t.relatedTarget)||t.clientY-r.top>1&&r.bottom-t.clientY>1&&t.clientX-r.left>1&&r.right-t.clientX>1&&(e.SetThumbnailComponent(null),i.current&&i.current(),i.current=null),t.stopPropagation()}),[e]);return r.useEffect((()=>()=>i.current&&i.current()),[]),{ref:n,onMouseOver:l,onMouseLeave:a}}(n,t),C=r.useCallback((e=>{const r=d.valMS-5e3,o=n.FindTimelineOffsets(a),l=Math.max(r,o.globalOffsetMS);i.SetPlaytimeFromGlobalMS((0,h.Sb)(l)),i.SetDisplayHighlightEntry(t.entry),e.stopPropagation(),c.y.ReportTrackedAction(`/GameRecording/Marker/Click/${t.entry.type}`)}),[i,d.valMS,a,n,t]),v={transform:`translateX( calc( ${u}px - 50% ))`};return r.createElement("div",{className:(0,P.A)(ct.MarkerAndDropline,_&&ct.NoPointer,s&&ct.Faded),style:v,ref:p,onContextMenu:e=>{g(e,t,{bDisableMouseOverlay:!0,bForcePopup:!0,bAlwaysOnTop:!0}),e.stopPropagation()},...b},r.createElement("div",{key:d.valMS,className:(0,P.A)(ct.TimelineMarkerCtn)},r.createElement(Ie,{classNames:ct.TimelineMarker,key:t.entry.id,entry:t.entry,strMarkerIcon:t.strMarkerIcon,faded:s,onClick:C,bSelectedMarker:S})),r.createElement("div",{className:ct.DroplineCtn},r.createElement("div",{className:(0,P.A)(ct.TimelineMarkerDropLine)})))}const Mt=150;function Tt(e){return"achievement"===e.type?9e3:e.priority}const Pt=r.memo((function(e){const t=pe(),n=(0,M.q3)((()=>t.GetVisibleTimelines()));return r.createElement(r.Fragment,null,n.map((e=>r.createElement(kt,{key:e.timelineID,timeline:e}))))})),Gt={screenshot:0,event:0,achievement:1,usermarker:2};function Et(e,t){if(Gt[e.type]!==Gt[t.type])return Gt[t.type]-Gt[e.type];const n=Tt(e),i=Tt(t);return n!=i?i-n:e.time!=t.time?parseInt(e.time)-parseInt(t.time):e.id.localeCompare(t.id)}const kt=r.memo((function(e){const{timeline:t}=e,n=pe(),i=q(),o=(0,M.q3)((()=>[...n.GetVisibleTimelineHighlights(t.timelineID)||[]].sort(Et))),l=(0,M.q3)((()=>n.GetTimelineOffsetMS(t.timelineID))),a=t.globalOffsetMS-l,s=i.GetGameID(),c=i.GetClipID(),m=16*n.GetCurrentZoomScale();let d=new mt(m),u=[];return o.forEach(((e,o)=>{if("event"!==e.type&&"usermarker"!==e.type&&"achievement"!==e.type&&"screenshot"!==e.type&&"error"!==e.type)return;const l=`${e.type}_${e.id}_${t.timelineID}_${o}`,m=Rt(t.timelineID,a,e),h=d.BAllowIcon(m.nGlobalMS.valMS);u.push(r.createElement(yt,{gameID:s,clipID:c,key:l,view:n,coordinator:i,faded:!h,timelineID:t.timelineID,markerInfo:m}))})),r.createElement(r.Fragment,null,u.reverse())}));function Rt(e,t,n){if(!["event","usermarker","screenshot","achievement","error"].includes(n.type))return(0,s.q_)(`Unexpected timeline entry type ${n.type}, returning empty highlight marker`),null;let i=n;const r=(0,Ge.xz)(i);return{entry:i,strMarkerIcon:r?"steam_achievement":i.icon,nMarkerPriority:Tt(i),strTimelineID:e,strTitle:!r&&i.title||"",strDescription:!r&&i.description||"",nGlobalMS:(0,h.Sb)(parseInt(i.time)+t)}}var It=n(58023);function Dt(e){const{view:t,entry:n,nGlobalEntryEndMS:i,nGlobalTLStartMS:o}=e,l=q(),a=(0,h.Sb)(parseInt(n.time)+o.valMS),s=(0,M.q3)((()=>{const e=t.ConvertGlobalMSToGlobalPXOffset(a.valMS),n=t.GetVirtualWindowStartPX();return n<e?e:n})),c=(0,M.q3)((()=>{const e=t.ConvertGlobalMSToGlobalPXOffset(i.valMS),n=t.GetVirtualWindowEndPX();return n<e?n:e})),m=!!l.GetClipID(),d={transform:`translateX( ${s}px )`,width:c-s},u=(0,P.A)({[It.Unspecified]:n.mode===Ge.il.Invalid,[It.Staging]:n.mode===Ge.il.Staging,[It.Menus]:n.mode===Ge.il.Menus,[It.Playing]:n.mode===Ge.il.Playing});return r.createElement("div",{key:n.id,className:(0,P.A)(It.GameModeMarker,u,m&&It.GameModeMarkerClip),style:d})}const Ot=r.memo((function(e){const t=pe(),n=(0,M.q3)((()=>t.GetVisibleTimelines()));return r.createElement(r.Fragment,null,n.map((e=>r.createElement(At,{key:e.timelineID,timeline:e}))))})),At=r.memo((function(e){const{timelineID:t,globalOffsetMS:n,nDurationMS:i}=e.timeline,o=pe(),l=(0,M.q3)((()=>{const e=o.GetVisibleTimelineGameModes(t);return e&&0!==e.length?e:[{time:"0",type:"gamemode",mode:Ge.il.Invalid,id:"synthetic"}]})),a=(0,h.Sb)(n+i),s=n-o.GetTimelineOffsetMS(t);let c=[];for(let e=0;e<l.length;e++){const n=(0,h.Sb)(e<l.length-1?parseInt(l[e+1].time)+s:a.valMS-1);c.push(r.createElement(Dt,{key:`gameMode_${t}_${e}`,view:o,entry:l[e],nGlobalEntryEndMS:n,nGlobalTLStartMS:(0,h.Sb)(s)}))}return r.createElement(r.Fragment,null,c)}));var Lt=n(13603),wt=n(98431);const Xt=r.createContext({bInContainer:null,bContainerFocus:null,nMouseClientXPX:null,globalMouseXPX:null,scrollWindowMouseXPX:null,fnRegisterMouseEvent:null});function Vt(e){const{children:t}=e,[n,i]=(0,r.useState)(),[o,l]=(0,r.useState)(),[a,s]=(0,r.useState)(),c=(0,r.useRef)(),m=pe(),d=(0,M.q3)((()=>m.GetScrollableWidthPX())),_=(0,M.q3)((()=>m.GetVisualWindowStartPX())),g=(0,M.q3)((()=>m.GetScrollWindowWidth())),f=(0,M.q3)((()=>m.GetScrollWindowOffset())),S=(0,M.q3)((()=>m.GetTimelineMarginWidth())),p=r.useMemo((()=>{if(c.current){const e=_-f-S;return(0,h.OB)(u.OQ(a+e,0,d))}return(0,h.OB)(0)}),[S,a,f,_,d]),b=r.useMemo((()=>{if(c.current){const e=c.current.getBoundingClientRect(),t=d>g?f:e.x;return(0,h.QP)(u.OQ(a-t,0,g))}return(0,h.QP)(0)}),[a,f,g,d]),C=(0,r.useCallback)(((e,t)=>(c.current&&c.current.addEventListener(e,t),()=>c.current?.removeEventListener(e,t))),[]),v=(0,r.useCallback)((()=>{i(!0)}),[]),y=(0,r.useCallback)((()=>{i(!1)}),[]),T=(0,r.useCallback)((e=>{s(e.clientX)}),[]),P=(0,r.useCallback)((e=>{l(!0)}),[]),G=(0,r.useCallback)((e=>{l(!1)}),[]);(0,r.useEffect)((()=>{const e=(0,Qe.qf)(c.current);return e.addEventListener("mousemove",T),()=>e.removeEventListener("mousemove",T)}),[T]);const E=(0,r.useMemo)((()=>({bContainerFocus:o,bInContainer:n,nMouseClientXPX:a,globalMouseXPX:p,scrollWindowMouseXPX:b,fnRegisterMouseEvent:C})),[o,n,a,p,b,C]);return r.createElement(Xt.Provider,{value:E},r.createElement("div",{ref:c,onMouseOver:P,onFocus:P,onMouseOut:G,onBlur:G,onMouseEnter:v,onMouseLeave:y,className:wt.MouseListenerContainer},t))}function Nt(){return(0,r.useContext)(Xt).globalMouseXPX}function xt(){return(0,r.useContext)(Xt).scrollWindowMouseXPX}function Ht(){return(0,r.useContext)(Xt).bContainerFocus}function Ft(e,t){const n=(0,r.useContext)(Xt).fnRegisterMouseEvent,i=(0,r.useRef)(),o=(0,r.useCallback)((()=>{i.current=n(e,t)}),[n,t,e]),l=(0,r.useCallback)((()=>{i.current&&i.current()}),[]);(0,r.useEffect)((()=>(o(),()=>l())),[o,l])}var Bt=n(37231);const Wt=(0,r.memo)((function(e){const t=q(),n=(0,M.q3)((()=>t.GetHidePlayer())),[i,o]=(0,r.useState)({bDragActive:!1,bPausedOnDragStart:!1}),l=pe(),a=(0,M.q3)((()=>{if(l.GetAutoScrollPaused()||l.BReachedMaxScroll()||l.BReachedMinScroll()||t.BIsVideoElementPaused())return!1;const e=t.GetGlobalMSPlaytime();return l.ConvertGlobalMSToGlobalPXOffset(e.valMS)<l.GetMaxScrollLeftPX()+.5*l.GetScrollWindowWidth()}));return n?r.createElement(Ut,{setDragActive:o}):a?r.createElement(qt,{view:l,setDragActive:o}):r.createElement(zt,{dragState:i,setDragActive:o})}));function qt(e){const{view:t,setDragActive:n}=e,i=(0,M.q3)((()=>t.GetVisualWindowStartPX()+t.GetScrollWindowWidth()/2));return r.createElement(Qt,{playheadPosition:i},r.createElement($t,{setDragActive:n,bDragActive:!1}))}const Ut=(0,r.memo)((function(e){const{setDragActive:t}=e,n=pe(),i=(0,M.q3)((()=>n.GetScrollableWidthPX())),o=(0,l._g)(100),a=(0,r.useCallback)((e=>{n.GetAutoScrollPaused()||o((()=>n.ScrollToOffset(e)))}),[o,n]);return(0,r.useEffect)((()=>n.ScrollToEnd()),[n]),(0,r.useEffect)((()=>a(i)),[i,a]),r.createElement(Qt,{playheadPosition:i},r.createElement($t,{setDragActive:t,bDragActive:!1}))})),zt=(0,r.memo)((function(e){const{dragState:t,setDragActive:n}=e,{bDragActive:i,bPausedOnDragStart:o}=t,l=q(),a=pe(),s=Nt(),c=function(e,t,n,i,o){const l=(0,r.useRef)(),a=(0,M.q3)((()=>t.GetScrollableWidthPX())),s=(0,M.q3)((()=>t.GetScrollWindowWidth())),[c,m]=(0,r.useState)(0),d=(0,r.useRef)(),h=(0,r.useRef)(),{clearPlaybackAnimation:_,startPlaybackAnimation:g}=function(e,t,n){const i=(0,r.useRef)(),o=e.GetGameRecordingVideo(),l=(0,r.useRef)(),a=(0,r.useRef)(),s=(0,r.useRef)(),c=(0,r.useRef)(),m=(0,r.useCallback)((()=>{if(!i.current)return;const r=e.GetGlobalMSPlaytime();if(r.valMS>=0){const e=o.BVideoElementPlaying(),i=o.GetVideoElementCurrentTime(),m=t.GetScrollableWidthPX(),d=t.GetCurrentZoomScale();if(l.current!==r.valMS||c.current&&c.current!=d){const e=t.ConvertGlobalMSToGlobalPXOffset(r.valMS),i=Math.min(m,e);n(i),s.current=i}else if(l.current&&l.current===r.valMS&&i&&a.current&&a.current!==i&&e){const e=l.current+1e3*(i-a.current),r=t.ConvertGlobalMSToGlobalPXOffset(e);if(s.current&&s.current<r){const e=Math.min(m,r);n(e)}s.current=r}e||(a.current=null,l.current=r.valMS),e&&l.current!==r.valMS&&(a.current=i,l.current=r.valMS),c.current=d}i.current=requestAnimationFrame(m)}),[e,n,t,o]),d=(0,r.useCallback)((()=>{i.current&&cancelAnimationFrame(i.current),i.current=null,l.current=null,a.current=null,s.current=null}),[]),u=(0,r.useCallback)((()=>{i.current||(i.current=requestAnimationFrame(m))}),[m]);return{clearPlaybackAnimation:d,startPlaybackAnimation:u}}(o,t,m);(0,r.useEffect)((()=>()=>{d.current&&(cancelAnimationFrame(d.current),d.current=null,h.current=null),_()}),[_]);const f=r.useCallback(((e,t,n,i,r)=>{if(r(t))m((0,u.OQ)(t.GetVisualWindowStartPX()+n,0,t.GetScrollableWidthPX())),cancelAnimationFrame(d.current),d.current=null,h.current=null;else{if(d.current&&(d.current=requestAnimationFrame((e=>f(e,t,n,i,r)))),h.current){const n=(e-h.current)/500*i;t.ScrollBy(n),m((e=>(0,u.OQ)(e+n,0,t.GetScrollableWidthPX())))}h.current=e}}),[m]);return(0,r.useEffect)((()=>{const r=s*(1-ci),o=s*ci;if(d.current&&(cancelAnimationFrame(d.current),d.current=null,h.current=null),n)if(_(),e.valPX<o&&!t.BReachedMinScroll()){if(e.valPX<=l.current){const n=e.valPX-o,i=(0,u.OQ)(Math.abs(n/o),0,1)*n;d.current=requestAnimationFrame((n=>f(n,t,e.valPX,i,t.BReachedMinScroll)))}l.current=e.valPX}else if(e.valPX>r&&!t.BReachedMaxScroll()){if(e.valPX>=l.current){const n=e.valPX-r,i=(0,u.OQ)(Math.abs(n/(s-r)),0,1)*n;d.current=requestAnimationFrame((n=>f(n,t,e.valPX,i,t.BReachedMaxScroll)))}l.current=e.valPX}else m((0,u.OQ)(i.valPX,0,a));else g()}),[n,_,i.valPX,s,a,f,e.valPX,g,t]),c}(xt(),a,i,s,l);return(0,r.useEffect)((()=>{if(!i)return;a.SetThumbnailPosition(c);const e=a.ConvertPXOffsetToGlobalMS(c,!1);if(!e)return;const t=l.GetLiveEdgeMS();l.SetPlaytimeFromGlobalMS(t.valMS<e?t:(0,h.Sb)(e),o)}),[c,o,i,l,a]),r.createElement("div",{className:(0,P.A)(Bt.PlayheadInteractionCtn,i&&Bt.ActiveCtn)},r.createElement(Qt,{className:i?Bt.Active:void 0,playheadPosition:c},r.createElement($t,{setDragActive:n,bDragActive:i})))})),$t=(0,r.memo)((function(e){const{setDragActive:t,bDragActive:n}=e,i=pe(),o=e=>{n||i.SetThumbnailComponent(_e.Playhead),e.stopPropagation()},l=e=>{n||i.SetThumbnailComponent(null),e.stopPropagation()};return r.createElement("div",{className:Bt.PlayHeadContent,onMouseOver:o,onMouseOut:l,onFocus:o,onBlur:l},r.createElement(Zt,{setDragActive:t}))})),Zt=r.memo((function(e){const{setDragActive:t}=e,n=q(),i=ye(),o=pe(),l=(0,M.q3)((()=>{const e=o.GetThumbnailComponent();return e===_e.RangeLeft||e===_e.RangeRight})),a=(0,r.useCallback)((e=>{if(0!=e.button)return;const i=(0,Qe.uX)(e);let r,l;const a=()=>{const e=n.GetGameRecordingVideo().IsPaused();t({bDragActive:!0,bPausedOnDragStart:e}),o.SetThumbnailComponent(_e.Playhead),r()};i.addEventListener("mousemove",a),r=()=>i.removeEventListener("mousemove",a);const s=()=>{t({bDragActive:!1,bPausedOnDragStart:!1}),o.SetThumbnailComponent(null),r(),l()};i.addEventListener("mouseup",s),l=()=>i.removeEventListener("mouseup",s)}),[n,t,o]),s=(0,r.useCallback)((e=>{const t=n.GetGlobalMSPlaytime();i(e,t,!0,{bDisableMouseOverlay:!0,bForcePopup:!0,bAlwaysOnTop:!0}),e.stopPropagation(),e.preventDefault()}),[n,i]);return r.createElement("div",{className:(0,P.A)(Bt.PlayHead,l&&Bt.NoPointer),onMouseDown:a,onContextMenu:s},r.createElement(Jt,null))}));function Jt(e){return r.createElement("svg",{...e,width:"12",height:"32",viewBox:"0 0 12 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("rect",{x:"5",y:"4",width:"2",height:"40",fill:"currentColor"}),r.createElement("path",{d:"M6 6L0.803849 -9.78799e-07L11.1962 -7.02746e-08L6 6Z",fill:"currentColor"}))}function Qt(e){const{className:t,playheadPosition:n,children:i}=e;return r.createElement("div",{className:(0,P.A)(Bt.PlayHeadContainer,t),style:{transform:`translateX( calc(${n}px - 50% ))`}},i)}var Yt=n(19784);const Kt=parseInt(Yt.thumbnailWidth),jt=r.forwardRef((function(e,t){const{globalMS:n,children:i,imgClassName:o,className:l,...a}=e,s=q(),c=s.GetGameID(),m=s.GetClipID(),d=(0,M.q3)((()=>s.GetRecordingMode())),u=(0,M.q3)((()=>s.ConvertGlobaOffsetToRecordingAndRelativeOffset(n))),h=(ce(),u?.nRecordingOffsetMS),_=K(c,m,u?.strRecordingID,h,u?.nStartOffsetMS,Kt,false),[g,f]=(0,r.useState)();return(0,r.useEffect)((()=>{_&&f(_)}),[_]),r.createElement("div",{ref:t,className:(0,P.A)(Yt.ThumbnailContainerOffset,Yt[d],l),...a},r.createElement("div",{className:(0,P.A)(Yt.ThumbnailContents,u?.strRecordingID&&!g&&Yt.Hide,Yt[d])},r.createElement("div",{className:Yt.ImageAndInfoBoxContainer},r.createElement("div",{className:Yt.ImageContainer},u?.strRecordingID?r.createElement("img",{className:Yt.ThumbnailImage,src:g}):r.createElement("div",{className:Yt.NoRecordedContent},(0,G.we)("#GameRecording_PlayerNoContent")),r.createElement(en,null))),r.createElement("div",{className:(0,P.A)(Yt.TooltipChildren)},i)),r.createElement("div",{className:(0,P.A)(Yt.ThumbnailHitBoxPadding)}))}));function en(){const e=pe(),t=(0,M.q3)((()=>e.GetGameID())),n=(0,M.q3)((()=>e.GetThumbnailComponent())),i=(0,M.q3)((()=>e.GetThumbnailEntry()));if(!i||n!==_e.Highlight)return null;if((0,Ge.xz)(i.entry))return r.createElement(tn,{thumbnailEntry:i,achievementEntry:i.entry,strGameID:t});let o="",l="";return(0,Ge.In)(i.entry)?l=(0,G.we)(i.entry.description)||"#GameRecording_UnknownError":(0,Ge.N$)(i.entry)?(o=i.entry.title?i.entry.title:(0,G.we)("#Marker_UserMarker_Title"),l=i.entry.description||""):(0,Ge.eJ)(i.entry)&&(o=i.entry.title||"",l=i.entry.description||""),o||l?r.createElement(nn,{title:o,description:l,thumbnailEntry:i}):null}function tn(e){const{strGameID:t,thumbnailEntry:n,achievementEntry:i}=e,o=new Re.VS(t),l=(0,m.dd)(o.GetAppID(),i.achievement_name);return l?r.createElement(nn,{title:l.name??"",description:l.description??"",thumbnailEntry:n}):null}function nn(e){const{title:t,description:n,thumbnailEntry:i}=e;return r.createElement("div",{className:Yt.InfoBoxContainer},r.createElement("div",{className:Yt.Header},r.createElement("div",{className:Yt.Icon},r.createElement(De,{entry:i.entry,strMarkerIcon:i.strMarkerIcon})),t&&r.createElement("div",{className:Yt.Title},t)),r.createElement("div",{className:Yt.DescriptionBlock},n&&r.createElement("div",{className:Yt.Description},n)))}const rn=r.forwardRef((function(e,t){const{globalPX:n,onMouseEnter:i,onMouseLeave:o}=e,l=pe(),a=(0,M.q3)((()=>l.ConvertPXOffsetToGlobalMS(n,!1))),s=(0,M.q3)((()=>l.GetThumbnailComponent())),c=q(),m=(0,M.q3)((()=>c.GetRecordingMode()));return r.createElement(jt,{className:(0,P.A)(Yt.ThumbnailTooltip,Yt[m],Yt[s]),globalMS:a,ref:t,onMouseEnter:i,onMouseLeave:o},r.createElement(on,{globalMS:a}),r.createElement("div",{className:Yt.TooltipInteractionRegion},s===_e.Highlight?r.createElement(ln,null):r.createElement(an,{globalPX:n}),r.createElement(sn,{globalMS:a})))}));function on(e){const{globalMS:t}=e,n=pe(),i=(0,M.q3)((()=>n.GetStateDescriptionAtGlobalMS(t)));return i?.title?r.createElement("div",{className:Yt.StateDescription},i.title):null}function ln(){const e=q(),t=(0,M.q3)((()=>e.GetRecordingMode())),n=pe(),i=(0,M.q3)((()=>n.GetThumbnailEntry()));if(!i)return null;const o=n.GetTimelineOffsetMS(i.strTimelineID),l=parseInt(i.entry.time),a=(0,h.sK)(l-o),s=e.MakeRelativeToTimelineEndIfActive(i.strTimelineID,a.valMS);let c="";if((0,Ge.zG)(i.entry)){const e=s+parseInt(i.entry.duration);if(s<0){const t=(0,$e.qZ)(Math.abs(s/1e3),!1,!1),n=(0,$e.qZ)(Math.abs(e/1e3),!1,!1);c=(0,G.we)("#Duration_WrittenNegation",t+" - "+n)}else{c=(0,$e.qZ)(s/1e3,!1,!1)+" - "+(0,$e.qZ)(e/1e3,!1,!1)}}else c=(0,$e.qZ)(s/1e3,!1,!0);return r.createElement("div",{className:(0,P.A)(Yt.TimeDisplayContainer,Yt.Highlight,Yt[t])},c)}function an(e){const{globalPX:t}=e,n=pe(),i=(0,M.q3)((()=>n.ConvertPXToTimelineRelativeMS(t,"end-if-active")));return Boolean(i)?r.createElement("div",{className:Yt.TimeDisplayContainer},(0,$e.qZ)(i/1e3,!1,!0)):null}function sn(e){const{globalMS:t}=e,n=pe(),i=(0,M.q3)((()=>n.GetGameID())),o=(0,M.q3)((()=>n.GetThumbnailComponent())),l=(0,M.q3)((()=>n.GetThumbnailEntry()));let a=[r.createElement(_n,{key:"add_marker",globalMS:t}),r.createElement(gn,{key:"view_clip",globalMS:t})];return o==_e.Highlight&&l&&((0,Ge.In)(l.entry)||(0,Ge.xz)(l.entry)||(0,Ge.eJ)(l.entry)?a=[r.createElement(cn,{key:"create_marker_clip",markerInfo:l}),r.createElement(mn,{key:"view_clip",markerInfo:l})]:(0,Ge.sX)(l.entry)?a=[r.createElement(cn,{key:"create_marker_clip",markerInfo:l}),r.createElement(hn,{key:"view_screen",entry:l.entry,gameID:i}),r.createElement(mn,{key:"view_clip",markerInfo:l})]:(0,Ge.N$)(l.entry)&&(a=[r.createElement(un,{key:"edit_user",markerInfo:l}),r.createElement(cn,{key:"create_marker_clip",markerInfo:l}),r.createElement(dn,{key:"delete_user",markerInfo:l}),r.createElement(mn,{key:"view_clip",markerInfo:l})])),r.createElement("div",{className:Yt.TooltipButtons},a)}function cn(e){const{setSelectedMarker:t}=se(),{markerInfo:n}=e,i=q(),o=(0,M.q3)((()=>i.ShouldModeShowClipControls())),l=(0,M.q3)((()=>i.ConvertGlobaOffsetToRecordingAndRelativeOffset(n.nGlobalMS.valMS))),a=(0,m.r6)();return l?.strRecordingID&&o?r.createElement(E.he,{toolTipContent:(0,G.we)(a?"#RecordingState_Clip_LowDiskSpace":"#TimelineDialog_ClipVideo"),direction:"top",bTopmost:!0},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.CreateClipButton),onClick:e=>{let r=Ct,o=vt;(0,Ge.zG)(n.entry)&&(r=0,o=parseInt(n.entry.duration));const[l,a]=i.GetLoader().CreateGlobalRangeForTimeline(n.strTimelineID,n.nGlobalMS.valMS,r,o);i.SetPlaytimeFromGlobalMS((0,h.Sb)(l)),t?.(n.entry.id,n.strTimelineID,l,a),c.y.ReportTrackedAction("/GameRecording/Tooltip/ClipFromHighlight"),e.stopPropagation()}},r.createElement(k.Wd,null))):null}function mn(e){const{markerInfo:t}=e,n=pe(),i=(0,M.q3)((()=>n.ConvertGlobalMSToClipOrNone(t.nGlobalMS.valMS))),{onNavigateToClip:o}=ve();return i?r.createElement(E.he,{toolTipContent:(0,G.we)("#TimelineDialog_ViewClip"),direction:"top",bTopmost:!0},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.GoToClipFromMarker),onClick:()=>{i&&(c.y.ReportTrackedAction(`/GameRecording/Tooltip/ViewClip/${t.entry.type}`),o(i.clipID))}},r.createElement(j.CeX,null))):null}function dn(e){const{markerInfo:t}=e,n=q(),i=pe();return r.createElement(E.he,{toolTipContent:(0,G.we)("#Marker_Action_Delete"),direction:"top",bTopmost:!0},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.DeleteMarker),onClick:e=>{(0,Ge.N$)(t.entry)&&(c.y.ReportTrackedAction(`/GameRecording/Marker/Delete/${t.entry.type}`),n.RemoveUserMarker(t.strTimelineID,t.entry.id),i.SetThumbnailComponent(null))}},r.createElement(j.lMJ,null)))}function un(e){const{markerInfo:t}=e,n=q(),i=me();return r.createElement(E.he,{toolTipContent:(0,G.we)("#Marker_Action_Edit"),direction:"top",bTopmost:!0},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.EditMarker),onClick:e=>{if(!(0,Ge.N$)(t.entry))return;c.y.ReportTrackedAction(`/GameRecording/Marker/Edit/${t.entry.type}`);let o=r.createElement(St,{entry:t.entry,playbackCoordinator:n,fnClearSelection:i,strTimelineID:t.strTimelineID});(0,pt.pg)(o,(0,Qe.uX)(e)),e.stopPropagation(),e.preventDefault()}},r.createElement(k.ff,null)))}function hn(e){const{entry:t,gameID:n}=e,i=t.handle,{onNavigateToScreenshot:o}=ve();return r.createElement(E.he,{toolTipContent:(0,G.we)("#TimelineDialog_ViewScreenshot"),direction:"top",bTopmost:!0},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.ViewScreenshot),onClick:()=>{i&&(c.y.ReportTrackedAction("/GameRecording/Tooltip/Screenshot"),o(n,i))}},r.createElement(k.pw,null)))}function _n(e){const{globalMS:t}=e,n=q();return r.createElement(E.he,{toolTipContent:(0,G.we)("#TimelineDialog_AddMarker"),direction:"top"},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.AddMarker),onClick:()=>{n.AddUserMarkerAtGlobalMS((0,h.Sb)(t),"/GameRecording/AddMarker/Thumbnail",null),n.SetPlaytimeFromGlobalMS((0,h.Sb)(t))}},r.createElement(k.pH,null)))}function gn(e){const{globalMS:t}=e,n=pe(),i=(0,M.q3)((()=>n.ConvertGlobalMSToClipOrNone(t))),{onNavigateToClip:o}=ve();return i?r.createElement(E.he,{toolTipContent:(0,G.we)("#TimelineDialog_ViewClip"),direction:"top"},r.createElement("div",{className:(0,P.A)(Yt.Button,Yt.GoToClip),onClick:()=>{i&&(c.y.ReportTrackedAction("/GameRecording/Tooltip/ViewClip/timeline"),o(i.clipID))}},r.createElement(j.CeX,null))):null}const fn=r.memo((function(e){const t=(0,r.useContext)(Xt),n=Ht(),i=pe(),o=q(),l=ye(),a=(0,r.useCallback)((e=>{if(!n)return;const t=e.currentTarget.getBoundingClientRect(),r=u.OQ(e.clientX-t.x,0,t.width),l=i.ConvertPXOffsetToGlobalMS(r,!1);l&&o.SetPlaytimeFromGlobalMS((0,h.Sb)(l))}),[n,o,i]),s=(0,r.useCallback)((e=>{if(!n)return;const t=e.currentTarget.getBoundingClientRect(),r=u.OQ(e.clientX-t.x,0,t.width),o=i.ConvertPXOffsetToGlobalMS(r,!1);o&&(l(e,(0,h.Sb)(o),!1,{bDisableMouseOverlay:!0,bForcePopup:!0,bAlwaysOnTop:!0}),e.preventDefault(),e.stopPropagation())}),[n,i,l]);return Ft("click",a),Ft("contextmenu",s),r.createElement(Sn,{globalMouseXPX:t.globalMouseXPX.valPX||0})})),Sn=r.memo((function(e){const{globalMouseXPX:t}=e,n=(0,r.useContext)(Xt).bInContainer,i=pe(),o=Ht(),l=(0,M.q3)((()=>{if(i.GetThumbnailComponent())return i.GetThumbnailPosition()})),[a,s]=(0,r.useState)(),[c,m]=(0,r.useState)();return(0,r.useEffect)((()=>{if(!isNaN(l))return void s(l);!c&&n&&s(t)}),[c,n,o,t,l]),r.createElement("div",{className:Lt.GhostPlayheadCtn,style:{transform:`translateX( calc(${a}px - 50%))`}},r.createElement(pn,{globalPX:a,setInteractingWithThumbnail:m,bInteractingWithThumbnail:c}))}));function pn(e){const{globalPX:t,setInteractingWithThumbnail:n,bInteractingWithThumbnail:i}=e,o=pe(),l=q(),a=(0,M.q3)((()=>"Overlay"===l.GetRecordingMode())),s=(0,M.q3)((()=>o.ConvertPXOffsetToGlobalMS(t,!1))),c=(0,M.q3)((()=>o.GetTimelineParentCtnRef())),m=(0,r.useRef)(),d=(0,r.useRef)(),u=(0,r.useRef)(),h=(0,M.q3)((()=>o.GetThumbnailComponent())),_=Ht(),g=(0,E.fS)({toolTipContent:r.createElement(rn,{globalPX:t,ref:m,onMouseEnter:()=>n(!0),onMouseLeave:e=>n(!1)}),direction:a?"bottom":"top",nDelayShowMS:0,nBodyDistance:0,nAllowOffscreenPx:0}),{setHovered:f,setTarget:S}=g.stateHandlers,p=(0,r.useCallback)((()=>{f(!1),n(!1),u.current&&u.current(),u.current=null,o.GetAutoScrollPaused()&&o.SetAutoScrollPauseTimeout(),o.SetThumbnailComponent(null)}),[n,f,o]),b=(0,r.useCallback)(((e,t)=>{if(!d.current||!m.current)return;const n=d.current.getBoundingClientRect(),i=n.left,r=n.right;let o=n.top,l=n.bottom;if(m.current){const e=m.current.getBoundingClientRect();a?l=e.bottom:o=e.top}(e<=i||e>=r||t<=o||t>=l)&&p()}),[a,p]),C=(0,r.useCallback)((e=>{const t=o.GetThumbnailComponent();t&&t!==_e.Highlight||b(e.clientX,e.clientY)}),[b,o]),v=(0,r.useCallback)((e=>{b(e.clientX,e.clientY)}),[b]);Ft("mouseenter",(0,r.useCallback)((()=>{f(!0),S(d.current);const e=(0,Qe.qf)(d.current);e&&!u.current&&(e.addEventListener("mousemove",C),e.addEventListener("mouseup",v),u.current=()=>{e.removeEventListener("mousemove",C),e.removeEventListener("mouseup",v)})}),[C,v,f,S])),(0,r.useEffect)((()=>{const e=e=>{const t=o.GetThumbnailComponent();t&&t===_e.Playhead||t===_e.RangeLeft||t===_e.RangeRight||m.current&&!(0,Qe.id)(m.current,e.relatedTarget)&&p()};return c&&c.addEventListener("mouseleave",e),()=>c&&c.removeEventListener("mouseleave",e)}),[p,c,o]),(0,r.useEffect)((()=>p),[p]);const y=(_||i)&&s&&!h;return r.createElement("div",{ref:d,className:Lt.TooltipHoverSource},r.createElement(Jt,{className:(0,P.A)(Lt.GhostPlayhead,y&&Lt.Show)}),!!s&&g.tooltip)}var bn=n(30321);const Cn=500,vn=(0,r.memo)((function(){const[e,t]=(0,r.useState)("none"),n=oe(),i=ie(),o=re();return n&&i&&o?r.createElement("div",{className:bn.RangeControls},r.createElement(yn,{activeControlState:e,setActiveControlState:t})):null})),yn=(0,r.memo)((function(e){const{activeControlState:t,setActiveControlState:n}=e,[i,o]=(0,r.useState)(),[l,a]=(0,r.useState)(),s=ie(),c=re(),m=pe(),d=(0,M.q3)((()=>m.ConvertGlobalMSToGlobalPXOffset(s.valMS))),u=(0,M.q3)((()=>m.ConvertGlobalMSToGlobalPXOffset(c.valMS))),h=(0,r.useCallback)((e=>{o(e),m.SetAutoScrollPauseTimeout()}),[m]),_=(0,r.useCallback)((e=>{a(e),m.SetAutoScrollPauseTimeout()}),[m]),g=(0,r.useCallback)((e=>{"none"===t&&e.stopPropagation()}),[t]),f=(0,r.useCallback)((e=>{"none"===t&&e.stopPropagation()}),[t]);return r.createElement("div",{className:(0,P.A)(bn.RangeSelectorCtn,"none"!==t&&bn.Active),onMouseOver:g,onMouseOut:f,onFocus:g,onBlur:f},r.createElement("div",{className:bn.TrackRangeControls},r.createElement(Tn,{isActive:"left"===t,setControlState:n,setRangeControlPX:h,pxOffset:i}),r.createElement(Rn,{startOffsetPX:"left"===t&&i||d,endOffsetPX:"right"===t&&l||u,className:bn.SelectedRangeMask}),r.createElement(Gn,{isActive:"right"===t,setControlState:n,setRangeControlPX:_,pxOffset:l})))}));function Mn(e,t,n){const i=t.GetVisualWindowStartPX()-t.GetTimelineMarginWidth(),r=i+t.GetVisualWidth(),o=Math.max(0,i+3),l=Math.min(t.GetScrollableWidthPX(),r-3);n(u.OQ(e,o,l))}const Tn=(0,r.memo)((function(e){const{isActive:t,setControlState:n,setRangeControlPX:i,pxOffset:o}=e,l=ie();return t?r.createElement(Pn,{setControlState:n,setRangeControlPX:i,pxOffset:o}):r.createElement(kn,{offsetMS:l.valMS,direction:"left",setControlState:n,setRangeControlPX:i})}));function Pn(e){const{setControlState:t,setRangeControlPX:n,pxOffset:i}=e,o=le(),l=re(),a=pe(),s=Nt();return function(e,t,n,i,o,l){const a=(0,r.useRef)(),s=(0,r.useRef)(!1),c=(0,r.useRef)(),m=(0,r.useRef)(),d=(0,M.q3)((()=>t.GetScrollableWidthPX())),h=(0,M.q3)((()=>t.GetScrollWindowWidth()));(0,r.useEffect)((()=>()=>{c.current&&(cancelAnimationFrame(c.current),c.current=null,m.current=null)}),[]);const _=r.useCallback(((e,t,n,i,r)=>{if(r(t))l(u.OQ(t.GetVisualWindowStartPX()+n,0,t.GetScrollableWidthPX())),cancelAnimationFrame(c.current),c.current=null,m.current=null;else{if(c.current&&(c.current=requestAnimationFrame((e=>_(e,t,n,i,r)))),m.current){const n=(e-m.current)/Cn*i;t.ScrollBy(n),l((e=>u.OQ(e+n,0,t.GetScrollableWidthPX())))}m.current=e}}),[l]);(0,r.useEffect)((()=>{c.current&&(cancelAnimationFrame(c.current),c.current=null,m.current=null);const r=h*(1-ci),g=h*ci,f=t.ConvertGlobalMSToGlobalPXOffset(n.valMS),S=t.ConvertGlobalMSToScrollWindowPXOffset(n.valMS);if(i.valPX>f)return l(f),o("right"),void t.SetThumbnailComponent(_e.RangeRight);if(e.valPX<g&&!t.BReachedMinScroll()){if(e.valPX>a.current)s.current=!0;else if(e.valPX<a.current||!s.current){const n=Math.min(g,S),i=e.valPX-n,r=u.OQ(Math.abs(i/n),0,1)*i;c.current=requestAnimationFrame((n=>_(n,t,e.valPX,r,t.BReachedMinScroll))),s.current=!1}Mn(i.valPX,t,l)}else if(e.valPX>r&&S>r&&!t.BReachedMaxScroll()){if(e.valPX<a.current)s.current=!0;else if(e.valPX>a.current||!s.current){const i=e=>{const t=e.ConvertGlobalMSToScrollWindowPXOffset(n.valMS);return e.BReachedMaxScroll()||t<=r},o=e.valPX-r,l=u.OQ(Math.abs(o/(h-r)),0,1)*o;c.current=requestAnimationFrame((n=>_(n,t,e.valPX,l,i))),s.current=!1}Mn(i.valPX,t,l)}else l(u.OQ(i.valPX,0,d));a.current=e.valPX}),[i.valPX,n.valMS,e.valPX,o,t,l,d,_,h])}(xt(),a,l,s,t,n),(0,r.useEffect)((()=>{isNaN(i)||(a.SetThumbnailPosition(i),o(5,(0,h.Sb)(a.ConvertPXOffsetToGlobalMS(i))))}),[i,o,a]),r.createElement(In,{offsetPX:i,direction:"left"})}const Gn=(0,r.memo)((function(e){const{isActive:t,setControlState:n,setRangeControlPX:i,pxOffset:o}=e,l=re();return t?r.createElement(En,{setControlState:n,setRangeControlPX:i,pxOffset:o}):r.createElement(kn,{offsetMS:l.valMS,direction:"right",setControlState:n,setRangeControlPX:i})}));function En(e){const{setControlState:t,setRangeControlPX:n,pxOffset:i}=e,o=ae(),l=ie(),a=pe(),s=Nt();return function(e,t,n,i,o,l){const a=(0,r.useRef)(),s=(0,r.useRef)(!1),c=(0,r.useRef)(),m=(0,r.useRef)(),d=(0,M.q3)((()=>t.GetScrollableWidthPX())),h=(0,M.q3)((()=>t.GetScrollWindowWidth()));(0,r.useEffect)((()=>()=>{c.current&&(cancelAnimationFrame(c.current),c.current=null,m.current=null)}),[]);const _=r.useCallback(((e,t,n,i,r)=>{if(r(t))l(u.OQ(t.GetVisualWindowStartPX()+n,0,t.GetScrollableWidthPX())),cancelAnimationFrame(c.current),c.current=null,m.current=null;else{if(c.current&&(c.current=requestAnimationFrame((e=>_(e,t,n,i,r)))),m.current){const n=(e-m.current)/Cn*i;t.ScrollBy(n),l((e=>u.OQ(e+n,0,t.GetScrollableWidthPX())))}m.current=e}}),[l]);(0,r.useEffect)((()=>{c.current&&(cancelAnimationFrame(c.current),c.current=null,m.current=null);const r=h*(1-ci),g=h*ci,f=t.ConvertGlobalMSToGlobalPXOffset(n.valMS),S=t.ConvertGlobalMSToScrollWindowPXOffset(n.valMS);if(i.valPX<f)return l(f),o("left"),void t.SetThumbnailComponent(_e.RangeLeft);if(e.valPX>r&&!t.BReachedMaxScroll()){if(e.valPX<a.current)s.current=!0;else if(e.valPX>a.current||!s.current){const n=Math.max(r,S),i=e.valPX-n,o=u.OQ(Math.abs(i/(h-n)),0,1)*i;c.current=requestAnimationFrame((n=>_(n,t,e.valPX,o,t.BReachedMaxScroll))),s.current=!1}Mn(i.valPX,t,l)}else if(e.valPX<g&&S<g&&e.valPX<=a.current&&!t.BReachedMinScroll()){if(e.valPX>a.current)s.current=!0;else if(e.valPX<a.current||!s.current){const i=e.valPX-g,r=u.OQ(Math.abs(i/g),0,1)*i,o=e=>e.ConvertGlobalMSToScrollWindowPXOffset(n.valMS)>g||e.BReachedMinScroll();c.current=requestAnimationFrame((n=>_(n,t,e.valPX,r,o))),s.current=!1}Mn(i.valPX,t,l)}else l(u.OQ(i.valPX,0,d));a.current=e.valPX}),[n.valMS,e.valPX,o,t,l,d,h,i.valPX,_])}(xt(),a,l,s,t,n),(0,r.useEffect)((()=>{isNaN(i)||(a.SetThumbnailPosition(i),o(5,(0,h.Sb)(a.ConvertPXOffsetToGlobalMS(i))))}),[i,o,a]),r.createElement(In,{offsetPX:i,direction:"right"})}function kn(e){const{offsetMS:t,direction:n,setControlState:i,setRangeControlPX:o}=e,l=pe(),a=(0,M.q3)((()=>l.ConvertGlobalMSToGlobalPXOffset(t)));(0,r.useEffect)((()=>(o(void 0),()=>{o(a)})),[a,o]);const s=(0,r.useCallback)((e=>{const t=(0,Qe.uX)(e);let r,o;const a=()=>{i(n),l.SetThumbnailComponent("left"===n?_e.RangeLeft:_e.RangeRight),r()};t.addEventListener("mousemove",a),r=()=>t.removeEventListener("mousemove",a);const s=()=>{i("none"),l.SetThumbnailComponent(null),r(),o()};t.addEventListener("mouseup",s),o=()=>t.removeEventListener("mouseup",s)}),[n,i,l]),c=e=>{l.SetThumbnailComponent("left"===n?_e.RangeLeft:_e.RangeRight)},m=e=>{l.SetThumbnailComponent(null)};return r.createElement("div",{className:bn.InactiveSelectedRangeControl,onMouseDown:s,onMouseOver:c,onFocus:c,onMouseOut:m,onBlur:m},r.createElement(In,{offsetPX:a,direction:n}))}const Rn=(0,r.memo)((function(e){const{startOffsetPX:t,endOffsetPX:n,className:i}=e;if(isNaN(t)||isNaN(n))return null;const o={width:n-t||0,transform:`translateX(${t}px)`};return r.createElement("div",{className:(0,P.A)(bn.RangeMask,i),style:o})})),In=(0,r.memo)((function(e){const{direction:t,offsetPX:n}=e,i={transform:`translateX( calc( ${n}px - 50%) )`},o=pe(),l=(0,M.q3)((()=>o.GetThumbnailComponent()===_e.Playhead));return r.createElement("div",{style:i,className:(0,P.A)(bn.RangeControl)},r.createElement("div",{className:(0,P.A)(bn.RangeIcon,"left"===t&&bn.Left,l&&bn.Hide)},r.createElement(Dn,{innerFill:"#171d25",direction:t})))}));function Dn(e){return r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 3 36",fill:"none",style:{transform:`rotate(${"right"===e.direction?180:0}deg)`}},r.createElement("rect",{fill:"currentColor",width:"3",height:"6.00006",transform:"matrix(-1 0 0 1 3 0)"}),r.createElement("rect",{fill:"currentColor",width:"3",height:"6.00006",transform:"matrix(-1 0 0 1 3 10)"}),r.createElement("rect",{fill:"currentColor",width:"3",height:"6.00006",transform:"matrix(-1 0 0 1 3 20)"}),r.createElement("rect",{fill:"currentColor",width:"3",height:"6.00006",transform:"matrix(-1 0 0 1 3 30)"}))}var On=n(50804);const An=r.memo((function(e){const t=pe(),n=(0,M.q3)((()=>t.GetVisibleWindowRelativeTimelines())),i=q().GetRecordingMode();let o=[],l="";for(let e of n){let n=t.GetTimeRecorded(e.timelineID),i=(0,G._l)(n);i!=l&&(o.push({timeline:e,strLabel:i}),l=i)}for(let e=o.length-2;e>=0;e--){let t=o[e];o[e+1].timeline.nVisibleStartPX-t.timeline.nVisibleStartPX>=100||o.splice(e,1)}return r.createElement(r.Fragment,null,o.map((e=>r.createElement(Ln,{key:e.timeline.timelineID,startPX:e.timeline.nVisibleStartPX,label:e.strLabel,recordingMode:i}))))}));function Ln(e){const{label:t,startPX:n,recordingMode:i}=e;let o=i==w.Overlay;return r.createElement("div",{className:(0,P.A)(On.TimelineRelativeDate,o&&On.Overlay),style:{transform:`translateX(${n}px)`}},t)}var wn=n(77679);const Xn=(0,r.memo)((function(e){const t=pe(),n=(0,M.q3)((()=>t.GetVisibleRecordings()));return r.createElement(r.Fragment,null,n.map((e=>r.createElement(Vn,{key:e.recordingID,startPX:e.nStartPX,endPX:e.nEndPX,isActive:e.bIsActive,recordingType:e.recordingType}))))}));function Vn(e){const{isActive:t,endPX:n,startPX:i,recordingType:o}=e,l={width:n-i||0,transform:`translateX(${i}px)`},a=ce(),s=4===o,c=2===o;return r.createElement(r.Fragment,null,r.createElement("div",{className:(0,P.A)(wn.RecordingDecorator,s&&wn.Clip,c&&wn.Manual,a&&wn.ClipMode),style:l}),t&&r.createElement(Nn,{endPX:n}))}function Nn(e){const{endPX:t}=e,n=q(),i=pe(),o=(0,M.q3)((()=>"Overlay"===n.GetRecordingMode())),l=O(n.GetGameID()),a=(0,M.q3)((()=>n.GetIsLiveEdge()&&!n.GetHidePlayer())),s=(0,M.q3)((()=>{const e=n.GetLiveEdgeBufferWindowStartMS();return i.ConvertGlobalMSToGlobalPXOffset(e.valMS)}));if(!o||l!==y.BackgroundRecording)return null;const c={width:t-s||0,transform:`translateX(${s}px)`};return r.createElement("div",{className:(0,P.A)(wn.LiveRecordingBuffer,a&&wn.IsLive),style:c})}var xn=n(68147);const Hn=(0,r.memo)((function(e){const t=pe(),n=(0,M.q3)((()=>t.GetVisibleClips()));return r.createElement(r.Fragment,null,n.map((e=>r.createElement(Fn,{key:e.clipID,startPX:e.pxClipStart,endPX:e.pxClipEnd}))))})),Fn=(0,r.memo)((function(e){const{endPX:t,startPX:n}=e,i={width:t-n||0,transform:`translateX(${n}px)`};return r.createElement("div",{className:xn.ClipDecorator,style:i})}));var Bn=n(21185);const Wn=(0,r.forwardRef)((function(e,t){const n=pe();return(0,M.q3)((()=>n.GetNumTimelines()))?r.createElement(Un,{...e,timelineView:n,ref:t}):r.createElement(qn,{ref:t})})),qn=(0,r.forwardRef)((function(e,t){return r.createElement("div",{ref:t,className:(0,P.A)(Bn.ScrollbarPlaceholder,e.className)})})),Un=(0,r.forwardRef)((function(e,t){const n=q(),{children:i,className:o,timelineView:a,disableZoom:s}=e,[c,m]=(0,r.useState)(),d=r.useCallback((e=>{const t=e.target.getBoundingClientRect();a.SetScrollWindowOffset(t.x),a.SetScrollWindowWidth(t.width),m(t)}),[a]),u=(0,l.wY)(d),h=r.useCallback((e=>{if(e.ctrlKey&&!s){const t=c?(e.clientX-c.x)/c.width:.5;e.deltaY>0?a.ZoomOut(e.deltaY/100,t):a.ZoomIn(-e.deltaY/100,t)}else a.ScrollBy(e.deltaY)}),[s,c,a]);return function(e,t){const n=(0,M.q3)((()=>!t.GetAutoScrollPaused()&&e.GetGameRecordingVideo().BVideoElementPlaying()));(0,r.useEffect)((()=>{if(!n)return()=>{};let i=!1,r=e.GetGlobalMSPlaytime(),o=Date.now();const l=n=>{const a=Date.now(),s=a-o;t.ScrollToCenteredGlobalMS(r.valMS+s);const c=e.GetGlobalMSPlaytime();c.valMS!==r.valMS&&(r=c,o=a),i||requestAnimationFrame(l)};return requestAnimationFrame(l),()=>i=!0}),[e,t,n])}(n,a),r.createElement("div",{ref:t,onWheel:h,onMouseOver:()=>a.SetAutoScrollPaused(!0),onFocus:()=>{},onMouseLeave:()=>a.SetAutoScrollPauseTimeout()},r.createElement("div",{className:Bn.LeftControlsAndContent},r.createElement("div",{ref:u,className:(0,P.A)(Bn.ContentAndGradient,o)},i,r.createElement(zn,{timelineView:a})),n.GetRecordingMode()===w.Overlay&&r.createElement(I,null)),r.createElement("div",{className:Bn.ScrollbarAndSiblings},!n.GetGamepadMode()&&r.createElement($n,null)))}));function zn(e){const{timelineView:t}=e,n=(0,M.q3)((()=>t.GetVisualWindowStartPX())),i=(0,M.q3)((()=>t.BReachedMaxScroll()));return r.createElement("div",{className:Bn.ScrollGradientCtn},r.createElement("div",{className:(0,P.A)(Bn.FrontGradient,0===n&&Bn.HideGradient)}),r.createElement("div",{className:(0,P.A)(Bn.EndGradient,i&&Bn.HideGradient)}))}function $n(){const[e,t]=(0,r.useState)({scrollBarWidth:0,scrollBarXOffset:0}),n=r.useCallback((e=>{const n=e.target.getBoundingClientRect();t({scrollBarWidth:n.width,scrollBarXOffset:n.x})}),[]),i=pe(),o=(0,M.q3)((()=>i.GetScrollableWidthPX()+2*i.GetTimelineMarginWidth())),a=(0,M.q3)((()=>i.GetVisualWidth())),s=(0,r.useMemo)((()=>a*e.scrollBarWidth/o||0),[a,e.scrollBarWidth,o]),c=(0,l.wY)(n);return r.createElement("div",{className:(0,P.A)(Bn.ScrollBarCtn,Math.round(s)===Math.round(e.scrollBarWidth)&&Bn.HideScrollBar),ref:c},r.createElement(Zn,{timelineView:i,scrollSize:e}),r.createElement(Kn,{scrollSize:e,timelineView:i,timelineWidth:o,thumbWidth:s}))}function Zn(e){const{timelineView:t,scrollSize:n}=e,i=q(),o=function(e,t){const n=(0,r.useRef)(),i=(0,r.useRef)(),o=(0,M.q3)((()=>e.GetScrollableWidthPX())),l=(0,r.useCallback)((e=>(0,h.OB)(o*e/t.scrollBarWidth)),[t.scrollBarWidth,o]),a=(0,r.useCallback)((()=>{if(!n.current)return;const t=e.GetScrollWindowWidth(),r=e.GetVisualWindowStartPX()+t/2;if(n.current.valPX>r-.1*t&&n.current.valPX<r+.1*t)return;const o=.005*e.GetScrollableWidthPX(),l=n.current.valPX-r;if(Math.abs(l)>o){const t=l>0?o:-o;e.ScrollToOffsetCentered(r+t),i.current=requestAnimationFrame((()=>a()))}else e.ScrollToOffsetCentered(n.current.valPX)}),[e]),s=(0,r.useCallback)((e=>{n.current=l(e.clientX-t.scrollBarXOffset),i.current=requestAnimationFrame((()=>a()))}),[l,a,t.scrollBarXOffset]),c=(0,r.useCallback)((()=>{i.current&&cancelAnimationFrame(i.current)}),[]),m=(0,r.useCallback)((e=>{n.current=l(e.clientX-t.scrollBarXOffset)}),[l,t.scrollBarXOffset]);return(0,r.useEffect)((()=>()=>{i.current&&cancelAnimationFrame(i.current)}),[]),{onMouseDown:s,onMouseMove:m,onMouseUp:c,onMouseLeave:c}}(t,n),l=(0,M.q3)((()=>t.GetTimelineMarginWidth())),a=(0,M.q3)((()=>t.GetScrollableWidthPX())),s=(0,r.useCallback)((e=>{const t=e+l;return u.OQ(t*n.scrollBarWidth/a,0,n.scrollBarWidth)}),[n.scrollBarWidth,l,a]);return r.createElement("div",{className:Bn.ScrollTrack,...o},r.createElement(Jn,{timelineView:t,playbackCoordinator:i,fnConvertGlobalPXToTrackPX:s,scrollBarWidth:n.scrollBarWidth}),r.createElement(Yn,{timelineView:t,fnConvertGlobalPXToTrackPX:s}))}function Jn(e){const{timelineView:t,playbackCoordinator:n,fnConvertGlobalPXToTrackPX:i,scrollBarWidth:o}=e,l=(0,M.q3)((()=>n.GetHidePlayer())),a=(0,M.q3)((()=>{const e=n.GetGlobalMSPlaytime();if(e&&t.BInitialized()){const n=Math.floor(t.ConvertGlobalMSToGlobalPXOffset(e.valMS));return i(n)}return null}));if(!a)return null;return r.createElement("div",{className:Bn.PlayHeadAnnotation,onClick:()=>{let e=n.GetGlobalMSPlaytime();l&&(e=n.GetLiveEdgeMS()),t.ScrollToCenteredGlobalMS(e.valMS)},style:{transform:`translateX(${l?o:a}px)`}},r.createElement(Qn,null))}function Qn(){return r.createElement("svg",{width:"52",height:"31",viewBox:"0 0 52 31",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M26 31L51.1147 0.25H0.885263L26 31Z",fill:"#D9D9D9"}))}function Yn(e){const{timelineView:t,fnConvertGlobalPXToTrackPX:n}=e,i=ce(),o=ne(),l=(0,M.q3)((()=>{if(i&&t.BInitialized()){const e=Math.floor(t.ConvertGlobalMSToGlobalPXOffset(o.nGlobalStartMS.valMS)),i=Math.floor(t.ConvertGlobalMSToGlobalPXOffset(o.nGlobalEndMS.valMS));if(!isNaN(e)&&!isNaN(i)){return{rangeStartPX:n(e),rangeEndPX:n(i)}}}return null}));if(!l)return null;return r.createElement("div",{className:Bn.RangeAnnotation,onClick:()=>{t.ScrollToCenteredGlobalMS(o.nGlobalStartMS.valMS)},style:{width:l.rangeEndPX-l.rangeStartPX,transform:`translateX(${l.rangeStartPX}px)`}})}function Kn(e){const{scrollSize:t,timelineWidth:n,thumbWidth:i,timelineView:o}=e,{thumbPositionPX:l,onMouseDown:a,bHiglightThumb:s}=function(e,t,n,i){const[o,l]=(0,r.useState)(!1),[a,s]=(0,r.useState)(0),c=(0,M.q3)((()=>{const r=i.BInitialized(),o=i.GetVisualWindowStartPX();return r?u.OQ(o*e.scrollBarWidth/t,0,e.scrollBarWidth-n):0})),[m,d]=(0,r.useState)(!1),h=(0,r.useRef)();(0,r.useEffect)((()=>{if(i.GetAutoScrollPaused())return d(!0),h.current=window.setTimeout((()=>{d(!1)}),500),()=>window.clearTimeout(h.current)}),[c,i]);const _=(0,r.useCallback)((t=>{s(c),l(!0);const n=t.nativeEvent.offsetX,r=i.GetTimelineParentCtnRef()??(0,Qe.uX)(t);let o,a,m;const d=t=>{s(t.clientX-e.scrollBarXOffset-n)};r.addEventListener("mousemove",d),o=()=>r.removeEventListener("mousemove",d);const u=()=>{l(!1),o(),a(),m()};r.addEventListener("mouseup",u),r.addEventListener("mouseleave",u),a=()=>r.removeEventListener("mouseup",u),m=()=>r.removeEventListener("mouseleave",u)}),[c,e.scrollBarXOffset,i]),g=(0,r.useMemo)((()=>o?u.OQ(a,0,e.scrollBarWidth-n):c),[a,o,c,e.scrollBarWidth,n]);return(0,r.useEffect)((()=>{if(o){const n=t*g/e.scrollBarWidth;i.ScrollToOffset(n)}}),[o,e.scrollBarWidth,g,i,t]),{thumbPositionPX:g,onMouseDown:_,bHiglightThumb:m}}(t,n,i,o);return r.createElement("div",{className:(0,P.A)(Bn.ScrollThumb,s&&Bn.Highlight),style:{width:i,transform:`translateX(${l}px)`},onMouseDown:a})}var jn=n(17241),ei=(n(63429),n(77286),n(47159),n(78325),n(30568));class ti{m_tours={};m_strActiveTour="";m_storage;m_bReady=!1;constructor(){(0,a.Gn)(this)}async Init(e){if(this.m_storage)return;this.m_storage=e;const t=await ii(e);Object.keys(t||{}).forEach((e=>{const n=!!t[e];this.m_tours[e]={...this.m_tours[e]||{stops:{}},bSeen:n}})),this.m_bReady=!0}UpdateStop(e,t,n,i){this.m_tours[e]||(this.m_tours[e]={bSeen:!1,stops:{}}),this.m_tours[e].stops[t]={options:n,elem:i}}BHasSeenTour(e){return!this.m_bReady||this.m_tours[e]&&this.m_tours[e].bSeen}GetTrackedStops(e){return this.m_tours[e]?.stops||{}}ActivateTour(e){this.m_strActiveTour&&this.m_strActiveTour!==e&&this.DismissTour(this.m_strActiveTour),this.m_strActiveTour=e}DismissTour(e){this.m_tours[e]&&(this.MarkTourSeen(e),this.m_tours[e].bSeen=!0,this.m_strActiveTour===e&&(this.m_strActiveTour=""))}MarkTourSeen(e){return ri(this.m_storage,e,Date.now())}MarkTourUnseen(e){return ri(this.m_storage,e,void 0)}}(0,o.Cg)([a.sH],ti.prototype,"m_tours",void 0),(0,o.Cg)([a.sH],ti.prototype,"m_strActiveTour",void 0),(0,o.Cg)([a.sH],ti.prototype,"m_bReady",void 0),(0,o.Cg)([a.XI.bound],ti.prototype,"UpdateStop",null),(0,o.Cg)([a.XI],ti.prototype,"ActivateTour",null),(0,o.Cg)([a.XI],ti.prototype,"DismissTour",null);const ni="tour_history";async function ii(e){const t=await e.GetObject(ni);return t&&"object"==typeof t?t:{}}async function ri(e,t,n){const i=await ii(e);return e.StoreObject(ni,{...i,[t]:n})}const oi=new ti;function li(){const e=(0,ei.rX)();return(0,r.useEffect)((()=>{oi.Init(e)}),[e]),oi}function ai(e){const t=li(),{bShowTour:n,stopElems:i}=(0,M.q3)((()=>({bShowTour:!t.BHasSeenTour(e),stopElems:t.GetTrackedStops(e)})));return{bShowTour:n,stopElems:i,onInteraction:(0,r.useCallback)((()=>t.MarkTourSeen(e)),[t,e]),onDismiss:(0,r.useCallback)((()=>t.DismissTour(e)),[t,e]),onActivate:(0,r.useCallback)((()=>t.ActivateTour(e)),[t,e]),updateStop:t.UpdateStop}}function si(e){const{name:t,tour:n,options:i,children:o}=e,{updateStop:l}=ai(n),a=(0,r.useCallback)((e=>l(n,t,i,e)),[l,n,t]);return(0,r.cloneElement)(r.Children.only(o),{ref:a})}const ci=.08;function mi(e){const{loader:t,className:n,clipSummaries:i,refTimelineParentCtn:o,disableZoom:l}=e,a=(0,M.q3)((()=>t.BInitialized())),s=q();a||r.createElement("div",{className:it.LoadingTimeline});let c=(0,P.A)(it.ScrollAndControlsCtn,s.GetGamepadMode()&&it.GamepadMode,n);return r.createElement(Se,{loader:t,clipSummaries:i,playbackCoordinator:s,refTimelineParentCtn:o},r.createElement("div",{className:c},r.createElement(_i,null),r.createElement(gi,null),r.createElement(si,{tour:"recording_timeline",name:"timeline",options:{position:"left",offset:30}},r.createElement(Wn,{className:it.TimelineScrollContainer,disableZoom:l},r.createElement(di,null)))))}const di=(0,r.memo)((function(e){const t=pe();return(0,M.q3)((()=>t.BInitialized()))?r.createElement(ui,null):null}));function ui(){const e=pe(),t=(0,M.q3)((()=>e.GetScrollableWidthPX())),n=(0,M.q3)((()=>e.GetVisualWindowStartPX())),i=(0,M.q3)((()=>e.GetTimelineMarginWidth()));return r.createElement("div",{className:it.ContentContainer,style:{minWidth:t||0,marginRight:i,marginLeft:i,transform:`translateX(${-n}px)`}},r.createElement(hi,{id:"recordings",className:it.RecordingDecorators},r.createElement(Xn,null)),r.createElement(hi,{id:"clips",className:it.ClipDecorators},r.createElement(Hn,null)),r.createElement(hi,{id:"game_modes",className:it.GameModes},r.createElement(Ot,null)),r.createElement(hi,{id:"date_decorators",className:it.DateDecorator},r.createElement(An,null)),r.createElement(hi,{id:"ticks",className:it.BackgroundTicks},r.createElement(lt,null)),r.createElement(Vt,null,r.createElement(hi,{id:"highlights",className:it.Highlights},r.createElement(Pt,null)),r.createElement(hi,{id:"range_selection",className:it.RangeSelector},r.createElement(vn,null)),r.createElement(hi,{id:"seek_scrub",className:it.SeekScrubber},r.createElement(fn,null)),r.createElement(hi,{id:"play_head",className:it.PlayHead},r.createElement(Wt,null))))}function hi(e){const{children:t,id:n,className:i}=e;return r.createElement("div",{id:n,className:(0,P.A)(i,it.AbsoluteLayer)},r.createElement("div",{className:it.RelativeLayer},t))}function _i(e){const t=q().GetRenderGlyph();return t?t(jn.pR.TRIGGER_LEFT,!1,!1,it.PositionLeft):null}function gi(e){const t=q().GetRenderGlyph();return t?t(jn.pR.TRIGGER_RIGHT,!1,!1,it.PositionRight):null}var fi=n(61416),Si=n(22159),pi=n(51726),bi=n(9464);function Ci(e){const{clipID:t}=e,n=function(e){const t=(0,ei.KV)();return(0,fi.I)({queryKey:["grclip",e],queryFn:async()=>{const n=pi.w.Init(Si.Dr);n.Body().set_clip_id(e);const i=await Si.vW.GetSingleSharedClip(t,n);if(1!=i.GetEResult())throw(0,s.ZI)("GetSingleSharedClip failed"),i.DEBUG_LogToConsole(),new Error(`Failed to load clip with result: ${i.GetEResult()}`);let r,o=i.Body().toObject().clip,l=[];if(0==o.video_ids.length)throw(0,s.ZI)("No video ids in clip",e),i.DEBUG_LogToConsole(),new Error("No video ids in clip");for(let e of o.video_ids)r&&r.timeline_id==e.server_timeline_id||(r=yi(o,e),l.push(r)),r.recordings.push({recording_id:e.video_manager_video_id,start_offset_ms:e.start_offset_ms.toFixed(0),duration_ms:e.duration_ms.toFixed(0),recording_type:4,cdn_manifest_url:e.manifest_url});return{clip_id:o.clip_id,game_id:o.gameid,timelines:l}}})}(t);return n.data?r.createElement(Ti,{clip:n.data,mode:w.ChatClip}):r.createElement("div",{style:{color:"white"}},"Loading...")}const vi=function(e){const{previewURL:t}=e,[n,i]=r.useState(!1);return n?r.createElement(Ci,{...e}):r.createElement("div",{className:bi.ClipPreview,onClick:()=>{i(!0)}},r.createElement("img",{className:bi.Thumbnail,src:t}),r.createElement("div",{className:bi.PlayContainer},r.createElement(j.jGG,{className:bi.Button})))};function yi(e,t){return{timeline_id:t.server_timeline_id,game_id:e.clip_id,date_recorded:e.date_recorded,duration_ms:e.duration_ms.toFixed(0),recordings:[]}}function Mi(e){const t=r.useMemo((()=>(0,m.pw)(e)),[e]),n=r.useCallback((t=>{for(const n of e.timelines)for(const e of n.recordings)if(e.recording_id==t)return e.cdn_manifest_url}),[e]);return r.useEffect((()=>()=>t&&t.release()),[t]),{loader:t.loader,fnGetManifest:n}}function Ti(e){const{clip:t,mode:n}=e,{loader:i,fnGetManifest:o}=Mi(t);return r.createElement(r.Fragment,null,r.createElement(W,{loader:i,fnGetManifest:o,mode:n},r.createElement("div",{className:bi.ClipDetails},r.createElement("div",{className:bi.VideoContainer},r.createElement(Ye,{positionAbsolute:!1,autoPlay:n!=w.ChatClip})),r.createElement(mi,{loader:i}))))}}}]);